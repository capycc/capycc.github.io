function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index.sLqdPAdm.js","./preload-helper.BQ24v_F8.js","./2.BxO-m_3j.js","./scheduler.BewxI5mO.js","./index.CcK5JdY8.js","./index.DrQZ3c7K.js","../assets/2.oWPDm2nh.css","../assets/pico.DOe9qGvR.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{_ as R0}from"./preload-helper.BQ24v_F8.js";import{e as Or,$ as jc}from"./events.fsTkVg4x.js";import{A as ts,D as ne,E as T0,G as rf,J as nf,K as qc,L as Io,M as A0,N as qr,k as Mc,O as Ii,V as C0,Q as $0,R as Y,S as N0,T as vc,U as D0,X as L0,Y as j0,Z as Gh,_ as q0,$ as M0,a0 as z0,a1 as Wh,a2 as U0,a3 as H0,a4 as k0,a5 as Yn,a6 as Jh,a7 as B0,a8 as K0,a9 as sf,aa as Lr,ab as F0,ac as Qh,ad as dn,ae as Nt,af as Gt,ag as Ei,ah as hr,ai as V0,aj as gn,ak as of,al as G0,am as W0,an as J0,ao as af,ap as Q0,aq as cf,ar as uf,as as vn,at as mc,au as yo,av as _n,aw as Y0,ax as vo,ay as X0,az as Z0,aA as e_,aB as t_,aC as uo,aD as r_,aE as i_,aF as ec,aG as Yh,aH as n_,aI as s_,aJ as o_,aK as Xh,aL as a_,aM as c_,aN as u_,aO as h_,aP as l_,aQ as f_,aR as p_,aS as Gn,aT as hf,aU as tc,aV as d_,aW as g_}from"./2.BxO-m_3j.js";const y_=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,v_=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,m_=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function __(a,t){if(a==="__proto__"||a==="constructor"&&t&&typeof t=="object"&&"prototype"in t){w_(a);return}return t}function w_(a){console.warn(`[destr] Dropping "${a}" key to prevent prototype pollution.`)}function ho(a,t={}){if(typeof a!="string")return a;const r=a.trim();if(a[0]==='"'&&a.endsWith('"')&&!a.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!m_.test(a)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return a}try{if(y_.test(a)||v_.test(a)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(a,__)}return JSON.parse(a)}catch(n){if(t.strict)throw n;return a}}function b_(a){return!a||typeof a.then!="function"?Promise.resolve(a):a}function Ut(a,...t){try{return b_(a(...t))}catch(r){return Promise.reject(r)}}function E_(a){const t=typeof a;return a===null||t!=="object"&&t!=="function"}function I_(a){const t=Object.getPrototypeOf(a);return!t||t.isPrototypeOf(Object)}function mo(a){if(E_(a))return String(a);if(I_(a)||Array.isArray(a))return JSON.stringify(a);if(typeof a.toJSON=="function")return mo(a.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function lf(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const _c="base64:";function x_(a){if(typeof a=="string")return a;lf();const t=Buffer.from(a).toString("base64");return _c+t}function P_(a){return typeof a!="string"||!a.startsWith(_c)?a:(lf(),Buffer.from(a.slice(_c.length),"base64"))}function ur(a){return a?a.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function S_(...a){return ur(a.join(":"))}function lo(a){return a=ur(a),a?a+":":""}const O_="memory",R_=()=>{const a=new Map;return{name:O_,options:{},hasItem(t){return a.has(t)},getItem(t){return a.get(t)??null},getItemRaw(t){return a.get(t)??null},setItem(t,r){a.set(t,r)},setItemRaw(t,r){a.set(t,r)},removeItem(t){a.delete(t)},getKeys(){return Array.from(a.keys())},clear(){a.clear()},dispose(){a.clear()}}};function T_(a={}){const t={mounts:{"":a.driver||R_()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=p=>{for(const b of t.mountpoints)if(p.startsWith(b))return{base:b,relativeKey:p.slice(b.length),driver:t.mounts[b]};return{base:"",relativeKey:p,driver:t.mounts[""]}},n=(p,b)=>t.mountpoints.filter(S=>S.startsWith(p)||b&&p.startsWith(S)).map(S=>({relativeBase:p.length>S.length?p.slice(S.length):void 0,mountpoint:S,driver:t.mounts[S]})),s=(p,b)=>{if(t.watching){b=ur(b);for(const S of t.watchListeners)S(p,b)}},c=async()=>{if(!t.watching){t.watching=!0;for(const p in t.mounts)t.unwatch[p]=await Zh(t.mounts[p],s,p)}},l=async()=>{if(t.watching){for(const p in t.unwatch)await t.unwatch[p]();t.unwatch={},t.watching=!1}},d=(p,b,S)=>{const x=new Map,D=C=>{let F=x.get(C.base);return F||(F={driver:C.driver,base:C.base,items:[]},x.set(C.base,F)),F};for(const C of p){const F=typeof C=="string",re=ur(F?C:C.key),he=F?void 0:C.value,le=F||!C.options?b:{...b,...C.options},fe=r(re);D(fe).items.push({key:re,value:he,relativeKey:fe.relativeKey,options:le})}return Promise.all([...x.values()].map(C=>S(C))).then(C=>C.flat())},_={hasItem(p,b={}){p=ur(p);const{relativeKey:S,driver:x}=r(p);return Ut(x.hasItem,S,b)},getItem(p,b={}){p=ur(p);const{relativeKey:S,driver:x}=r(p);return Ut(x.getItem,S,b).then(D=>ho(D))},getItems(p,b){return d(p,b,S=>S.driver.getItems?Ut(S.driver.getItems,S.items.map(x=>({key:x.relativeKey,options:x.options})),b).then(x=>x.map(D=>({key:S_(S.base,D.key),value:ho(D.value)}))):Promise.all(S.items.map(x=>Ut(S.driver.getItem,x.relativeKey,x.options).then(D=>({key:x.key,value:ho(D)})))))},getItemRaw(p,b={}){p=ur(p);const{relativeKey:S,driver:x}=r(p);return x.getItemRaw?Ut(x.getItemRaw,S,b):Ut(x.getItem,S,b).then(D=>P_(D))},async setItem(p,b,S={}){if(b===void 0)return _.removeItem(p);p=ur(p);const{relativeKey:x,driver:D}=r(p);D.setItem&&(await Ut(D.setItem,x,mo(b),S),D.watch||s("update",p))},async setItems(p,b){await d(p,b,async S=>{if(S.driver.setItems)return Ut(S.driver.setItems,S.items.map(x=>({key:x.relativeKey,value:mo(x.value),options:x.options})),b);S.driver.setItem&&await Promise.all(S.items.map(x=>Ut(S.driver.setItem,x.relativeKey,mo(x.value),x.options)))})},async setItemRaw(p,b,S={}){if(b===void 0)return _.removeItem(p,S);p=ur(p);const{relativeKey:x,driver:D}=r(p);if(D.setItemRaw)await Ut(D.setItemRaw,x,b,S);else if(D.setItem)await Ut(D.setItem,x,x_(b),S);else return;D.watch||s("update",p)},async removeItem(p,b={}){typeof b=="boolean"&&(b={removeMeta:b}),p=ur(p);const{relativeKey:S,driver:x}=r(p);x.removeItem&&(await Ut(x.removeItem,S,b),(b.removeMeta||b.removeMata)&&await Ut(x.removeItem,S+"$",b),x.watch||s("remove",p))},async getMeta(p,b={}){typeof b=="boolean"&&(b={nativeOnly:b}),p=ur(p);const{relativeKey:S,driver:x}=r(p),D=Object.create(null);if(x.getMeta&&Object.assign(D,await Ut(x.getMeta,S,b)),!b.nativeOnly){const C=await Ut(x.getItem,S+"$",b).then(F=>ho(F));C&&typeof C=="object"&&(typeof C.atime=="string"&&(C.atime=new Date(C.atime)),typeof C.mtime=="string"&&(C.mtime=new Date(C.mtime)),Object.assign(D,C))}return D},setMeta(p,b,S={}){return this.setItem(p+"$",b,S)},removeMeta(p,b={}){return this.removeItem(p+"$",b)},async getKeys(p,b={}){p=lo(p);const S=n(p,!0);let x=[];const D=[];for(const C of S){const re=(await Ut(C.driver.getKeys,C.relativeBase,b)).map(he=>C.mountpoint+ur(he)).filter(he=>!x.some(le=>he.startsWith(le)));D.push(...re),x=[C.mountpoint,...x.filter(he=>!he.startsWith(C.mountpoint))]}return p?D.filter(C=>C.startsWith(p)&&!C.endsWith("$")):D.filter(C=>!C.endsWith("$"))},async clear(p,b={}){p=lo(p),await Promise.all(n(p,!1).map(async S=>{if(S.driver.clear)return Ut(S.driver.clear,S.relativeBase,b);if(S.driver.removeItem){const x=await S.driver.getKeys(S.relativeBase||"",b);return Promise.all(x.map(D=>S.driver.removeItem(D,b)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(p=>el(p)))},async watch(p){return await c(),t.watchListeners.push(p),async()=>{t.watchListeners=t.watchListeners.filter(b=>b!==p),t.watchListeners.length===0&&await l()}},async unwatch(){t.watchListeners=[],await l()},mount(p,b){if(p=lo(p),p&&t.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(t.mountpoints.push(p),t.mountpoints.sort((S,x)=>x.length-S.length)),t.mounts[p]=b,t.watching&&Promise.resolve(Zh(b,s,p)).then(S=>{t.unwatch[p]=S}).catch(console.error),_},async unmount(p,b=!0){p=lo(p),!(!p||!t.mounts[p])&&(t.watching&&p in t.unwatch&&(t.unwatch[p](),delete t.unwatch[p]),b&&await el(t.mounts[p]),t.mountpoints=t.mountpoints.filter(S=>S!==p),delete t.mounts[p])},getMount(p=""){p=ur(p)+":";const b=r(p);return{driver:b.driver,base:b.base}},getMounts(p="",b={}){return p=ur(p),n(p,b.parents).map(x=>({driver:x.driver,base:x.mountpoint}))}};return _}function Zh(a,t,r){return a.watch?a.watch((n,s)=>t(n,r+s)):()=>{}}async function el(a){typeof a.dispose=="function"&&await Ut(a.dispose)}function Ki(a){return new Promise((t,r)=>{a.oncomplete=a.onsuccess=()=>t(a.result),a.onabort=a.onerror=()=>r(a.error)})}function ff(a,t){const r=indexedDB.open(a);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=Ki(r);return(s,c)=>n.then(l=>c(l.transaction(t,s).objectStore(t)))}let rc;function rs(){return rc||(rc=ff("keyval-store","keyval")),rc}function tl(a,t=rs()){return t("readonly",r=>Ki(r.get(a)))}function A_(a,t,r=rs()){return r("readwrite",n=>(n.put(t,a),Ki(n.transaction)))}function C_(a,t=rs()){return t("readwrite",r=>(r.delete(a),Ki(r.transaction)))}function $_(a=rs()){return a("readwrite",t=>(t.clear(),Ki(t.transaction)))}function N_(a,t){return a.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Ki(a.transaction)}function D_(a=rs()){return a("readonly",t=>{if(t.getAllKeys)return Ki(t.getAllKeys());const r=[];return N_(t,n=>r.push(n.key)).then(()=>r)})}const L_=a=>JSON.stringify(a,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),j_=a=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=a.replace(t,'$1"$2n"$3');return JSON.parse(r,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function is(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return j_(a)}catch{return a}}function Bi(a){return typeof a=="string"?a:L_(a)||""}const q_="idb-keyval";var M_=(a={})=>{const t=a.base&&a.base.length>0?`${a.base}:`:"",r=s=>t+s;let n;return a.dbName&&a.storeName&&(n=ff(a.dbName,a.storeName)),{name:q_,options:a,async hasItem(s){return!(typeof await tl(r(s),n)>"u")},async getItem(s){return await tl(r(s),n)??null},setItem(s,c){return A_(r(s),c,n)},removeItem(s){return C_(r(s),n)},getKeys(){return D_(n)},clear(){return $_(n)}}};const z_="WALLET_CONNECT_V2_INDEXED_DB",U_="keyvaluestorage";let H_=class{constructor(){this.indexedDb=T_({driver:M_({dbName:z_,storeName:U_})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Bi(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var ic=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_o={exports:{}};(function(){let a;function t(){}a=t,a.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},a.prototype.setItem=function(r,n){this[r]=String(n)},a.prototype.removeItem=function(r){delete this[r]},a.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},a.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ic<"u"&&ic.localStorage?_o.exports=ic.localStorage:typeof window<"u"&&window.localStorage?_o.exports=window.localStorage:_o.exports=new t})();function k_(a){var t;return[a[0],is((t=a[1])!=null?t:"")]}class B_{constructor(){this.localStorage=_o.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(k_)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return is(r)}async setItem(t,r){this.localStorage.setItem(t,Bi(r))}async removeItem(t){this.localStorage.removeItem(t)}}const K_="wc_storage_version",rl=1,F_=async(a,t,r)=>{const n=K_,s=await t.getItem(n);if(s&&s>=rl){r(t);return}const c=await a.getKeys();if(!c.length){r(t);return}const l=[];for(;c.length;){const d=c.shift();if(!d)continue;const _=d.toLowerCase();if(_.includes("wc@")||_.includes("walletconnect")||_.includes("wc_")||_.includes("wallet_connect")){const p=await a.getItem(d);await t.setItem(d,p),l.push(d)}}await t.setItem(n,rl),r(t),V_(a,l)},V_=async(a,t)=>{t.length&&t.forEach(async r=>{await a.removeItem(r)})};let G_=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new B_;this.storage=t;try{const r=new H_;F_(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var wn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var wc=function(a,t){return wc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},wc(a,t)};function W_(a,t){wc(a,t);function r(){this.constructor=a}a.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var bc=function(){return bc=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},bc.apply(this,arguments)};function J_(a,t){var r={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(r[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(r[n[s]]=a[n[s]]);return r}function Q_(a,t,r,n){var s=arguments.length,c=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,t,r,n);else for(var d=a.length-1;d>=0;d--)(l=a[d])&&(c=(s<3?l(c):s>3?l(t,r,c):l(t,r))||c);return s>3&&c&&Object.defineProperty(t,r,c),c}function Y_(a,t){return function(r,n){t(r,n,a)}}function X_(a,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,t)}function Z_(a,t,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function d(b){try{p(n.next(b))}catch(S){l(S)}}function _(b){try{p(n.throw(b))}catch(S){l(S)}}function p(b){b.done?c(b.value):s(b.value).then(d,_)}p((n=n.apply(a,t||[])).next())})}function ew(a,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(p){return function(b){return _([p,b])}}function _(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(c=p[0]&2?s.return:p[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,p[1])).done)return c;switch(s=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,s=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){r.label=p[1];break}if(p[0]===6&&r.label<c[1]){r.label=c[1],c=p;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(p);break}c[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(a,r)}catch(b){p=[6,b],s=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function tw(a,t,r,n){n===void 0&&(n=r),a[n]=t[r]}function rw(a,t){for(var r in a)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=a[r])}function Ec(a){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&a[t],n=0;if(r)return r.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function pf(a,t){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var n=r.call(a),s,c=[],l;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(d){l={error:d}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return c}function iw(){for(var a=[],t=0;t<arguments.length;t++)a=a.concat(pf(arguments[t]));return a}function nw(){for(var a=0,t=0,r=arguments.length;t<r;t++)a+=arguments[t].length;for(var n=Array(a),s=0,t=0;t<r;t++)for(var c=arguments[t],l=0,d=c.length;l<d;l++,s++)n[s]=c[l];return n}function Xn(a){return this instanceof Xn?(this.v=a,this):new Xn(a)}function sw(a,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(a,t||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(x){n[x]&&(s[x]=function(D){return new Promise(function(C,F){c.push([x,D,C,F])>1||d(x,D)})})}function d(x,D){try{_(n[x](D))}catch(C){S(c[0][3],C)}}function _(x){x.value instanceof Xn?Promise.resolve(x.value.v).then(p,b):S(c[0][2],x)}function p(x){d("next",x)}function b(x){d("throw",x)}function S(x,D){x(D),c.shift(),c.length&&d(c[0][0],c[0][1])}}function ow(a){var t,r;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,c){t[s]=a[s]?function(l){return(r=!r)?{value:Xn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function aw(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=a[Symbol.asyncIterator],r;return t?t.call(a):(a=typeof Ec=="function"?Ec(a):a[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(c){r[c]=a[c]&&function(l){return new Promise(function(d,_){l=a[c](l),s(d,_,l.done,l.value)})}}function s(c,l,d,_){Promise.resolve(_).then(function(p){c({value:p,done:d})},l)}}function cw(a,t){return Object.defineProperty?Object.defineProperty(a,"raw",{value:t}):a.raw=t,a}function uw(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var r in a)Object.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t.default=a,t}function hw(a){return a&&a.__esModule?a:{default:a}}function lw(a,t){if(!t.has(a))throw new TypeError("attempted to get private field on non-instance");return t.get(a)}function fw(a,t,r){if(!t.has(a))throw new TypeError("attempted to set private field on non-instance");return t.set(a,r),r}const pw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return bc},__asyncDelegator:ow,__asyncGenerator:sw,__asyncValues:aw,__await:Xn,__awaiter:Z_,__classPrivateFieldGet:lw,__classPrivateFieldSet:fw,__createBinding:tw,__decorate:Q_,__exportStar:rw,__extends:W_,__generator:ew,__importDefault:hw,__importStar:uw,__makeTemplateObject:cw,__metadata:X_,__param:Y_,__read:pf,__rest:J_,__spread:iw,__spreadArrays:nw,__values:Ec},Symbol.toStringTag,{value:"Module"})),xo=ts(pw);var Un={},nc={},Hn={};let Fi=class{};const dw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Fi},Symbol.toStringTag,{value:"Module"})),gw=ts(dw);var il;function yw(){if(il)return Hn;il=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.IHeartBeat=void 0;const a=gw;class t extends a.IEvents{constructor(n){super()}}return Hn.IHeartBeat=t,Hn}var nl;function df(){return nl||(nl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),xo.__exportStar(yw(),a)}(nc)),nc}var sc={},Hi={},sl;function vw(){if(sl)return Hi;sl=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.HEARTBEAT_EVENTS=Hi.HEARTBEAT_INTERVAL=void 0;const a=ne;return Hi.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,Hi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Hi}var ol;function gf(){return ol||(ol=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),xo.__exportStar(vw(),a)}(sc)),sc}var al;function mw(){if(al)return Un;al=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.HeartBeat=void 0;const a=xo,t=Or,r=ne,n=df(),s=gf();class c extends n.IHeartBeat{constructor(d){super(d),this.events=new t.EventEmitter,this.interval=s.HEARTBEAT_INTERVAL,this.interval=(d==null?void 0:d.interval)||s.HEARTBEAT_INTERVAL}static init(d){return a.__awaiter(this,void 0,void 0,function*(){const _=new c(d);return yield _.init(),_})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(d,_){this.events.on(d,_)}once(d,_){this.events.once(d,_)}off(d,_){this.events.off(d,_)}removeListener(d,_){this.events.removeListener(d,_)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(s.HEARTBEAT_EVENTS.pulse)}}return Un.HeartBeat=c,Un}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=xo;t.__exportStar(mw(),a),t.__exportStar(df(),a),t.__exportStar(gf(),a)})(wn);var Re={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ic=function(a,t){return Ic=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},Ic(a,t)};function _w(a,t){Ic(a,t);function r(){this.constructor=a}a.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var xc=function(){return xc=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},xc.apply(this,arguments)};function ww(a,t){var r={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(r[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(r[n[s]]=a[n[s]]);return r}function bw(a,t,r,n){var s=arguments.length,c=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,t,r,n);else for(var d=a.length-1;d>=0;d--)(l=a[d])&&(c=(s<3?l(c):s>3?l(t,r,c):l(t,r))||c);return s>3&&c&&Object.defineProperty(t,r,c),c}function Ew(a,t){return function(r,n){t(r,n,a)}}function Iw(a,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,t)}function xw(a,t,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function d(b){try{p(n.next(b))}catch(S){l(S)}}function _(b){try{p(n.throw(b))}catch(S){l(S)}}function p(b){b.done?c(b.value):s(b.value).then(d,_)}p((n=n.apply(a,t||[])).next())})}function Pw(a,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(p){return function(b){return _([p,b])}}function _(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(c=p[0]&2?s.return:p[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,p[1])).done)return c;switch(s=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,s=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){r.label=p[1];break}if(p[0]===6&&r.label<c[1]){r.label=c[1],c=p;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(p);break}c[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(a,r)}catch(b){p=[6,b],s=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Sw(a,t,r,n){n===void 0&&(n=r),a[n]=t[r]}function Ow(a,t){for(var r in a)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=a[r])}function Pc(a){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&a[t],n=0;if(r)return r.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function yf(a,t){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var n=r.call(a),s,c=[],l;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(d){l={error:d}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return c}function Rw(){for(var a=[],t=0;t<arguments.length;t++)a=a.concat(yf(arguments[t]));return a}function Tw(){for(var a=0,t=0,r=arguments.length;t<r;t++)a+=arguments[t].length;for(var n=Array(a),s=0,t=0;t<r;t++)for(var c=arguments[t],l=0,d=c.length;l<d;l++,s++)n[s]=c[l];return n}function Zn(a){return this instanceof Zn?(this.v=a,this):new Zn(a)}function Aw(a,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(a,t||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(x){n[x]&&(s[x]=function(D){return new Promise(function(C,F){c.push([x,D,C,F])>1||d(x,D)})})}function d(x,D){try{_(n[x](D))}catch(C){S(c[0][3],C)}}function _(x){x.value instanceof Zn?Promise.resolve(x.value.v).then(p,b):S(c[0][2],x)}function p(x){d("next",x)}function b(x){d("throw",x)}function S(x,D){x(D),c.shift(),c.length&&d(c[0][0],c[0][1])}}function Cw(a){var t,r;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,c){t[s]=a[s]?function(l){return(r=!r)?{value:Zn(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function $w(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=a[Symbol.asyncIterator],r;return t?t.call(a):(a=typeof Pc=="function"?Pc(a):a[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(c){r[c]=a[c]&&function(l){return new Promise(function(d,_){l=a[c](l),s(d,_,l.done,l.value)})}}function s(c,l,d,_){Promise.resolve(_).then(function(p){c({value:p,done:d})},l)}}function Nw(a,t){return Object.defineProperty?Object.defineProperty(a,"raw",{value:t}):a.raw=t,a}function Dw(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var r in a)Object.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t.default=a,t}function Lw(a){return a&&a.__esModule?a:{default:a}}function jw(a,t){if(!t.has(a))throw new TypeError("attempted to get private field on non-instance");return t.get(a)}function qw(a,t,r){if(!t.has(a))throw new TypeError("attempted to set private field on non-instance");return t.set(a,r),r}const Mw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return xc},__asyncDelegator:Cw,__asyncGenerator:Aw,__asyncValues:$w,__await:Zn,__awaiter:xw,__classPrivateFieldGet:jw,__classPrivateFieldSet:qw,__createBinding:Sw,__decorate:bw,__exportStar:Ow,__extends:_w,__generator:Pw,__importDefault:Lw,__importStar:Dw,__makeTemplateObject:Nw,__metadata:Iw,__param:Ew,__read:yf,__rest:ww,__spread:Rw,__spreadArrays:Tw,__values:Pc},Symbol.toStringTag,{value:"Module"})),zw=ts(Mw);var oc,cl;function Uw(){if(cl)return oc;cl=1;function a(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}oc=t;function t(r,n,s){var c=s&&s.stringify||a,l=1;if(typeof r=="object"&&r!==null){var d=n.length+l;if(d===1)return r;var _=new Array(d);_[0]=c(r);for(var p=1;p<d;p++)_[p]=c(n[p]);return _.join(" ")}if(typeof r!="string")return r;var b=n.length;if(b===0)return r;for(var S="",x=1-l,D=-1,C=r&&r.length||0,F=0;F<C;){if(r.charCodeAt(F)===37&&F+1<C){switch(D=D>-1?D:0,r.charCodeAt(F+1)){case 100:case 102:if(x>=b||n[x]==null)break;D<F&&(S+=r.slice(D,F)),S+=Number(n[x]),D=F+2,F++;break;case 105:if(x>=b||n[x]==null)break;D<F&&(S+=r.slice(D,F)),S+=Math.floor(Number(n[x])),D=F+2,F++;break;case 79:case 111:case 106:if(x>=b||n[x]===void 0)break;D<F&&(S+=r.slice(D,F));var re=typeof n[x];if(re==="string"){S+="'"+n[x]+"'",D=F+2,F++;break}if(re==="function"){S+=n[x].name||"<anonymous>",D=F+2,F++;break}S+=c(n[x]),D=F+2,F++;break;case 115:if(x>=b)break;D<F&&(S+=r.slice(D,F)),S+=String(n[x]),D=F+2,F++;break;case 37:D<F&&(S+=r.slice(D,F)),S+="%",D=F+2,F++,x--;break}++x}++F}return D===-1?r:(D<C&&(S+=r.slice(D)),S)}return oc}var ac,ul;function Hw(){if(ul)return ac;ul=1;const a=Uw();ac=s;const t=de().console||{},r={mapHttpRequest:C,mapHttpResponse:C,wrapRequestSerializer:F,wrapResponseSerializer:F,wrapErrorSerializer:F,req:C,res:C,err:x};function n(j,H){return Array.isArray(j)?j.filter(function(ve){return ve!=="!stdSerializers.err"}):j===!0?Object.keys(H):!1}function s(j){j=j||{},j.browser=j.browser||{};const H=j.browser.transmit;if(H&&typeof H.send!="function")throw Error("pino: transmit option must have a send function");const W=j.browser.write||t;j.browser.write&&(j.browser.asObject=!0);const ve=j.serializers||{},ie=n(j.browser.serialize,ve);let ue=j.browser.serialize;Array.isArray(j.browser.serialize)&&j.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Ce=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),j.enabled===!1&&(j.level="silent");const Ue=j.level||"info",m=Object.create(W);m.log||(m.log=re),Object.defineProperty(m,"levelVal",{get:X}),Object.defineProperty(m,"level",{get:ce,set:V});const P={transmit:H,serialize:ie,asObject:j.browser.asObject,levels:Ce,timestamp:D(j)};m.levels=s.levels,m.level=Ue,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=re,m.serializers=ve,m._serialize=ie,m._stdErrSerialize=ue,m.child=k,H&&(m._logEvent=S());function X(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function V(K){if(K!=="silent"&&!this.levels.values[K])throw Error("unknown level "+K);this._level=K,c(P,m,"error","log"),c(P,m,"fatal","error"),c(P,m,"warn","error"),c(P,m,"info","log"),c(P,m,"debug","log"),c(P,m,"trace","log")}function k(K,G){if(!K)throw new Error("missing bindings for child Pino");G=G||{},ie&&K.serializers&&(G.serializers=K.serializers);const Je=G.serializers;if(ie&&Je){var Be=Object.assign({},ve,Je),Mr=j.browser.serialize===!0?Object.keys(Be):ie;delete K.serializers,_([K],Mr,Be,this._stdErrSerialize)}function Ie(It){this._childLevel=(It._childLevel|0)+1,this.error=p(It,K,"error"),this.fatal=p(It,K,"fatal"),this.warn=p(It,K,"warn"),this.info=p(It,K,"info"),this.debug=p(It,K,"debug"),this.trace=p(It,K,"trace"),Be&&(this.serializers=Be,this._serialize=Mr),H&&(this._logEvent=S([].concat(It._logEvent.bindings,K)))}return Ie.prototype=this,new Ie(this)}return m}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=r,s.stdTimeFunctions=Object.assign({},{nullTime:he,epochTime:le,unixTime:fe,isoTime:pe});function c(j,H,W,ve){const ie=Object.getPrototypeOf(H);H[W]=H.levelVal>H.levels.values[W]?re:ie[W]?ie[W]:t[W]||t[ve]||re,l(j,H,W)}function l(j,H,W){!j.transmit&&H[W]===re||(H[W]=function(ve){return function(){const ue=j.timestamp(),Ce=new Array(arguments.length),Ue=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var m=0;m<Ce.length;m++)Ce[m]=arguments[m];if(j.serialize&&!j.asObject&&_(Ce,this._serialize,this.serializers,this._stdErrSerialize),j.asObject?ve.call(Ue,d(this,W,Ce,ue)):ve.apply(Ue,Ce),j.transmit){const P=j.transmit.level||H.level,X=s.levels.values[P],ce=s.levels.values[W];if(ce<X)return;b(this,{ts:ue,methodLevel:W,methodValue:ce,transmitLevel:P,transmitValue:s.levels.values[j.transmit.level||H.level],send:j.transmit.send,val:H.levelVal},Ce)}}}(H[W]))}function d(j,H,W,ve){j._serialize&&_(W,j._serialize,j.serializers,j._stdErrSerialize);const ie=W.slice();let ue=ie[0];const Ce={};ve&&(Ce.time=ve),Ce.level=s.levels.values[H];let Ue=(j._childLevel|0)+1;if(Ue<1&&(Ue=1),ue!==null&&typeof ue=="object"){for(;Ue--&&typeof ie[0]=="object";)Object.assign(Ce,ie.shift());ue=ie.length?a(ie.shift(),ie):void 0}else typeof ue=="string"&&(ue=a(ie.shift(),ie));return ue!==void 0&&(Ce.msg=ue),Ce}function _(j,H,W,ve){for(const ie in j)if(ve&&j[ie]instanceof Error)j[ie]=s.stdSerializers.err(j[ie]);else if(typeof j[ie]=="object"&&!Array.isArray(j[ie]))for(const ue in j[ie])H&&H.indexOf(ue)>-1&&ue in W&&(j[ie][ue]=W[ue](j[ie][ue]))}function p(j,H,W){return function(){const ve=new Array(1+arguments.length);ve[0]=H;for(var ie=1;ie<ve.length;ie++)ve[ie]=arguments[ie-1];return j[W].apply(this,ve)}}function b(j,H,W){const ve=H.send,ie=H.ts,ue=H.methodLevel,Ce=H.methodValue,Ue=H.val,m=j._logEvent.bindings;_(W,j._serialize||Object.keys(j.serializers),j.serializers,j._stdErrSerialize===void 0?!0:j._stdErrSerialize),j._logEvent.ts=ie,j._logEvent.messages=W.filter(function(P){return m.indexOf(P)===-1}),j._logEvent.level.label=ue,j._logEvent.level.value=Ce,ve(ue,j._logEvent,Ue),j._logEvent=S(m)}function S(j){return{ts:0,messages:[],bindings:j||[],level:{label:"",value:0}}}function x(j){const H={type:j.constructor.name,msg:j.message,stack:j.stack};for(const W in j)H[W]===void 0&&(H[W]=j[W]);return H}function D(j){return typeof j.timestamp=="function"?j.timestamp:j.timestamp===!1?he:le}function C(){return{}}function F(j){return j}function re(){}function he(){return!1}function le(){return Date.now()}function fe(){return Math.round(Date.now()/1e3)}function pe(){return new Date(Date.now()).toISOString()}function de(){function j(H){return typeof H<"u"&&H}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return j(self)||j(window)||j(this)||{}}}return ac}var ki={},hl;function vf(){return hl||(hl=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.PINO_CUSTOM_CONTEXT_KEY=ki.PINO_LOGGER_DEFAULTS=void 0,ki.PINO_LOGGER_DEFAULTS={level:"info"},ki.PINO_CUSTOM_CONTEXT_KEY="custom_context"),ki}var tr={},ll;function kw(){if(ll)return tr;ll=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.generateChildLogger=tr.formatChildLoggerContext=tr.getLoggerContext=tr.setBrowserLoggerContext=tr.getBrowserLoggerContext=tr.getDefaultLoggerOptions=void 0;const a=vf();function t(d){return Object.assign(Object.assign({},d),{level:(d==null?void 0:d.level)||a.PINO_LOGGER_DEFAULTS.level})}tr.getDefaultLoggerOptions=t;function r(d,_=a.PINO_CUSTOM_CONTEXT_KEY){return d[_]||""}tr.getBrowserLoggerContext=r;function n(d,_,p=a.PINO_CUSTOM_CONTEXT_KEY){return d[p]=_,d}tr.setBrowserLoggerContext=n;function s(d,_=a.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof d.bindings>"u"?p=r(d,_):p=d.bindings().context||"",p}tr.getLoggerContext=s;function c(d,_,p=a.PINO_CUSTOM_CONTEXT_KEY){const b=s(d,p);return b.trim()?`${b}/${_}`:_}tr.formatChildLoggerContext=c;function l(d,_,p=a.PINO_CUSTOM_CONTEXT_KEY){const b=c(d,_,p),S=d.child({context:b});return n(S,b,p)}return tr.generateChildLogger=l,tr}(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const t=zw,r=t.__importDefault(Hw());Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(vf(),a),t.__exportStar(kw(),a)})(Re);class Bw extends Fi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let Kw=class extends Fi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},Fw=class{constructor(t,r){this.logger=t,this.core=r}},Vw=class extends Fi{constructor(t,r){super(),this.relayer=t,this.logger=r}},Gw=class extends Fi{constructor(t){super()}},Ww=class{constructor(t,r,n,s){this.core=t,this.logger=r,this.name=n}};class Jw extends Fi{constructor(t,r){super(),this.relayer=t,this.logger=r}}let Qw=class extends Fi{constructor(t,r){super(),this.core=t,this.logger=r}},Yw=class{constructor(t,r){this.projectId=t,this.logger=r}},Xw=class{constructor(t,r){this.projectId=t,this.logger=r}},Zw=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},eb=class{constructor(t){this.client=t}};var zc={},mf={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var t=T0,r=rf;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var n=function(){function d(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},d.prototype.update=function(_,p){if(p===void 0&&(p=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var b=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=_[b++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(b=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,b,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=_[b++],p--;return this},d.prototype.finish=function(_){if(!this._finished){var p=this._bytesHashed,b=this._bufferLength,S=p/536870912|0,x=p<<3,D=p%128<112?128:256;this._buffer[b]=128;for(var C=b+1;C<D-8;C++)this._buffer[C]=0;t.writeUint32BE(S,this._buffer,D-8),t.writeUint32BE(x,this._buffer,D-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,D),this._finished=!0}for(var C=0;C<this.digestLength/8;C++)t.writeUint32BE(this._stateHi[C],_,C*8),t.writeUint32BE(this._stateLo[C],_,C*8+4);return this},d.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(_){r.wipe(_.stateHi),r.wipe(_.stateLo),_.buffer&&r.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},d}();a.SHA512=n;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(d,_,p,b,S,x,D){for(var C=p[0],F=p[1],re=p[2],he=p[3],le=p[4],fe=p[5],pe=p[6],de=p[7],j=b[0],H=b[1],W=b[2],ve=b[3],ie=b[4],ue=b[5],Ce=b[6],Ue=b[7],m,P,X,ce,V,k,K,G;D>=128;){for(var Je=0;Je<16;Je++){var Be=8*Je+x;d[Je]=t.readUint32BE(S,Be),_[Je]=t.readUint32BE(S,Be+4)}for(var Je=0;Je<80;Je++){var Mr=C,Ie=F,It=re,L=he,N=le,A=fe,h=pe,I=de,ee=j,ge=H,be=W,$e=ve,De=ie,Se=ue,xt=Ce,mt=Ue;if(m=de,P=Ue,V=P&65535,k=P>>>16,K=m&65535,G=m>>>16,m=(le>>>14|ie<<18)^(le>>>18|ie<<14)^(ie>>>9|le<<23),P=(ie>>>14|le<<18)^(ie>>>18|le<<14)^(le>>>9|ie<<23),V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,m=le&fe^~le&pe,P=ie&ue^~ie&Ce,V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,m=s[Je*2],P=s[Je*2+1],V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,m=d[Je%16],P=_[Je%16],V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,k+=V>>>16,K+=k>>>16,G+=K>>>16,X=K&65535|G<<16,ce=V&65535|k<<16,m=X,P=ce,V=P&65535,k=P>>>16,K=m&65535,G=m>>>16,m=(C>>>28|j<<4)^(j>>>2|C<<30)^(j>>>7|C<<25),P=(j>>>28|C<<4)^(C>>>2|j<<30)^(C>>>7|j<<25),V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,m=C&F^C&re^F&re,P=j&H^j&W^H&W,V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,k+=V>>>16,K+=k>>>16,G+=K>>>16,I=K&65535|G<<16,mt=V&65535|k<<16,m=L,P=$e,V=P&65535,k=P>>>16,K=m&65535,G=m>>>16,m=X,P=ce,V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,k+=V>>>16,K+=k>>>16,G+=K>>>16,L=K&65535|G<<16,$e=V&65535|k<<16,F=Mr,re=Ie,he=It,le=L,fe=N,pe=A,de=h,C=I,H=ee,W=ge,ve=be,ie=$e,ue=De,Ce=Se,Ue=xt,j=mt,Je%16===15)for(var Be=0;Be<16;Be++)m=d[Be],P=_[Be],V=P&65535,k=P>>>16,K=m&65535,G=m>>>16,m=d[(Be+9)%16],P=_[(Be+9)%16],V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,X=d[(Be+1)%16],ce=_[(Be+1)%16],m=(X>>>1|ce<<31)^(X>>>8|ce<<24)^X>>>7,P=(ce>>>1|X<<31)^(ce>>>8|X<<24)^(ce>>>7|X<<25),V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,X=d[(Be+14)%16],ce=_[(Be+14)%16],m=(X>>>19|ce<<13)^(ce>>>29|X<<3)^X>>>6,P=(ce>>>19|X<<13)^(X>>>29|ce<<3)^(ce>>>6|X<<26),V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,k+=V>>>16,K+=k>>>16,G+=K>>>16,d[Be]=K&65535|G<<16,_[Be]=V&65535|k<<16}m=C,P=j,V=P&65535,k=P>>>16,K=m&65535,G=m>>>16,m=p[0],P=b[0],V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,k+=V>>>16,K+=k>>>16,G+=K>>>16,p[0]=C=K&65535|G<<16,b[0]=j=V&65535|k<<16,m=F,P=H,V=P&65535,k=P>>>16,K=m&65535,G=m>>>16,m=p[1],P=b[1],V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,k+=V>>>16,K+=k>>>16,G+=K>>>16,p[1]=F=K&65535|G<<16,b[1]=H=V&65535|k<<16,m=re,P=W,V=P&65535,k=P>>>16,K=m&65535,G=m>>>16,m=p[2],P=b[2],V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,k+=V>>>16,K+=k>>>16,G+=K>>>16,p[2]=re=K&65535|G<<16,b[2]=W=V&65535|k<<16,m=he,P=ve,V=P&65535,k=P>>>16,K=m&65535,G=m>>>16,m=p[3],P=b[3],V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,k+=V>>>16,K+=k>>>16,G+=K>>>16,p[3]=he=K&65535|G<<16,b[3]=ve=V&65535|k<<16,m=le,P=ie,V=P&65535,k=P>>>16,K=m&65535,G=m>>>16,m=p[4],P=b[4],V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,k+=V>>>16,K+=k>>>16,G+=K>>>16,p[4]=le=K&65535|G<<16,b[4]=ie=V&65535|k<<16,m=fe,P=ue,V=P&65535,k=P>>>16,K=m&65535,G=m>>>16,m=p[5],P=b[5],V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,k+=V>>>16,K+=k>>>16,G+=K>>>16,p[5]=fe=K&65535|G<<16,b[5]=ue=V&65535|k<<16,m=pe,P=Ce,V=P&65535,k=P>>>16,K=m&65535,G=m>>>16,m=p[6],P=b[6],V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,k+=V>>>16,K+=k>>>16,G+=K>>>16,p[6]=pe=K&65535|G<<16,b[6]=Ce=V&65535|k<<16,m=de,P=Ue,V=P&65535,k=P>>>16,K=m&65535,G=m>>>16,m=p[7],P=b[7],V+=P&65535,k+=P>>>16,K+=m&65535,G+=m>>>16,k+=V>>>16,K+=k>>>16,G+=K>>>16,p[7]=de=K&65535|G<<16,b[7]=Ue=V&65535|k<<16,x+=128,D-=128}return x}function l(d){var _=new n;_.update(d);var p=_.digest();return _.clean(),p}a.hash=l})(mf);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const t=nf,r=mf,n=rf;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function s(L){const N=new Float64Array(16);if(L)for(let A=0;A<L.length;A++)N[A]=L[A];return N}const c=new Uint8Array(32);c[0]=9;const l=s(),d=s([1]),_=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),S=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),x=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function D(L,N){for(let A=0;A<16;A++)L[A]=N[A]|0}function C(L){let N=1;for(let A=0;A<16;A++){let h=L[A]+N+65535;N=Math.floor(h/65536),L[A]=h-N*65536}L[0]+=N-1+37*(N-1)}function F(L,N,A){const h=~(A-1);for(let I=0;I<16;I++){const ee=h&(L[I]^N[I]);L[I]^=ee,N[I]^=ee}}function re(L,N){const A=s(),h=s();for(let I=0;I<16;I++)h[I]=N[I];C(h),C(h),C(h);for(let I=0;I<2;I++){A[0]=h[0]-65517;for(let ge=1;ge<15;ge++)A[ge]=h[ge]-65535-(A[ge-1]>>16&1),A[ge-1]&=65535;A[15]=h[15]-32767-(A[14]>>16&1);const ee=A[15]>>16&1;A[14]&=65535,F(h,A,1-ee)}for(let I=0;I<16;I++)L[2*I]=h[I]&255,L[2*I+1]=h[I]>>8}function he(L,N){let A=0;for(let h=0;h<32;h++)A|=L[h]^N[h];return(1&A-1>>>8)-1}function le(L,N){const A=new Uint8Array(32),h=new Uint8Array(32);return re(A,L),re(h,N),he(A,h)}function fe(L){const N=new Uint8Array(32);return re(N,L),N[0]&1}function pe(L,N){for(let A=0;A<16;A++)L[A]=N[2*A]+(N[2*A+1]<<8);L[15]&=32767}function de(L,N,A){for(let h=0;h<16;h++)L[h]=N[h]+A[h]}function j(L,N,A){for(let h=0;h<16;h++)L[h]=N[h]-A[h]}function H(L,N,A){let h,I,ee=0,ge=0,be=0,$e=0,De=0,Se=0,xt=0,mt=0,ot=0,je=0,Ye=0,Xe=0,at=0,He=0,Ze=0,Ne=0,Ke=0,ht=0,Me=0,Pt=0,Dt=0,Ht=0,kt=0,qt=0,Jt=0,rr=0,zr=0,Qt=0,Vr=0,li=0,Oi=0,lt=A[0],rt=A[1],ft=A[2],pt=A[3],ct=A[4],it=A[5],St=A[6],Ot=A[7],dt=A[8],Rt=A[9],gt=A[10],_t=A[11],yt=A[12],Qe=A[13],Tt=A[14],At=A[15];h=N[0],ee+=h*lt,ge+=h*rt,be+=h*ft,$e+=h*pt,De+=h*ct,Se+=h*it,xt+=h*St,mt+=h*Ot,ot+=h*dt,je+=h*Rt,Ye+=h*gt,Xe+=h*_t,at+=h*yt,He+=h*Qe,Ze+=h*Tt,Ne+=h*At,h=N[1],ge+=h*lt,be+=h*rt,$e+=h*ft,De+=h*pt,Se+=h*ct,xt+=h*it,mt+=h*St,ot+=h*Ot,je+=h*dt,Ye+=h*Rt,Xe+=h*gt,at+=h*_t,He+=h*yt,Ze+=h*Qe,Ne+=h*Tt,Ke+=h*At,h=N[2],be+=h*lt,$e+=h*rt,De+=h*ft,Se+=h*pt,xt+=h*ct,mt+=h*it,ot+=h*St,je+=h*Ot,Ye+=h*dt,Xe+=h*Rt,at+=h*gt,He+=h*_t,Ze+=h*yt,Ne+=h*Qe,Ke+=h*Tt,ht+=h*At,h=N[3],$e+=h*lt,De+=h*rt,Se+=h*ft,xt+=h*pt,mt+=h*ct,ot+=h*it,je+=h*St,Ye+=h*Ot,Xe+=h*dt,at+=h*Rt,He+=h*gt,Ze+=h*_t,Ne+=h*yt,Ke+=h*Qe,ht+=h*Tt,Me+=h*At,h=N[4],De+=h*lt,Se+=h*rt,xt+=h*ft,mt+=h*pt,ot+=h*ct,je+=h*it,Ye+=h*St,Xe+=h*Ot,at+=h*dt,He+=h*Rt,Ze+=h*gt,Ne+=h*_t,Ke+=h*yt,ht+=h*Qe,Me+=h*Tt,Pt+=h*At,h=N[5],Se+=h*lt,xt+=h*rt,mt+=h*ft,ot+=h*pt,je+=h*ct,Ye+=h*it,Xe+=h*St,at+=h*Ot,He+=h*dt,Ze+=h*Rt,Ne+=h*gt,Ke+=h*_t,ht+=h*yt,Me+=h*Qe,Pt+=h*Tt,Dt+=h*At,h=N[6],xt+=h*lt,mt+=h*rt,ot+=h*ft,je+=h*pt,Ye+=h*ct,Xe+=h*it,at+=h*St,He+=h*Ot,Ze+=h*dt,Ne+=h*Rt,Ke+=h*gt,ht+=h*_t,Me+=h*yt,Pt+=h*Qe,Dt+=h*Tt,Ht+=h*At,h=N[7],mt+=h*lt,ot+=h*rt,je+=h*ft,Ye+=h*pt,Xe+=h*ct,at+=h*it,He+=h*St,Ze+=h*Ot,Ne+=h*dt,Ke+=h*Rt,ht+=h*gt,Me+=h*_t,Pt+=h*yt,Dt+=h*Qe,Ht+=h*Tt,kt+=h*At,h=N[8],ot+=h*lt,je+=h*rt,Ye+=h*ft,Xe+=h*pt,at+=h*ct,He+=h*it,Ze+=h*St,Ne+=h*Ot,Ke+=h*dt,ht+=h*Rt,Me+=h*gt,Pt+=h*_t,Dt+=h*yt,Ht+=h*Qe,kt+=h*Tt,qt+=h*At,h=N[9],je+=h*lt,Ye+=h*rt,Xe+=h*ft,at+=h*pt,He+=h*ct,Ze+=h*it,Ne+=h*St,Ke+=h*Ot,ht+=h*dt,Me+=h*Rt,Pt+=h*gt,Dt+=h*_t,Ht+=h*yt,kt+=h*Qe,qt+=h*Tt,Jt+=h*At,h=N[10],Ye+=h*lt,Xe+=h*rt,at+=h*ft,He+=h*pt,Ze+=h*ct,Ne+=h*it,Ke+=h*St,ht+=h*Ot,Me+=h*dt,Pt+=h*Rt,Dt+=h*gt,Ht+=h*_t,kt+=h*yt,qt+=h*Qe,Jt+=h*Tt,rr+=h*At,h=N[11],Xe+=h*lt,at+=h*rt,He+=h*ft,Ze+=h*pt,Ne+=h*ct,Ke+=h*it,ht+=h*St,Me+=h*Ot,Pt+=h*dt,Dt+=h*Rt,Ht+=h*gt,kt+=h*_t,qt+=h*yt,Jt+=h*Qe,rr+=h*Tt,zr+=h*At,h=N[12],at+=h*lt,He+=h*rt,Ze+=h*ft,Ne+=h*pt,Ke+=h*ct,ht+=h*it,Me+=h*St,Pt+=h*Ot,Dt+=h*dt,Ht+=h*Rt,kt+=h*gt,qt+=h*_t,Jt+=h*yt,rr+=h*Qe,zr+=h*Tt,Qt+=h*At,h=N[13],He+=h*lt,Ze+=h*rt,Ne+=h*ft,Ke+=h*pt,ht+=h*ct,Me+=h*it,Pt+=h*St,Dt+=h*Ot,Ht+=h*dt,kt+=h*Rt,qt+=h*gt,Jt+=h*_t,rr+=h*yt,zr+=h*Qe,Qt+=h*Tt,Vr+=h*At,h=N[14],Ze+=h*lt,Ne+=h*rt,Ke+=h*ft,ht+=h*pt,Me+=h*ct,Pt+=h*it,Dt+=h*St,Ht+=h*Ot,kt+=h*dt,qt+=h*Rt,Jt+=h*gt,rr+=h*_t,zr+=h*yt,Qt+=h*Qe,Vr+=h*Tt,li+=h*At,h=N[15],Ne+=h*lt,Ke+=h*rt,ht+=h*ft,Me+=h*pt,Pt+=h*ct,Dt+=h*it,Ht+=h*St,kt+=h*Ot,qt+=h*dt,Jt+=h*Rt,rr+=h*gt,zr+=h*_t,Qt+=h*yt,Vr+=h*Qe,li+=h*Tt,Oi+=h*At,ee+=38*Ke,ge+=38*ht,be+=38*Me,$e+=38*Pt,De+=38*Dt,Se+=38*Ht,xt+=38*kt,mt+=38*qt,ot+=38*Jt,je+=38*rr,Ye+=38*zr,Xe+=38*Qt,at+=38*Vr,He+=38*li,Ze+=38*Oi,I=1,h=ee+I+65535,I=Math.floor(h/65536),ee=h-I*65536,h=ge+I+65535,I=Math.floor(h/65536),ge=h-I*65536,h=be+I+65535,I=Math.floor(h/65536),be=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,h=De+I+65535,I=Math.floor(h/65536),De=h-I*65536,h=Se+I+65535,I=Math.floor(h/65536),Se=h-I*65536,h=xt+I+65535,I=Math.floor(h/65536),xt=h-I*65536,h=mt+I+65535,I=Math.floor(h/65536),mt=h-I*65536,h=ot+I+65535,I=Math.floor(h/65536),ot=h-I*65536,h=je+I+65535,I=Math.floor(h/65536),je=h-I*65536,h=Ye+I+65535,I=Math.floor(h/65536),Ye=h-I*65536,h=Xe+I+65535,I=Math.floor(h/65536),Xe=h-I*65536,h=at+I+65535,I=Math.floor(h/65536),at=h-I*65536,h=He+I+65535,I=Math.floor(h/65536),He=h-I*65536,h=Ze+I+65535,I=Math.floor(h/65536),Ze=h-I*65536,h=Ne+I+65535,I=Math.floor(h/65536),Ne=h-I*65536,ee+=I-1+37*(I-1),I=1,h=ee+I+65535,I=Math.floor(h/65536),ee=h-I*65536,h=ge+I+65535,I=Math.floor(h/65536),ge=h-I*65536,h=be+I+65535,I=Math.floor(h/65536),be=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,h=De+I+65535,I=Math.floor(h/65536),De=h-I*65536,h=Se+I+65535,I=Math.floor(h/65536),Se=h-I*65536,h=xt+I+65535,I=Math.floor(h/65536),xt=h-I*65536,h=mt+I+65535,I=Math.floor(h/65536),mt=h-I*65536,h=ot+I+65535,I=Math.floor(h/65536),ot=h-I*65536,h=je+I+65535,I=Math.floor(h/65536),je=h-I*65536,h=Ye+I+65535,I=Math.floor(h/65536),Ye=h-I*65536,h=Xe+I+65535,I=Math.floor(h/65536),Xe=h-I*65536,h=at+I+65535,I=Math.floor(h/65536),at=h-I*65536,h=He+I+65535,I=Math.floor(h/65536),He=h-I*65536,h=Ze+I+65535,I=Math.floor(h/65536),Ze=h-I*65536,h=Ne+I+65535,I=Math.floor(h/65536),Ne=h-I*65536,ee+=I-1+37*(I-1),L[0]=ee,L[1]=ge,L[2]=be,L[3]=$e,L[4]=De,L[5]=Se,L[6]=xt,L[7]=mt,L[8]=ot,L[9]=je,L[10]=Ye,L[11]=Xe,L[12]=at,L[13]=He,L[14]=Ze,L[15]=Ne}function W(L,N){H(L,N,N)}function ve(L,N){const A=s();let h;for(h=0;h<16;h++)A[h]=N[h];for(h=253;h>=0;h--)W(A,A),h!==2&&h!==4&&H(A,A,N);for(h=0;h<16;h++)L[h]=A[h]}function ie(L,N){const A=s();let h;for(h=0;h<16;h++)A[h]=N[h];for(h=250;h>=0;h--)W(A,A),h!==1&&H(A,A,N);for(h=0;h<16;h++)L[h]=A[h]}function ue(L,N){const A=s(),h=s(),I=s(),ee=s(),ge=s(),be=s(),$e=s(),De=s(),Se=s();j(A,L[1],L[0]),j(Se,N[1],N[0]),H(A,A,Se),de(h,L[0],L[1]),de(Se,N[0],N[1]),H(h,h,Se),H(I,L[3],N[3]),H(I,I,p),H(ee,L[2],N[2]),de(ee,ee,ee),j(ge,h,A),j(be,ee,I),de($e,ee,I),de(De,h,A),H(L[0],ge,be),H(L[1],De,$e),H(L[2],$e,be),H(L[3],ge,De)}function Ce(L,N,A){for(let h=0;h<4;h++)F(L[h],N[h],A)}function Ue(L,N){const A=s(),h=s(),I=s();ve(I,N[2]),H(A,N[0],I),H(h,N[1],I),re(L,h),L[31]^=fe(A)<<7}function m(L,N,A){D(L[0],l),D(L[1],d),D(L[2],d),D(L[3],l);for(let h=255;h>=0;--h){const I=A[h/8|0]>>(h&7)&1;Ce(L,N,I),ue(N,L),ue(L,L),Ce(L,N,I)}}function P(L,N){const A=[s(),s(),s(),s()];D(A[0],b),D(A[1],S),D(A[2],d),H(A[3],b,S),m(L,A,N)}function X(L){if(L.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const N=(0,r.hash)(L);N[0]&=248,N[31]&=127,N[31]|=64;const A=new Uint8Array(32),h=[s(),s(),s(),s()];P(h,N),Ue(A,h);const I=new Uint8Array(64);return I.set(L),I.set(A,32),{publicKey:A,secretKey:I}}a.generateKeyPairFromSeed=X;function ce(L){const N=(0,t.randomBytes)(32,L),A=X(N);return(0,n.wipe)(N),A}a.generateKeyPair=ce;function V(L){if(L.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(L.subarray(32))}a.extractPublicKeyFromSecretKey=V;const k=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function K(L,N){let A,h,I,ee;for(h=63;h>=32;--h){for(A=0,I=h-32,ee=h-12;I<ee;++I)N[I]+=A-16*N[h]*k[I-(h-32)],A=Math.floor((N[I]+128)/256),N[I]-=A*256;N[I]+=A,N[h]=0}for(A=0,I=0;I<32;I++)N[I]+=A-(N[31]>>4)*k[I],A=N[I]>>8,N[I]&=255;for(I=0;I<32;I++)N[I]-=A*k[I];for(h=0;h<32;h++)N[h+1]+=N[h]>>8,L[h]=N[h]&255}function G(L){const N=new Float64Array(64);for(let A=0;A<64;A++)N[A]=L[A];for(let A=0;A<64;A++)L[A]=0;K(L,N)}function Je(L,N){const A=new Float64Array(64),h=[s(),s(),s(),s()],I=(0,r.hash)(L.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const ee=new Uint8Array(64);ee.set(I.subarray(32),32);const ge=new r.SHA512;ge.update(ee.subarray(32)),ge.update(N);const be=ge.digest();ge.clean(),G(be),P(h,be),Ue(ee,h),ge.reset(),ge.update(ee.subarray(0,32)),ge.update(L.subarray(32)),ge.update(N);const $e=ge.digest();G($e);for(let De=0;De<32;De++)A[De]=be[De];for(let De=0;De<32;De++)for(let Se=0;Se<32;Se++)A[De+Se]+=$e[De]*I[Se];return K(ee.subarray(32),A),ee}a.sign=Je;function Be(L,N){const A=s(),h=s(),I=s(),ee=s(),ge=s(),be=s(),$e=s();return D(L[2],d),pe(L[1],N),W(I,L[1]),H(ee,I,_),j(I,I,L[2]),de(ee,L[2],ee),W(ge,ee),W(be,ge),H($e,be,ge),H(A,$e,I),H(A,A,ee),ie(A,A),H(A,A,I),H(A,A,ee),H(A,A,ee),H(L[0],A,ee),W(h,L[0]),H(h,h,ee),le(h,I)&&H(L[0],L[0],x),W(h,L[0]),H(h,h,ee),le(h,I)?-1:(fe(L[0])===N[31]>>7&&j(L[0],l,L[0]),H(L[3],L[0],L[1]),0)}function Mr(L,N,A){const h=new Uint8Array(32),I=[s(),s(),s(),s()],ee=[s(),s(),s(),s()];if(A.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(Be(ee,L))return!1;const ge=new r.SHA512;ge.update(A.subarray(0,32)),ge.update(L),ge.update(N);const be=ge.digest();return G(be),m(I,ee,be),P(ee,A.subarray(32)),ue(I,ee),Ue(h,I),!he(A,h)}a.verify=Mr;function Ie(L){let N=[s(),s(),s(),s()];if(Be(N,L))throw new Error("Ed25519: invalid public key");let A=s(),h=s(),I=N[1];de(A,d,I),j(h,d,I),ve(h,h),H(A,A,h);let ee=new Uint8Array(32);return re(ee,A),ee}a.convertPublicKeyToX25519=Ie;function It(L){const N=(0,r.hash)(L.subarray(0,32));N[0]&=248,N[31]&=127,N[31]|=64;const A=new Uint8Array(N.subarray(0,32));return(0,n.wipe)(N),A}a.convertSecretKeyToX25519=It})(zc);const tb="EdDSA",rb="JWT",_f=".",wf="base64url",ib="utf8",nb="utf8",sb=":",ob="did",ab="key",fl="base58btc",cb="z",ub="K36",hb=32;function wo(a){return Io(qc(Bi(a),ib),wf)}function bf(a){const t=qc(ub,fl),r=cb+Io(A0([t,a]),fl);return[ob,ab,r].join(sb)}function lb(a){return Io(a,wf)}function fb(a){return qc([wo(a.header),wo(a.payload)].join(_f),nb)}function pb(a){return[wo(a.header),wo(a.payload),lb(a.signature)].join(_f)}function pl(a=nf.randomBytes(hb)){return zc.generateKeyPairFromSeed(a)}async function db(a,t,r,n,s=ne.fromMiliseconds(Date.now())){const c={alg:tb,typ:rb},l=bf(n.publicKey),d=s+r,_={iss:l,sub:a,aud:t,iat:s,exp:d},p=fb({header:c,payload:_}),b=zc.sign(n.secretKey,p);return pb({header:c,payload:_,signature:b})}const gb="PARSE_ERROR",yb="INVALID_REQUEST",vb="METHOD_NOT_FOUND",mb="INVALID_PARAMS",Ef="INTERNAL_ERROR",Uc="SERVER_ERROR",_b=[-32700,-32600,-32601,-32602,-32603],Qn={[gb]:{code:-32700,message:"Parse error"},[yb]:{code:-32600,message:"Invalid Request"},[vb]:{code:-32601,message:"Method not found"},[mb]:{code:-32602,message:"Invalid params"},[Ef]:{code:-32603,message:"Internal error"},[Uc]:{code:-32e3,message:"Server error"}},If=Uc;function wb(a){return _b.includes(a)}function dl(a){return Object.keys(Qn).includes(a)?Qn[a]:Qn[If]}function bb(a){const t=Object.values(Qn).find(r=>r.code===a);return t||Qn[If]}function xf(a,t,r){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):a}var Pf={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Sc=function(a,t){return Sc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},Sc(a,t)};function Eb(a,t){Sc(a,t);function r(){this.constructor=a}a.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Oc=function(){return Oc=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},Oc.apply(this,arguments)};function Ib(a,t){var r={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(r[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(a);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(a,n[s])&&(r[n[s]]=a[n[s]]);return r}function xb(a,t,r,n){var s=arguments.length,c=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,t,r,n);else for(var d=a.length-1;d>=0;d--)(l=a[d])&&(c=(s<3?l(c):s>3?l(t,r,c):l(t,r))||c);return s>3&&c&&Object.defineProperty(t,r,c),c}function Pb(a,t){return function(r,n){t(r,n,a)}}function Sb(a,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,t)}function Ob(a,t,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function d(b){try{p(n.next(b))}catch(S){l(S)}}function _(b){try{p(n.throw(b))}catch(S){l(S)}}function p(b){b.done?c(b.value):s(b.value).then(d,_)}p((n=n.apply(a,t||[])).next())})}function Rb(a,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,s,c,l;return l={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function d(p){return function(b){return _([p,b])}}function _(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(c=p[0]&2?s.return:p[0]?s.throw||((c=s.return)&&c.call(s),0):s.next)&&!(c=c.call(s,p[1])).done)return c;switch(s=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,s=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){r.label=p[1];break}if(p[0]===6&&r.label<c[1]){r.label=c[1],c=p;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(p);break}c[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(a,r)}catch(b){p=[6,b],s=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Tb(a,t,r,n){n===void 0&&(n=r),a[n]=t[r]}function Ab(a,t){for(var r in a)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=a[r])}function Rc(a){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&a[t],n=0;if(r)return r.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Sf(a,t){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var n=r.call(a),s,c=[],l;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)c.push(s.value)}catch(d){l={error:d}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return c}function Cb(){for(var a=[],t=0;t<arguments.length;t++)a=a.concat(Sf(arguments[t]));return a}function $b(){for(var a=0,t=0,r=arguments.length;t<r;t++)a+=arguments[t].length;for(var n=Array(a),s=0,t=0;t<r;t++)for(var c=arguments[t],l=0,d=c.length;l<d;l++,s++)n[s]=c[l];return n}function es(a){return this instanceof es?(this.v=a,this):new es(a)}function Nb(a,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(a,t||[]),s,c=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(x){n[x]&&(s[x]=function(D){return new Promise(function(C,F){c.push([x,D,C,F])>1||d(x,D)})})}function d(x,D){try{_(n[x](D))}catch(C){S(c[0][3],C)}}function _(x){x.value instanceof es?Promise.resolve(x.value.v).then(p,b):S(c[0][2],x)}function p(x){d("next",x)}function b(x){d("throw",x)}function S(x,D){x(D),c.shift(),c.length&&d(c[0][0],c[0][1])}}function Db(a){var t,r;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,c){t[s]=a[s]?function(l){return(r=!r)?{value:es(a[s](l)),done:s==="return"}:c?c(l):l}:c}}function Lb(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=a[Symbol.asyncIterator],r;return t?t.call(a):(a=typeof Rc=="function"?Rc(a):a[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(c){r[c]=a[c]&&function(l){return new Promise(function(d,_){l=a[c](l),s(d,_,l.done,l.value)})}}function s(c,l,d,_){Promise.resolve(_).then(function(p){c({value:p,done:d})},l)}}function jb(a,t){return Object.defineProperty?Object.defineProperty(a,"raw",{value:t}):a.raw=t,a}function qb(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var r in a)Object.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t.default=a,t}function Mb(a){return a&&a.__esModule?a:{default:a}}function zb(a,t){if(!t.has(a))throw new TypeError("attempted to get private field on non-instance");return t.get(a)}function Ub(a,t,r){if(!t.has(a))throw new TypeError("attempted to set private field on non-instance");return t.set(a,r),r}const Hb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Oc},__asyncDelegator:Db,__asyncGenerator:Nb,__asyncValues:Lb,__await:es,__awaiter:Ob,__classPrivateFieldGet:zb,__classPrivateFieldSet:Ub,__createBinding:Tb,__decorate:xb,__exportStar:Ab,__extends:Eb,__generator:Rb,__importDefault:Mb,__importStar:qb,__makeTemplateObject:jb,__metadata:Sb,__param:Pb,__read:Sf,__rest:Ib,__spread:Cb,__spreadArrays:$b,__values:Rc},Symbol.toStringTag,{value:"Module"})),kb=ts(Hb);var ni={},gl;function Bb(){if(gl)return ni;gl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowserCryptoAvailable=ni.getSubtleCrypto=ni.getBrowerCrypto=void 0;function a(){return(qr===null||qr===void 0?void 0:qr.crypto)||(qr===null||qr===void 0?void 0:qr.msCrypto)||{}}ni.getBrowerCrypto=a;function t(){const n=a();return n.subtle||n.webkitSubtle}ni.getSubtleCrypto=t;function r(){return!!a()&&!!t()}return ni.isBrowserCryptoAvailable=r,ni}var si={},yl;function Kb(){if(yl)return si;yl=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowser=si.isNode=si.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}si.isReactNative=a;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}si.isNode=t;function r(){return!a()&&!t()}return si.isBrowser=r,si}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=kb;t.__exportStar(Bb(),a),t.__exportStar(Kb(),a)})(Pf);function Hc(a=3){const t=Date.now()*Math.pow(10,a),r=Math.floor(Math.random()*Math.pow(10,a));return t+r}function Of(a=6){return BigInt(Hc(a))}function mn(a,t,r){return{id:r||Hc(),jsonrpc:"2.0",method:a,params:t}}function Po(a,t){return{id:a,jsonrpc:"2.0",result:t}}function So(a,t,r){return{id:a,jsonrpc:"2.0",error:Fb(t,r)}}function Fb(a,t){return typeof a>"u"?dl(Ef):(typeof a=="string"&&(a=Object.assign(Object.assign({},dl(Uc)),{message:a})),typeof t<"u"&&(a.data=t),wb(a.code)&&(a=bb(a.code)),a)}class Vb{}class Gb extends Vb{constructor(){super()}}class Wb extends Gb{constructor(t){super()}}const Jb="^https?:",Qb="^wss?:";function Yb(a){const t=a.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Rf(a,t){const r=Yb(a);return typeof r>"u"?!1:new RegExp(t).test(r)}function vl(a){return Rf(a,Jb)}function ml(a){return Rf(a,Qb)}function Xb(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function Tf(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function kc(a){return Tf(a)&&"method"in a}function Oo(a){return Tf(a)&&(ci(a)||jr(a))}function ci(a){return"result"in a}function jr(a){return"error"in a}class ui extends Wb{constructor(t){super(t),this.events=new Or.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(mn(t.method,t.params||[],t.id||Of().toString()),r)}async requestStrict(t,r){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(c){s(c)}this.events.on(`${t.id}`,c=>{jr(c)?s(c.error):n(c.result)});try{await this.connection.send(t,r)}catch(c){s(c)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Oo(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Zb=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),e1=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",_l=a=>a.split("?")[0],wl=10,t1=Zb();let r1=class{constructor(t){if(this.url=t,this.events=new Or.EventEmitter,this.registering=!1,!ml(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Bi(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!ml(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),s(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const s=new URLSearchParams(t).get("origin"),c=Pf.isReactNative()?{headers:{origin:s}}:{rejectUnauthorized:!Xb(t)},l=new t1(t,[],c);e1()?l.onerror=d=>{const _=d;n(this.emitError(_.error))}:l.on("error",d=>{n(this.emitError(d))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?is(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),s=n.message||n.toString(),c=So(t,s);this.events.emit("payload",c)}parseError(t,r=this.url){return xf(t,_l(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>wl&&this.events.setMaxListeners(wl)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${_l(this.url)}`));return this.events.emit("register_error",r),r}};var bo={exports:{}};bo.exports;(function(a,t){var r=200,n="__lodash_hash_undefined__",s=1,c=2,l=9007199254740991,d="[object Arguments]",_="[object Array]",p="[object AsyncFunction]",b="[object Boolean]",S="[object Date]",x="[object Error]",D="[object Function]",C="[object GeneratorFunction]",F="[object Map]",re="[object Number]",he="[object Null]",le="[object Object]",fe="[object Promise]",pe="[object Proxy]",de="[object RegExp]",j="[object Set]",H="[object String]",W="[object Symbol]",ve="[object Undefined]",ie="[object WeakMap]",ue="[object ArrayBuffer]",Ce="[object DataView]",Ue="[object Float32Array]",m="[object Float64Array]",P="[object Int8Array]",X="[object Int16Array]",ce="[object Int32Array]",V="[object Uint8Array]",k="[object Uint8ClampedArray]",K="[object Uint16Array]",G="[object Uint32Array]",Je=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,Mr=/^(?:0|[1-9]\d*)$/,Ie={};Ie[Ue]=Ie[m]=Ie[P]=Ie[X]=Ie[ce]=Ie[V]=Ie[k]=Ie[K]=Ie[G]=!0,Ie[d]=Ie[_]=Ie[ue]=Ie[b]=Ie[Ce]=Ie[S]=Ie[x]=Ie[D]=Ie[F]=Ie[re]=Ie[le]=Ie[de]=Ie[j]=Ie[H]=Ie[ie]=!1;var It=typeof qr=="object"&&qr&&qr.Object===Object&&qr,L=typeof self=="object"&&self&&self.Object===Object&&self,N=It||L||Function("return this")(),A=t&&!t.nodeType&&t,h=A&&!0&&a&&!a.nodeType&&a,I=h&&h.exports===A,ee=I&&It.process,ge=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),be=ge&&ge.isTypedArray;function $e(v,O){for(var U=-1,Q=v==null?0:v.length,Ve=0,me=[];++U<Q;){var et=v[U];O(et,U,v)&&(me[Ve++]=et)}return me}function De(v,O){for(var U=-1,Q=O.length,Ve=v.length;++U<Q;)v[Ve+U]=O[U];return v}function Se(v,O){for(var U=-1,Q=v==null?0:v.length;++U<Q;)if(O(v[U],U,v))return!0;return!1}function xt(v,O){for(var U=-1,Q=Array(v);++U<v;)Q[U]=O(U);return Q}function mt(v){return function(O){return v(O)}}function ot(v,O){return v.has(O)}function je(v,O){return v==null?void 0:v[O]}function Ye(v){var O=-1,U=Array(v.size);return v.forEach(function(Q,Ve){U[++O]=[Ve,Q]}),U}function Xe(v,O){return function(U){return v(O(U))}}function at(v){var O=-1,U=Array(v.size);return v.forEach(function(Q){U[++O]=Q}),U}var He=Array.prototype,Ze=Function.prototype,Ne=Object.prototype,Ke=N["__core-js_shared__"],ht=Ze.toString,Me=Ne.hasOwnProperty,Pt=function(){var v=/[^.]+$/.exec(Ke&&Ke.keys&&Ke.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Dt=Ne.toString,Ht=RegExp("^"+ht.call(Me).replace(Je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=I?N.Buffer:void 0,qt=N.Symbol,Jt=N.Uint8Array,rr=Ne.propertyIsEnumerable,zr=He.splice,Qt=qt?qt.toStringTag:void 0,Vr=Object.getOwnPropertySymbols,li=kt?kt.isBuffer:void 0,Oi=Xe(Object.keys,Object),lt=lr(N,"DataView"),rt=lr(N,"Map"),ft=lr(N,"Promise"),pt=lr(N,"Set"),ct=lr(N,"WeakMap"),it=lr(Object,"create"),St=Wr(lt),Ot=Wr(rt),dt=Wr(ft),Rt=Wr(pt),gt=Wr(ct),_t=qt?qt.prototype:void 0,yt=_t?_t.valueOf:void 0;function Qe(v){var O=-1,U=v==null?0:v.length;for(this.clear();++O<U;){var Q=v[O];this.set(Q[0],Q[1])}}function Tt(){this.__data__=it?it(null):{},this.size=0}function At(v){var O=this.has(v)&&delete this.__data__[v];return this.size-=O?1:0,O}function Ao(v){var O=this.__data__;if(it){var U=O[v];return U===n?void 0:U}return Me.call(O,v)?O[v]:void 0}function Co(v){var O=this.__data__;return it?O[v]!==void 0:Me.call(O,v)}function $o(v,O){var U=this.__data__;return this.size+=this.has(v)?0:1,U[v]=it&&O===void 0?n:O,this}Qe.prototype.clear=Tt,Qe.prototype.delete=At,Qe.prototype.get=Ao,Qe.prototype.has=Co,Qe.prototype.set=$o;function vr(v){var O=-1,U=v==null?0:v.length;for(this.clear();++O<U;){var Q=v[O];this.set(Q[0],Q[1])}}function No(){this.__data__=[],this.size=0}function Do(v){var O=this.__data__,U=Ri(O,v);if(U<0)return!1;var Q=O.length-1;return U==Q?O.pop():zr.call(O,U,1),--this.size,!0}function Lo(v){var O=this.__data__,U=Ri(O,v);return U<0?void 0:O[U][1]}function jo(v){return Ri(this.__data__,v)>-1}function qo(v,O){var U=this.__data__,Q=Ri(U,v);return Q<0?(++this.size,U.push([v,O])):U[Q][1]=O,this}vr.prototype.clear=No,vr.prototype.delete=Do,vr.prototype.get=Lo,vr.prototype.has=jo,vr.prototype.set=qo;function Gr(v){var O=-1,U=v==null?0:v.length;for(this.clear();++O<U;){var Q=v[O];this.set(Q[0],Q[1])}}function Gi(){this.size=0,this.__data__={hash:new Qe,map:new(rt||vr),string:new Qe}}function Mo(v){var O=fi(this,v).delete(v);return this.size-=O?1:0,O}function Wi(v){return fi(this,v).get(v)}function zo(v){return fi(this,v).has(v)}function Uo(v,O){var U=fi(this,v),Q=U.size;return U.set(v,O),this.size+=U.size==Q?0:1,this}Gr.prototype.clear=Gi,Gr.prototype.delete=Mo,Gr.prototype.get=Wi,Gr.prototype.has=zo,Gr.prototype.set=Uo;function Ji(v){var O=-1,U=v==null?0:v.length;for(this.__data__=new Gr;++O<U;)this.add(v[O])}function ss(v){return this.__data__.set(v,n),this}function os(v){return this.__data__.has(v)}Ji.prototype.add=Ji.prototype.push=ss,Ji.prototype.has=os;function Rr(v){var O=this.__data__=new vr(v);this.size=O.size}function Ho(){this.__data__=new vr,this.size=0}function ko(v){var O=this.__data__,U=O.delete(v);return this.size=O.size,U}function Bo(v){return this.__data__.get(v)}function Ko(v){return this.__data__.has(v)}function as(v,O){var U=this.__data__;if(U instanceof vr){var Q=U.__data__;if(!rt||Q.length<r-1)return Q.push([v,O]),this.size=++U.size,this;U=this.__data__=new Gr(Q)}return U.set(v,O),this.size=U.size,this}Rr.prototype.clear=Ho,Rr.prototype.delete=ko,Rr.prototype.get=Bo,Rr.prototype.has=Ko,Rr.prototype.set=as;function cs(v,O){var U=Xi(v),Q=!U&&ws(v),Ve=!U&&!Q&&In(v),me=!U&&!Q&&!Ve&&Is(v),et=U||Q||Ve||me,Ct=et?xt(v.length,String):[],Te=Ct.length;for(var Ge in v)(O||Me.call(v,Ge))&&!(et&&(Ge=="length"||Ve&&(Ge=="offset"||Ge=="parent")||me&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||gs(Ge,Te)))&&Ct.push(Ge);return Ct}function Ri(v,O){for(var U=v.length;U--;)if(_s(v[U][0],O))return U;return-1}function bn(v,O,U){var Q=O(v);return Xi(v)?Q:De(Q,U(v))}function Ti(v){return v==null?v===void 0?ve:he:Qt&&Qt in Object(v)?ps(v):Go(v)}function En(v){return Ci(v)&&Ti(v)==d}function Ai(v,O,U,Q,Ve){return v===O?!0:v==null||O==null||!Ci(v)&&!Ci(O)?v!==v&&O!==O:us(v,O,U,Q,Ai,Ve)}function us(v,O,U,Q,Ve,me){var et=Xi(v),Ct=Xi(O),Te=et?_:Ur(v),Ge=Ct?_:Ur(O);Te=Te==d?le:Te,Ge=Ge==d?le:Ge;var wt=Te==le,ir=Ge==le,$t=Te==Ge;if($t&&In(v)){if(!In(O))return!1;et=!0,wt=!1}if($t&&!wt)return me||(me=new Rr),et||Is(v)?Qi(v,O,U,Q,Ve,me):Vo(v,O,Te,U,Q,Ve,me);if(!(U&s)){var tt=wt&&Me.call(v,"__wrapped__"),Yt=ir&&Me.call(O,"__wrapped__");if(tt||Yt){var Tr=tt?v.value():v,mr=Yt?O.value():O;return me||(me=new Rr),Ve(Tr,mr,U,Q,me)}}return $t?(me||(me=new Rr),fs(v,O,U,Q,Ve,me)):!1}function Fo(v){if(!Es(v)||vs(v))return!1;var O=Zi(v)?Ht:Be;return O.test(Wr(v))}function hs(v){return Ci(v)&&bs(v.length)&&!!Ie[Ti(v)]}function ls(v){if(!ms(v))return Oi(v);var O=[];for(var U in Object(v))Me.call(v,U)&&U!="constructor"&&O.push(U);return O}function Qi(v,O,U,Q,Ve,me){var et=U&s,Ct=v.length,Te=O.length;if(Ct!=Te&&!(et&&Te>Ct))return!1;var Ge=me.get(v);if(Ge&&me.get(O))return Ge==O;var wt=-1,ir=!0,$t=U&c?new Ji:void 0;for(me.set(v,O),me.set(O,v);++wt<Ct;){var tt=v[wt],Yt=O[wt];if(Q)var Tr=et?Q(Yt,tt,wt,O,v,me):Q(tt,Yt,wt,v,O,me);if(Tr!==void 0){if(Tr)continue;ir=!1;break}if($t){if(!Se(O,function(mr,Hr){if(!ot($t,Hr)&&(tt===mr||Ve(tt,mr,U,Q,me)))return $t.push(Hr)})){ir=!1;break}}else if(!(tt===Yt||Ve(tt,Yt,U,Q,me))){ir=!1;break}}return me.delete(v),me.delete(O),ir}function Vo(v,O,U,Q,Ve,me,et){switch(U){case Ce:if(v.byteLength!=O.byteLength||v.byteOffset!=O.byteOffset)return!1;v=v.buffer,O=O.buffer;case ue:return!(v.byteLength!=O.byteLength||!me(new Jt(v),new Jt(O)));case b:case S:case re:return _s(+v,+O);case x:return v.name==O.name&&v.message==O.message;case de:case H:return v==O+"";case F:var Ct=Ye;case j:var Te=Q&s;if(Ct||(Ct=at),v.size!=O.size&&!Te)return!1;var Ge=et.get(v);if(Ge)return Ge==O;Q|=c,et.set(v,O);var wt=Qi(Ct(v),Ct(O),Q,Ve,me,et);return et.delete(v),wt;case W:if(yt)return yt.call(v)==yt.call(O)}return!1}function fs(v,O,U,Q,Ve,me){var et=U&s,Ct=Yi(v),Te=Ct.length,Ge=Yi(O),wt=Ge.length;if(Te!=wt&&!et)return!1;for(var ir=Te;ir--;){var $t=Ct[ir];if(!(et?$t in O:Me.call(O,$t)))return!1}var tt=me.get(v);if(tt&&me.get(O))return tt==O;var Yt=!0;me.set(v,O),me.set(O,v);for(var Tr=et;++ir<Te;){$t=Ct[ir];var mr=v[$t],Hr=O[$t];if(Q)var xn=et?Q(Hr,mr,$t,O,v,me):Q(mr,Hr,$t,v,O,me);if(!(xn===void 0?mr===Hr||Ve(mr,Hr,U,Q,me):xn)){Yt=!1;break}Tr||(Tr=$t=="constructor")}if(Yt&&!Tr){var $i=v.constructor,Mt=O.constructor;$i!=Mt&&"constructor"in v&&"constructor"in O&&!(typeof $i=="function"&&$i instanceof $i&&typeof Mt=="function"&&Mt instanceof Mt)&&(Yt=!1)}return me.delete(v),me.delete(O),Yt}function Yi(v){return bn(v,Qo,ds)}function fi(v,O){var U=v.__data__;return ys(O)?U[typeof O=="string"?"string":"hash"]:U.map}function lr(v,O){var U=je(v,O);return Fo(U)?U:void 0}function ps(v){var O=Me.call(v,Qt),U=v[Qt];try{v[Qt]=void 0;var Q=!0}catch{}var Ve=Dt.call(v);return Q&&(O?v[Qt]=U:delete v[Qt]),Ve}var ds=Vr?function(v){return v==null?[]:(v=Object(v),$e(Vr(v),function(O){return rr.call(v,O)}))}:Fe,Ur=Ti;(lt&&Ur(new lt(new ArrayBuffer(1)))!=Ce||rt&&Ur(new rt)!=F||ft&&Ur(ft.resolve())!=fe||pt&&Ur(new pt)!=j||ct&&Ur(new ct)!=ie)&&(Ur=function(v){var O=Ti(v),U=O==le?v.constructor:void 0,Q=U?Wr(U):"";if(Q)switch(Q){case St:return Ce;case Ot:return F;case dt:return fe;case Rt:return j;case gt:return ie}return O});function gs(v,O){return O=O??l,!!O&&(typeof v=="number"||Mr.test(v))&&v>-1&&v%1==0&&v<O}function ys(v){var O=typeof v;return O=="string"||O=="number"||O=="symbol"||O=="boolean"?v!=="__proto__":v===null}function vs(v){return!!Pt&&Pt in v}function ms(v){var O=v&&v.constructor,U=typeof O=="function"&&O.prototype||Ne;return v===U}function Go(v){return Dt.call(v)}function Wr(v){if(v!=null){try{return ht.call(v)}catch{}try{return v+""}catch{}}return""}function _s(v,O){return v===O||v!==v&&O!==O}var ws=En(function(){return arguments}())?En:function(v){return Ci(v)&&Me.call(v,"callee")&&!rr.call(v,"callee")},Xi=Array.isArray;function Wo(v){return v!=null&&bs(v.length)&&!Zi(v)}var In=li||ke;function Jo(v,O){return Ai(v,O)}function Zi(v){if(!Es(v))return!1;var O=Ti(v);return O==D||O==C||O==p||O==pe}function bs(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=l}function Es(v){var O=typeof v;return v!=null&&(O=="object"||O=="function")}function Ci(v){return v!=null&&typeof v=="object"}var Is=be?mt(be):hs;function Qo(v){return Wo(v)?cs(v):ls(v)}function Fe(){return[]}function ke(){return!1}a.exports=Jo})(bo,bo.exports);var i1=bo.exports;const n1=Mc(i1);function s1(a,t){return t=t||{},new Promise(function(r,n){var s=new XMLHttpRequest,c=[],l=[],d={},_=function(){return{ok:(s.status/100|0)==2,statusText:s.statusText,status:s.status,url:s.responseURL,text:function(){return Promise.resolve(s.responseText)},json:function(){return Promise.resolve(s.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([s.response]))},clone:_,headers:{keys:function(){return c},entries:function(){return l},get:function(b){return d[b.toLowerCase()]},has:function(b){return b.toLowerCase()in d}}}};for(var p in s.open(t.method||"get",a,!0),s.onload=function(){s.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(b,S,x){c.push(S=S.toLowerCase()),l.push([S,x]),d[S]=d[S]?d[S]+","+x:x}),r(_())},s.onerror=n,s.withCredentials=t.credentials=="include",t.headers)s.setRequestHeader(p,t.headers[p]);s.send(t.body||null)})}const o1=Object.freeze(Object.defineProperty({__proto__:null,default:s1},Symbol.toStringTag,{value:"Module"})),bl=ts(o1);var a1=self.fetch||(self.fetch=bl.default||bl);const c1=Mc(a1);var u1={};function h1(a,t){if(a.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<a.length;s++){var c=a.charAt(s),l=c.charCodeAt(0);if(r[l]!==255)throw new TypeError(c+" is ambiguous");r[l]=s}var d=a.length,_=a.charAt(0),p=Math.log(d)/Math.log(256),b=Math.log(256)/Math.log(d);function S(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var F=0,re=0,he=0,le=C.length;he!==le&&C[he]===0;)he++,F++;for(var fe=(le-he)*b+1>>>0,pe=new Uint8Array(fe);he!==le;){for(var de=C[he],j=0,H=fe-1;(de!==0||j<re)&&H!==-1;H--,j++)de+=256*pe[H]>>>0,pe[H]=de%d>>>0,de=de/d>>>0;if(de!==0)throw new Error("Non-zero carry");re=j,he++}for(var W=fe-re;W!==fe&&pe[W]===0;)W++;for(var ve=_.repeat(F);W<fe;++W)ve+=a.charAt(pe[W]);return ve}function x(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var F=0;if(C[F]!==" "){for(var re=0,he=0;C[F]===_;)re++,F++;for(var le=(C.length-F)*p+1>>>0,fe=new Uint8Array(le);C[F];){var pe=r[C.charCodeAt(F)];if(pe===255)return;for(var de=0,j=le-1;(pe!==0||de<he)&&j!==-1;j--,de++)pe+=d*fe[j]>>>0,fe[j]=pe%256>>>0,pe=pe/256>>>0;if(pe!==0)throw new Error("Non-zero carry");he=de,F++}if(C[F]!==" "){for(var H=le-he;H!==le&&fe[H]===0;)H++;for(var W=new Uint8Array(re+(le-H)),ve=re;H!==le;)W[ve++]=fe[H++];return W}}}function D(C){var F=x(C);if(F)return F;throw new Error(`Non-${t} character`)}return{encode:S,decodeUnsafe:x,decode:D}}var l1=h1,f1=l1;const Af=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},p1=a=>new TextEncoder().encode(a),d1=a=>new TextDecoder().decode(a);class g1{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class y1{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Cf(this,t)}}class v1{constructor(t){this.decoders=t}or(t){return Cf(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Cf=(a,t)=>new v1({...a.decoders||{[a.prefix]:a},...t.decoders||{[t.prefix]:t}});class m1{constructor(t,r,n,s){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new g1(t,r,n),this.decoder=new y1(t,r,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ro=({name:a,prefix:t,encode:r,decode:n})=>new m1(a,t,r,n),ns=({prefix:a,name:t,alphabet:r})=>{const{encode:n,decode:s}=f1(r,t);return Ro({prefix:a,name:t,encode:n,decode:c=>Af(s(c))})},_1=(a,t,r,n)=>{const s={};for(let b=0;b<t.length;++b)s[t[b]]=b;let c=a.length;for(;a[c-1]==="=";)--c;const l=new Uint8Array(c*r/8|0);let d=0,_=0,p=0;for(let b=0;b<c;++b){const S=s[a[b]];if(S===void 0)throw new SyntaxError(`Non-${n} character`);_=_<<r|S,d+=r,d>=8&&(d-=8,l[p++]=255&_>>d)}if(d>=r||255&_<<8-d)throw new SyntaxError("Unexpected end of data");return l},w1=(a,t,r)=>{const n=t[t.length-1]==="=",s=(1<<r)-1;let c="",l=0,d=0;for(let _=0;_<a.length;++_)for(d=d<<8|a[_],l+=8;l>r;)l-=r,c+=t[s&d>>l];if(l&&(c+=t[s&d<<r-l]),n)for(;c.length*r&7;)c+="=";return c},Kt=({name:a,prefix:t,bitsPerChar:r,alphabet:n})=>Ro({prefix:t,name:a,encode(s){return w1(s,n,r)},decode(s){return _1(s,n,r,a)}}),b1=Ro({prefix:"\0",name:"identity",encode:a=>d1(a),decode:a=>p1(a)});var E1=Object.freeze({__proto__:null,identity:b1});const I1=Kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var x1=Object.freeze({__proto__:null,base2:I1});const P1=Kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var S1=Object.freeze({__proto__:null,base8:P1});const O1=ns({prefix:"9",name:"base10",alphabet:"0123456789"});var R1=Object.freeze({__proto__:null,base10:O1});const T1=Kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),A1=Kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var C1=Object.freeze({__proto__:null,base16:T1,base16upper:A1});const $1=Kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),N1=Kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),D1=Kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),L1=Kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),j1=Kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),q1=Kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),M1=Kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),z1=Kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),U1=Kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var H1=Object.freeze({__proto__:null,base32:$1,base32upper:N1,base32pad:D1,base32padupper:L1,base32hex:j1,base32hexupper:q1,base32hexpad:M1,base32hexpadupper:z1,base32z:U1});const k1=ns({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),B1=ns({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var K1=Object.freeze({__proto__:null,base36:k1,base36upper:B1});const F1=ns({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),V1=ns({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var G1=Object.freeze({__proto__:null,base58btc:F1,base58flickr:V1});const W1=Kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),J1=Kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Q1=Kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Y1=Kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var X1=Object.freeze({__proto__:null,base64:W1,base64pad:J1,base64url:Q1,base64urlpad:Y1});const $f=Array.from(""),Z1=$f.reduce((a,t,r)=>(a[r]=t,a),[]),eE=$f.reduce((a,t,r)=>(a[t.codePointAt(0)]=r,a),[]);function tE(a){return a.reduce((t,r)=>(t+=Z1[r],t),"")}function rE(a){const t=[];for(const r of a){const n=eE[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const iE=Ro({prefix:"",name:"base256emoji",encode:tE,decode:rE});var nE=Object.freeze({__proto__:null,base256emoji:iE}),sE=Nf,El=128,oE=127,aE=~oE,cE=Math.pow(2,31);function Nf(a,t,r){t=t||[],r=r||0;for(var n=r;a>=cE;)t[r++]=a&255|El,a/=128;for(;a&aE;)t[r++]=a&255|El,a>>>=7;return t[r]=a|0,Nf.bytes=r-n+1,t}var uE=Tc,hE=128,Il=127;function Tc(a,n){var r=0,n=n||0,s=0,c=n,l,d=a.length;do{if(c>=d)throw Tc.bytes=0,new RangeError("Could not decode varint");l=a[c++],r+=s<28?(l&Il)<<s:(l&Il)*Math.pow(2,s),s+=7}while(l>=hE);return Tc.bytes=c-n,r}var lE=Math.pow(2,7),fE=Math.pow(2,14),pE=Math.pow(2,21),dE=Math.pow(2,28),gE=Math.pow(2,35),yE=Math.pow(2,42),vE=Math.pow(2,49),mE=Math.pow(2,56),_E=Math.pow(2,63),wE=function(a){return a<lE?1:a<fE?2:a<pE?3:a<dE?4:a<gE?5:a<yE?6:a<vE?7:a<mE?8:a<_E?9:10},bE={encode:sE,decode:uE,encodingLength:wE},Df=bE;const xl=(a,t,r=0)=>(Df.encode(a,t,r),t),Pl=a=>Df.encodingLength(a),Ac=(a,t)=>{const r=t.byteLength,n=Pl(a),s=n+Pl(r),c=new Uint8Array(s+r);return xl(a,c,0),xl(r,c,n),c.set(t,s),new EE(a,r,t,c)};class EE{constructor(t,r,n,s){this.code=t,this.size=r,this.digest=n,this.bytes=s}}const Lf=({name:a,code:t,encode:r})=>new IE(a,t,r);class IE{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Ac(this.code,r):r.then(n=>Ac(this.code,n))}else throw Error("Unknown type, must be binary type")}}const jf=a=>async t=>new Uint8Array(await crypto.subtle.digest(a,t)),xE=Lf({name:"sha2-256",code:18,encode:jf("SHA-256")}),PE=Lf({name:"sha2-512",code:19,encode:jf("SHA-512")});var SE=Object.freeze({__proto__:null,sha256:xE,sha512:PE});const qf=0,OE="identity",Mf=Af,RE=a=>Ac(qf,Mf(a)),TE={code:qf,name:OE,encode:Mf,digest:RE};var AE=Object.freeze({__proto__:null,identity:TE});new TextEncoder,new TextDecoder;const Sl={...E1,...x1,...S1,...R1,...C1,...H1,...K1,...G1,...X1,...nE};({...SE,...AE});function zf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function CE(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?zf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Uf(a,t,r,n){return{name:a,prefix:t,encoder:{name:a,prefix:t,encode:r},decoder:{decode:n}}}const Ol=Uf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),cc=Uf("ascii","a",a=>{let t="a";for(let r=0;r<a.length;r++)t+=String.fromCharCode(a[r]);return t},a=>{a=a.substring(1);const t=CE(a.length);for(let r=0;r<a.length;r++)t[r]=a.charCodeAt(r);return t}),$E={utf8:Ol,"utf-8":Ol,hex:Sl.base16,latin1:cc,ascii:cc,binary:cc,...Sl};function NE(a,t="utf8"){const r=$E[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?zf(globalThis.Buffer.from(a,"utf-8")):r.decoder.decode(`${r.prefix}${a}`)}const Hf="wc",DE=2,Bc="core",xi=`${Hf}@2:${Bc}:`,LE={name:Bc,logger:"error"},jE={database:":memory:"},qE="crypto",Rl="client_ed25519_seed",ME=ne.ONE_DAY,zE="keychain",UE="0.3",HE="messages",kE="0.3",BE=ne.SIX_HOURS,KE="publisher",kf="irn",FE="error",Bf="wss://relay.walletconnect.com",Tl="wss://relay.walletconnect.org",VE="relayer",Wt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},GE="_subscription",oi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},WE=ne.ONE_SECOND,JE="2.11.0",QE=1e4,YE="0.3",XE="WALLETCONNECT_CLIENT_ID",Dr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ZE="subscription",eI="0.3",tI=ne.FIVE_SECONDS*1e3,rI="pairing",iI="0.3",kn={wc_pairingDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:0},res:{ttl:ne.ONE_DAY,prompt:!1,tag:0}}},Wn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Fr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},nI="history",sI="0.3",oI="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},aI="0.3",uc="verify-api",yn="https://verify.walletconnect.com",Cc="https://verify.walletconnect.org",cI=[yn,Cc],uI="echo",hI="https://echo.walletconnect.com";class lI{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=zE,this.version=UE,this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()},this.get=n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:c}=Y("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(c)}return s},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,cf(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?uf(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class fI{constructor(t,r,n){this.core=t,this.logger=r,this.name=qE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),c=pl(s);return bf(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=N0();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const c=await this.getClientSeed(),l=pl(c),d=vc();return await db(d,s,ME,l)},this.generateSharedKey=(s,c,l)=>{this.isInitialized();const d=this.getPrivateKey(s),_=D0(d,c);return this.setSymKey(_,l)},this.setSymKey=async(s,c)=>{this.isInitialized();const l=c||L0(s);return await this.keychain.set(l,s),l},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,c,l)=>{this.isInitialized();const d=j0(l),_=Bi(c);if(Gh(d)){const x=d.senderPublicKey,D=d.receiverPublicKey;s=await this.generateSharedKey(x,D)}const p=this.getSymKey(s),{type:b,senderPublicKey:S}=d;return q0({type:b,symKey:p,message:_,senderPublicKey:S})},this.decode=async(s,c,l)=>{this.isInitialized();const d=M0(c,l);if(Gh(d)){const _=d.receiverPublicKey,p=d.senderPublicKey;s=await this.generateSharedKey(_,p)}try{const _=this.getSymKey(s),p=z0({symKey:_,encoded:c});return is(p)}catch(_){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(_)}},this.getPayloadType=s=>{const c=Wh(s);return U0(c.type)},this.getPayloadSenderPublicKey=s=>{const c=Wh(s);return c.senderPublicKey?Io(c.senderPublicKey,H0):void 0},this.core=t,this.logger=Re.generateChildLogger(r,this.name),this.keychain=n||new lI(this.core,this.logger)}get context(){return Re.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Rl)}catch{t=vc(),await this.keychain.set(Rl,t)}return NE(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class pI extends Fw{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=HE,this.version=kE,this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,s)=>{this.isInitialized();const c=vn(s);let l=this.messages.get(n);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=s,this.messages.set(n,l),await this.persist()),c},this.get=n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s},this.has=(n,s)=>{this.isInitialized();const c=this.get(n),l=vn(s);return typeof c[l]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Re.generateChildLogger(t,this.name),this.core=r}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,cf(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?uf(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class dI extends Vw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Or.EventEmitter,this.name=KE,this.queue=new Map,this.publishTimeout=ne.toMiliseconds(ne.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,s,c)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:c}});try{const d=(c==null?void 0:c.ttl)||BE,_=mc(c),p=(c==null?void 0:c.prompt)||!1,b=(c==null?void 0:c.tag)||0,S=(c==null?void 0:c.id)||Of().toString(),x={topic:n,message:s,opts:{ttl:d,relay:_,prompt:p,tag:b,id:S}},D=setTimeout(()=>this.queue.set(S,x),this.publishTimeout);try{await await Yn(this.rpcPublish(n,s,d,_,p,b,S),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(S),this.relayer.events.emit(Wt.publish,x)}catch(C){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=c==null?void 0:c.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(S),C;return}finally{clearTimeout(D)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:c}})}catch(d){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(d),d}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.relayer=t,this.logger=Re.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Re.getLoggerContext(this.logger)}rpcPublish(t,r,n,s,c,l,d){var _,p,b,S;const x={method:yo(s.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:c,tag:l},id:d};return Ii((_=x.params)==null?void 0:_.prompt)&&((p=x.params)==null||delete p.prompt),Ii((b=x.params)==null?void 0:b.tag)&&((S=x.params)==null||delete S.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:x}),this.relayer.request(x)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:s}=t;await this.publish(r,n,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(wn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Wt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Wt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class gI{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const s=n.filter(c=>c!==r);if(!s.length){this.map.delete(t);return}this.map.set(t,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var yI=Object.defineProperty,vI=Object.defineProperties,mI=Object.getOwnPropertyDescriptors,Al=Object.getOwnPropertySymbols,_I=Object.prototype.hasOwnProperty,wI=Object.prototype.propertyIsEnumerable,Cl=(a,t,r)=>t in a?yI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Bn=(a,t)=>{for(var r in t||(t={}))_I.call(t,r)&&Cl(a,r,t[r]);if(Al)for(var r of Al(t))wI.call(t,r)&&Cl(a,r,t[r]);return a},hc=(a,t)=>vI(a,mI(t));class bI extends Jw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new gI,this.events=new Or.EventEmitter,this.name=ZE,this.version=eI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=xi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const c=mc(s),l={topic:n,relay:c};this.pending.set(n,l);const d=await this.rpcSubscribe(n,c);return this.onSubscribe(d,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}}),d}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((s,c)=>{const l=new ne.Watch;l.start(this.pendingSubscriptionWatchLabel);const d=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(d),l.stop(this.pendingSubscriptionWatchLabel),s(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=tI&&(clearInterval(d),l.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Re.generateChildLogger(r,this.name),this.clientId=""}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async s=>await this.unsubscribeById(t,s,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const s=mc(n);await this.rpcUnsubscribe(t,r,s);const c=Gt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(t,r){const n={method:yo(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Yn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Wt.connection_stalled)}return vn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,n={method:yo(r.protocol).batchSubscribe,params:{topics:t.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Yn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Wt.connection_stalled)}}rpcUnsubscribe(t,r,n){const s={method:yo(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(t,r){this.setSubscription(t,hc(Bn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Bn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Bn({},r)),this.topicMap.set(r.topic,t),this.events.emit(Dr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(Dr.deleted,hc(Bn({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Dr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Dr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);_n(r)&&this.onBatchSubscribe(r.map((n,s)=>hc(Bn({},t[s]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(wn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Wt.connect,async()=>{await this.onConnect()}),this.relayer.on(Wt.disconnect,()=>{this.onDisconnect()}),this.events.on(Dr.created,async t=>{const r=Dr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Dr.deleted,async t=>{const r=Dr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var EI=Object.defineProperty,$l=Object.getOwnPropertySymbols,II=Object.prototype.hasOwnProperty,xI=Object.prototype.propertyIsEnumerable,Nl=(a,t,r)=>t in a?EI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,PI=(a,t)=>{for(var r in t||(t={}))II.call(t,r)&&Nl(a,r,t[r]);if($l)for(var r of $l(t))xI.call(t,r)&&Nl(a,r,t[r]);return a};class SI extends Gw{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Or.EventEmitter,this.name=VE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Wt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Wt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(oi.payload,this.onPayloadHandler),this.provider.on(oi.connect,this.onConnectHandler),this.provider.on(oi.disconnect,this.onDisconnectHandler),this.provider.on(oi.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Re.generateChildLogger(t.logger,this.name):Re.pino(Re.getDefaultLoggerOptions({level:t.logger||FE})),this.messages=new pI(this.logger,t.core),this.subscriber=new bI(this,this.logger),this.publisher=new dI(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Bf,this.projectId=t.projectId,this.bundleId=k0(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Tl}...`),await this.restartTransport(Tl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},QE)}get context(){return Re.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var n;this.isInitialized();let s=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";if(s)return s;let c;const l=d=>{d.topic===t&&(this.subscriber.off(Dr.created,l),c())};return await Promise.all([new Promise(d=>{c=d,this.subscriber.on(Dr.created,l)}),new Promise(async d=>{s=await this.subscriber.subscribe(t,r),d()})]),s}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Yn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Dr.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await Yn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(s){n(s);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(oi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Jh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ui(new r1(B0({sdkVersion:JE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const s=this.messages.has(r,n);return s&&this.logger.debug(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),kc(t)){if(!t.method.endsWith(GE))return;const r=t.params,{topic:n,message:s,publishedAt:c}=r.data,l={topic:n,message:s,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(PI({type:"event",event:r.id},l)),this.events.emit(r.id,l),await this.acknowledgePayload(t),await this.onMessageEvent(l)}else Oo(t)&&this.events.emit(Wt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Wt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Po(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(oi.payload,this.onPayloadHandler),this.provider.off(oi.connect,this.onConnectHandler),this.provider.off(oi.disconnect,this.onDisconnectHandler),this.provider.off(oi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Wt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await Jh();K0(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Wt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},ne.toMiliseconds(WE)))}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var OI=Object.defineProperty,Dl=Object.getOwnPropertySymbols,RI=Object.prototype.hasOwnProperty,TI=Object.prototype.propertyIsEnumerable,Ll=(a,t,r)=>t in a?OI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,jl=(a,t)=>{for(var r in t||(t={}))RI.call(t,r)&&Ll(a,r,t[r]);if(Dl)for(var r of Dl(t))TI.call(t,r)&&Ll(a,r,t[r]);return a};class To extends Ww{constructor(t,r,n,s=xi,c=void 0){super(t,r,n,s),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=YE,this.cached=[],this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!Ii(l)?this.map.set(this.getKey(l),l):C0(l)?this.map.set(l.id,l):$0(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,d)=>{this.isInitialized(),this.map.has(l)?await this.update(l,d):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:d}),this.map.set(l,d),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(d=>Object.keys(l).every(_=>n1(d[_],l[_]))):this.values),this.update=async(l,d)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:d});const _=jl(jl({},this.getData(l)),d);this.map.set(l,_),await this.persist()},this.delete=async(l,d)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:d}),this.map.delete(l),await this.persist())},this.logger=Re.generateChildLogger(r,this.name),this.storagePrefix=s,this.getKey=c}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class AI{constructor(t,r){this.core=t,this.logger=r,this.name=rI,this.version=iI,this.events=new jc,this.initialized=!1,this.storagePrefix=xi,this.ignoredPayloadTypes=[sf],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=vc(),s=await this.core.crypto.setSymKey(n),c=Lr(ne.FIVE_MINUTES),l={protocol:kf},d={topic:s,expiry:c,relay:l,active:!1},_=F0({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:n,relay:l});return await this.pairings.set(s,d),await this.core.relayer.subscribe(s),this.core.expirer.set(s,c),{topic:s,uri:_}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:s,symKey:c,relay:l}=Qh(n.uri);let d;if(this.pairings.keys.includes(s)&&(d=this.pairings.get(s),d.active))throw new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);const _=Lr(ne.FIVE_MINUTES),p={topic:s,relay:l,expiry:_,active:!1};return await this.pairings.set(s,p),this.core.expirer.set(s,_),n.activatePairing&&await this.activate({topic:s}),this.events.emit(Wn.create,p),this.core.crypto.keychain.has(s)||(await this.core.crypto.setSymKey(c,s),await this.core.relayer.subscribe(s,{relay:l})),p},this.activate=async({topic:n})=>{this.isInitialized();const s=Lr(ne.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:s}),this.core.expirer.set(n,s)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:s}=n;if(this.pairings.keys.includes(s)){const c=await this.sendRequest(s,"wc_pairingPing",{}),{done:l,resolve:d,reject:_}=dn();this.events.once(Nt("pairing_ping",c),({error:p})=>{p?_(p):d()}),await l()}},this.updateExpiry=async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})},this.updateMetadata=async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Gt("USER_DISCONNECTED")),await this.deletePairing(s))},this.sendRequest=async(n,s,c)=>{const l=mn(s,c),d=await this.core.crypto.encode(n,l),_=kn[s].req;return this.core.history.set(n,l),this.core.relayer.publish(n,d,_),l.id},this.sendResult=async(n,s,c)=>{const l=Po(n,c),d=await this.core.crypto.encode(s,l),_=await this.core.history.get(s,n),p=kn[_.request.method].res;await this.core.relayer.publish(s,d,p),await this.core.history.resolve(l)},this.sendError=async(n,s,c)=>{const l=So(n,c),d=await this.core.crypto.encode(s,l),_=await this.core.history.get(s,n),p=kn[_.request.method]?kn[_.request.method].res:kn.unregistered_method.res;await this.core.relayer.publish(s,d,p),await this.core.history.resolve(l)},this.deletePairing=async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Gt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(s=>Ei(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=n=>{const{topic:s,payload:c}=n;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(s,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,c);default:return this.onUnknownRpcMethodRequest(s,c)}},this.onRelayEventResponse=async n=>{const{topic:s,payload:c}=n,l=(await this.core.history.get(s,c.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(s,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(n,s)=>{const{id:c}=s;try{this.isValidPing({topic:n}),await this.sendResult(c,n,!0),this.events.emit(Wn.ping,{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onPairingPingResponse=(n,s)=>{const{id:c}=s;setTimeout(()=>{ci(s)?this.events.emit(Nt("pairing_ping",c),{}):jr(s)&&this.events.emit(Nt("pairing_ping",c),{error:s.error})},500)},this.onPairingDeleteRequest=async(n,s)=>{const{id:c}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Wn.delete,{id:c,topic:n})}catch(l){await this.sendError(c,n,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(n,s)=>{const{id:c,method:l}=s;try{if(this.registeredMethods.includes(l))return;const d=Gt("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,n,d),this.logger.error(d)}catch(d){await this.sendError(c,n,d),this.logger.error(d)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Gt("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var s;if(!hr(n)){const{message:l}=Y("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(l)}if(!V0(n.uri)){const{message:l}=Y("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(l)}const c=Qh(n.uri);if(!((s=c==null?void 0:c.relay)!=null&&s.protocol)){const{message:l}=Y("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(l)}if(!(c!=null&&c.symKey)){const{message:l}=Y("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(l)}},this.isValidPing=async n=>{if(!hr(n)){const{message:c}=Y("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(c)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidDisconnect=async n=>{if(!hr(n)){const{message:c}=Y("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(c)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async n=>{if(!gn(n,!1)){const{message:s}=Y("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=Y("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(Ei(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=Y("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}},this.core=t,this.logger=Re.generateChildLogger(r,this.name),this.pairings=new To(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Re.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Wt.message,async t=>{const{topic:r,message:n}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const s=await this.core.crypto.decode(r,n);try{kc(s)?(this.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):Oo(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.core.history.delete(r,s.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async t=>{const{topic:r}=of(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Wn.expire,{topic:r}))})}}class CI extends Kw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Or.EventEmitter,this.name=nI,this.version=sI,this.cached=[],this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,s,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:c}),this.records.has(s.id))return;const l={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:c,expiry:Lr(ne.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(Fr.created,l)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=jr(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.events.emit(Fr.updated,s))},this.get=async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s)),this.delete=(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(c=>{if(c.topic===n){if(typeof s<"u"&&c.id!==s)return;this.records.delete(c.id),this.events.emit(Fr.deleted,c)}})},this.exists=async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:mn(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Fr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Fr.created,t=>{const r=Fr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Fr.updated,t=>{const r=Fr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Fr.deleted,t=>{const r=Fr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(wn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{ne.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class $I extends Qw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Or.EventEmitter,this.name=oI,this.version=aI,this.cached=[],this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(n,s)=>{this.isInitialized();const c=this.formatTarget(n),l={target:c,expiry:s};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(Sr.created,{target:c,expiration:l})},this.get=n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)},this.del=n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),c=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Sr.deleted,{target:s,expiration:c})}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return G0(t);if(typeof t=="number")return W0(t);const{message:r}=Y("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=Y("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=Y("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;ne.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Sr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(wn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,t=>{const r=Sr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Sr.expired,t=>{const r=Sr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Sr.deleted,t=>{const r=Sr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}}}class NI extends Yw{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=uc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||J0()||!af())return;const s=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==s&&this.removeIframe(),this.verifyUrl=s;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Cc;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const s=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let c;try{c=await this.fetchAttestation(n.attestationId,s)}catch(l){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${s}`),this.logger.info(l),c=await this.fetchAttestation(n.attestationId,Cc)}return c},this.fetchAttestation=async(n,s)=>{this.logger.info(`resolving attestation: ${n} from url: ${s}`);const c=this.startAbortTimer(ne.ONE_SECOND*2),l=await fetch(`${s}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?await l.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var s;try{if(!this.iframe)return;(s=this.iframe.contentWindow)==null||s.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const s=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",s),n())};await Promise.race([new Promise(c=>{if(document.getElementById(uc))return c();window.addEventListener("message",s);const l=document.createElement("iframe");l.id=uc,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,n=c}),new Promise((c,l)=>setTimeout(()=>{window.removeEventListener("message",s),l("verify iframe load timeout")},ne.toMiliseconds(ne.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let s=n||yn;return cI.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${yn}`),s=yn),s},this.logger=Re.generateChildLogger(r,this.name),this.verifyUrl=yn,this.abortController=new AbortController,this.isDevEnv=Q0()&&u1.IS_VITEST}get context(){return Re.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ne.toMiliseconds(t))}}class DI extends Xw{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.context=uI,this.registerDeviceToken=async n=>{const{clientId:s,token:c,notificationType:l,enableEncrypted:d=!1}=n,_=`${hI}/${this.projectId}/clients`;await c1(_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:l,token:c,always_raw:d})})},this.logger=Re.generateChildLogger(r,this.context)}}var LI=Object.defineProperty,ql=Object.getOwnPropertySymbols,jI=Object.prototype.hasOwnProperty,qI=Object.prototype.propertyIsEnumerable,Ml=(a,t,r)=>t in a?LI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,zl=(a,t)=>{for(var r in t||(t={}))jI.call(t,r)&&Ml(a,r,t[r]);if(ql)for(var r of ql(t))qI.call(t,r)&&Ml(a,r,t[r]);return a};class Kc extends Bw{constructor(t){super(t),this.protocol=Hf,this.version=DE,this.name=Bc,this.events=new Or.EventEmitter,this.initialized=!1,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Bf,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||LE.logger}));this.logger=Re.generateChildLogger(r,this.name),this.heartbeat=new wn.HeartBeat,this.crypto=new fI(this,this.logger,t==null?void 0:t.keychain),this.history=new CI(this,this.logger),this.expirer=new $I(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new G_(zl(zl({},jE),t==null?void 0:t.storageOptions)),this.relayer=new SI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new AI(this,this.logger),this.verify=new NI(this.projectId||"",this.logger),this.echoClient=new DI(this.projectId||"",this.logger)}static async init(t){const r=new Kc(t);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(XE,n),r}get context(){return Re.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const MI=Kc,Kf="wc",Ff=2,Vf="client",Fc=`${Kf}@${Ff}:${Vf}:`,lc={name:Vf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Ul="WALLETCONNECT_DEEPLINK_CHOICE",zI="proposal",Gf="Proposal expired",UI="session",fo=ne.SEVEN_DAYS,HI="engine",Kn={wc_sessionPropose:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1115}}},fc={min:ne.FIVE_MINUTES,max:ne.SEVEN_DAYS},ai={idle:"IDLE",active:"ACTIVE"},kI="request",BI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var KI=Object.defineProperty,FI=Object.defineProperties,VI=Object.getOwnPropertyDescriptors,Hl=Object.getOwnPropertySymbols,GI=Object.prototype.hasOwnProperty,WI=Object.prototype.propertyIsEnumerable,kl=(a,t,r)=>t in a?KI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,cr=(a,t)=>{for(var r in t||(t={}))GI.call(t,r)&&kl(a,r,t[r]);if(Hl)for(var r of Hl(t))WI.call(t,r)&&kl(a,r,t[r]);return a},Fn=(a,t)=>FI(a,VI(t));class JI extends eb{constructor(t){super(t),this.name=HI,this.events=new jc,this.initialized=!1,this.ignoredPayloadTypes=[sf],this.requestQueue={state:ai.idle,queue:[]},this.sessionRequestQueue={state:ai.idle,queue:[]},this.requestQueueDelay=ne.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Kn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ne.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=Fn(cr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:d,relays:_}=n;let p=s,b,S=!1;if(p&&(S=this.client.core.pairing.pairings.get(p).active),!p||!S){const{topic:fe,uri:pe}=await this.client.core.pairing.create();p=fe,b=pe}const x=await this.client.core.crypto.generateKeyPair(),D=cr({requiredNamespaces:c,optionalNamespaces:l,relays:_??[{protocol:kf}],proposer:{publicKey:x,metadata:this.client.metadata}},d&&{sessionProperties:d}),{reject:C,resolve:F,done:re}=dn(ne.FIVE_MINUTES,Gf);if(this.events.once(Nt("session_connect"),async({error:fe,session:pe})=>{if(fe)C(fe);else if(pe){pe.self.publicKey=x;const de=Fn(cr({},pe),{requiredNamespaces:pe.requiredNamespaces,optionalNamespaces:pe.optionalNamespaces});await this.client.session.set(pe.topic,de),await this.setExpiry(pe.topic,pe.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:pe.peer.metadata}),F(de)}}),!p){const{message:fe}=Y("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(fe)}const he=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:D}),le=Lr(ne.FIVE_MINUTES);return await this.setProposal(he,cr({id:he,expiry:le},D)),{uri:b,approval:re}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:s,namespaces:c,sessionProperties:l}=r,d=this.client.proposal.get(n);let{pairingTopic:_,proposer:p,requiredNamespaces:b,optionalNamespaces:S}=d;_=_||"",vo(b)||(b=X0(c,"approve()"));const x=await this.client.core.crypto.generateKeyPair(),D=p.publicKey,C=await this.client.core.crypto.generateSharedKey(x,D);_&&n&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:p.metadata}),await this.sendResult({id:n,topic:_,result:{relay:{protocol:s??"irn"},responderPublicKey:x}}),await this.client.proposal.delete(n,Gt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const F=cr({relay:{protocol:s??"irn"},namespaces:c,requiredNamespaces:b,optionalNamespaces:S,pairingTopic:_,controller:{publicKey:x,metadata:this.client.metadata},expiry:Lr(fo)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(C),await this.sendRequest({topic:C,method:"wc_sessionSettle",params:F,throwOnFailedPublish:!0});const re=Fn(cr({},F),{topic:C,pairingTopic:_,acknowledged:!1,self:F.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:x});return await this.client.session.set(C,re),await this.setExpiry(C,Lr(fo)),{topic:C,acknowledged:()=>new Promise(he=>setTimeout(()=>he(this.client.session.get(C)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:s}=r,{pairingTopic:c}=this.client.proposal.get(n);c&&(await this.sendError(n,c,s),await this.client.proposal.delete(n,Gt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:s}=r,c=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s}}),{done:l,resolve:d,reject:_}=dn();return this.events.once(Nt("session_update",c),({error:p})=>{p?_(p):d()}),await this.client.session.update(n,{namespaces:s}),{acknowledged:l}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,s=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:c,resolve:l,reject:d}=dn();return this.events.once(Nt("session_extend",s),({error:_})=>{_?d(_):l()}),await this.setExpiry(n,Lr(fo)),{acknowledged:c}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:s,topic:c,expiry:l}=r,d=Hc(),{done:_,resolve:p,reject:b}=dn(l,"Request expired. Please try again.");return this.events.once(Nt("session_request",d),({error:S,result:x})=>{S?b(S):p(x)}),await Promise.all([new Promise(async S=>{await this.sendRequest({clientRpcId:d,topic:c,method:"wc_sessionRequest",params:{request:s,chainId:n},expiry:l,throwOnFailedPublish:!0}).catch(x=>b(x)),this.client.events.emit("session_request_sent",{topic:c,request:s,chainId:n,id:d}),S()}),new Promise(async S=>{const x=await Z0(this.client.core.storage,Ul);e_({id:d,topic:c,wcDeepLink:x}),S()}),_()]).then(S=>S[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:s}=r,{id:c}=s;ci(s)?await this.sendResult({id:c,topic:n,result:s.result,throwOnFailedPublish:!0}):jr(s)&&await this.sendError(c,n,s.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const s=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:c,resolve:l,reject:d}=dn();this.events.once(Nt("session_ping",s),({error:_})=>{_?d(_):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:s,chainId:c}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:c}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Gt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>t_(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(c=>{var l,d;return((l=c.peerMetadata)==null?void 0:l.url)&&((d=c.peerMetadata)==null?void 0:d.url)===r.peer.metadata.url&&c.topic&&c.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:s}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Gt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(s.publicKey)&&await this.client.core.crypto.deleteKeyPair(s.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Ul).catch(c=>this.client.logger.warn(c)),this.getPendingSessionRequests().forEach(c=>{c.topic===r&&this.deletePendingSessionRequest(c.id,Gt("USER_DISCONNECTED"))})},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Gt("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),s?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==r),s&&(this.sessionRequestQueue.state=ai.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=Kn.wc_sessionRequest.req.ttl,{id:s,topic:c,params:l,verifyContext:d}=r;await this.client.pendingRequest.set(s,{id:s,topic:c,params:l,verifyContext:d}),n&&this.client.core.expirer.set(s,Lr(n))},this.sendRequest=async r=>{const{topic:n,method:s,params:c,expiry:l,relayRpcId:d,clientRpcId:_,throwOnFailedPublish:p}=r,b=mn(s,c,_);if(af()&&BI.includes(s)){const D=vn(JSON.stringify(b));this.client.core.verify.register({attestationId:D})}const S=await this.client.core.crypto.encode(n,b),x=Kn[s].req;return l&&(x.ttl=l),d&&(x.id=d),this.client.core.history.set(n,b),p?(x.internal=Fn(cr({},x.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,S,x)):this.client.core.relayer.publish(n,S,x).catch(D=>this.client.logger.error(D)),b.id},this.sendResult=async r=>{const{id:n,topic:s,result:c,throwOnFailedPublish:l}=r,d=Po(n,c),_=await this.client.core.crypto.encode(s,d),p=await this.client.core.history.get(s,n),b=Kn[p.request.method].res;l?(b.internal=Fn(cr({},b.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,_,b)):this.client.core.relayer.publish(s,_,b).catch(S=>this.client.logger.error(S)),await this.client.core.history.resolve(d)},this.sendError=async(r,n,s)=>{const c=So(r,s),l=await this.client.core.crypto.encode(n,c),d=await this.client.core.history.get(n,r),_=Kn[d.request.method].res;this.client.core.relayer.publish(n,l,_),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(s=>{Ei(s.expiry)&&r.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Ei(s.expiry)&&n.push(s.id)}),await Promise.all([...r.map(s=>this.deleteSession(s)),...n.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ai.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ai.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ai.idle},this.processRequest=r=>{const{topic:n,payload:s}=r,c=s.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(n,s);case"wc_sessionSettle":return this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return this.onSessionExtendRequest(n,s);case"wc_sessionPing":return this.onSessionPingRequest(n,s);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return this.onSessionRequest(n,s);case"wc_sessionEvent":return this.onSessionEventRequest(n,s);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:s}=r,c=(await this.client.core.history.get(n,s.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:s}=Y("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)},this.onSessionProposeRequest=async(r,n)=>{const{params:s,id:c}=n;try{this.isValidConnect(cr({},n.params));const l=Lr(ne.FIVE_MINUTES),d=cr({id:c,pairingTopic:r,expiry:l},s);await this.setProposal(c,d);const _=vn(JSON.stringify(n)),p=await this.getVerifyContext(_,d.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:p})}catch(l){await this.sendError(c,r,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(r,n)=>{const{id:s}=n;if(ci(n)){const{result:c}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const d=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const _=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const p=await this.client.core.crypto.generateSharedKey(d,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const b=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:b}),await this.client.core.pairing.activate({topic:r})}else jr(n)&&(await this.client.proposal.delete(s,Gt("USER_DISCONNECTED")),this.events.emit(Nt("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:s,params:c}=n;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:d,expiry:_,namespaces:p,requiredNamespaces:b,optionalNamespaces:S,sessionProperties:x,pairingTopic:D}=n.params,C=cr({topic:r,relay:l,expiry:_,namespaces:p,acknowledged:!0,pairingTopic:D,requiredNamespaces:b,optionalNamespaces:S,controller:d.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:d.publicKey,metadata:d.metadata}},x&&{sessionProperties:x});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(Nt("session_connect"),{session:C}),this.cleanupDuplicatePairings(C)}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(r,n)=>{const{id:s}=n;ci(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Nt("session_approve",s),{})):jr(n)&&(await this.client.session.delete(r,Gt("USER_DISCONNECTED")),this.events.emit(Nt("session_approve",s),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:s,id:c}=n;try{const l=`${r}_session_update`,d=uo.get(l);if(d&&this.isRequestOutOfSync(d,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(cr({topic:r},s)),await this.client.session.update(r,{namespaces:s.namespaces}),await this.sendResult({id:c,topic:r,result:!0}),this.client.events.emit("session_update",{id:c,topic:r,params:s}),uo.set(l,c)}catch(l){await this.sendError(c,r,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:s}=n;ci(n)?this.events.emit(Nt("session_update",s),{}):jr(n)&&this.events.emit(Nt("session_update",s),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:s}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Lr(fo)),await this.sendResult({id:s,topic:r,result:!0}),this.client.events.emit("session_extend",{id:s,topic:r})}catch(c){await this.sendError(s,r,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(r,n)=>{const{id:s}=n;ci(n)?this.events.emit(Nt("session_extend",s),{}):jr(n)&&this.events.emit(Nt("session_extend",s),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:s}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:s,topic:r,result:!0}),this.client.events.emit("session_ping",{id:s,topic:r})}catch(c){await this.sendError(s,r,c),this.client.logger.error(c)}},this.onSessionPingResponse=(r,n)=>{const{id:s}=n;setTimeout(()=>{ci(n)?this.events.emit(Nt("session_ping",s),{}):jr(n)&&this.events.emit(Nt("session_ping",s),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Wt.publish,async()=>{c(await this.deleteSession(r))})}),this.sendResult({id:s,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:s,topic:r})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(r,n)=>{const{id:s,params:c}=n;try{this.isValidRequest(cr({topic:r},c));const l=vn(JSON.stringify(mn("wc_sessionRequest",c,s))),d=this.client.session.get(r),_=await this.getVerifyContext(l,d.peer.metadata),p={id:s,topic:r,params:c,verifyContext:_};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(r,n)=>{const{id:s}=n;ci(n)?this.events.emit(Nt("session_request",s),{result:n.result}):jr(n)&&this.events.emit(Nt("session_request",s),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:s,params:c}=n;try{const l=`${r}_session_event_${c.event.name}`,d=uo.get(l);if(d&&this.isRequestOutOfSync(d,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(cr({topic:r},c)),this.client.events.emit("session_event",{id:s,topic:r,params:c}),uo.set(l,s)}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ai.idle,this.processSessionRequestQueue()},ne.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ai.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ai.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,mn("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async r=>{if(!hr(r)){const{message:_}=Y("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(_)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:c,sessionProperties:l,relays:d}=r;if(Ii(n)||await this.isValidPairingTopic(n),!r_(d,!0)){const{message:_}=Y("MISSING_OR_INVALID",`connect() relays: ${d}`);throw new Error(_)}!Ii(s)&&vo(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!Ii(c)&&vo(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),Ii(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(r,n)=>{const s=i_(r,"connect()",n);if(s)throw new Error(s.message)},this.isValidApprove=async r=>{if(!hr(r))throw new Error(Y("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:s,relayProtocol:c,sessionProperties:l}=r;await this.isValidProposalId(n);const d=this.client.proposal.get(n),_=ec(s,"approve()");if(_)throw new Error(_.message);const p=Yh(d.requiredNamespaces,s,"approve()");if(p)throw new Error(p.message);if(!gn(c,!0)){const{message:b}=Y("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(b)}Ii(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async r=>{if(!hr(r)){const{message:c}=Y("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(c)}const{id:n,reason:s}=r;if(await this.isValidProposalId(n),!n_(s)){const{message:c}=Y("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(c)}},this.isValidSessionSettleRequest=r=>{if(!hr(r)){const{message:p}=Y("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(p)}const{relay:n,controller:s,namespaces:c,expiry:l}=r;if(!s_(n)){const{message:p}=Y("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const d=o_(s,"onSessionSettleRequest()");if(d)throw new Error(d.message);const _=ec(c,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(Ei(l)){const{message:p}=Y("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async r=>{if(!hr(r)){const{message:_}=Y("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(_)}const{topic:n,namespaces:s}=r;await this.isValidSessionTopic(n);const c=this.client.session.get(n),l=ec(s,"update()");if(l)throw new Error(l.message);const d=Yh(c.requiredNamespaces,s,"update()");if(d)throw new Error(d.message)},this.isValidExtend=async r=>{if(!hr(r)){const{message:s}=Y("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!hr(r)){const{message:_}=Y("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(_)}const{topic:n,request:s,chainId:c,expiry:l}=r;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Xh(d,c)){const{message:_}=Y("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(_)}if(!a_(s)){const{message:_}=Y("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(_)}if(!c_(d,c,s.method)){const{message:_}=Y("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(_)}if(l&&!u_(l,fc)){const{message:_}=Y("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${fc.min} and ${fc.max}`);throw new Error(_)}},this.isValidRespond=async r=>{var n;if(!hr(r)){const{message:l}=Y("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:s,response:c}=r;try{await this.isValidSessionTopic(s)}catch(l){throw(n=r==null?void 0:r.response)!=null&&n.id&&this.cleanupAfterResponse(r),l}if(!h_(c)){const{message:l}=Y("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!hr(r)){const{message:s}=Y("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!hr(r)){const{message:d}=Y("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(d)}const{topic:n,event:s,chainId:c}=r;await this.isValidSessionTopic(n);const{namespaces:l}=this.client.session.get(n);if(!Xh(l,c)){const{message:d}=Y("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(d)}if(!l_(s)){const{message:d}=Y("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(d)}if(!f_(l,c,s.name)){const{message:d}=Y("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(d)}},this.isValidDisconnect=async r=>{if(!hr(r)){const{message:s}=Y("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const s={verified:{verifyUrl:n.verifyUrl||yn,validation:"UNKNOWN",origin:n.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});c&&(s.verified.origin=c.origin,s.verified.isScam=c.isScam,s.verified.validation=c.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(s)}`),s},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(s=>{if(!gn(s,!1)){const{message:c}=Y("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:t}=Y("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Wt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const s=await this.client.core.crypto.decode(r,n);try{kc(s)?(this.client.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):Oo(s)?(await this.client.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.client.core.history.delete(r,s.id)):this.onRelayEventUnknownPayload({topic:r,payload:s})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async t=>{const{topic:r,id:n}=of(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Y("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Wn.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!gn(t,!1)){const{message:r}=Y("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=Y("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ei(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=Y("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!gn(t,!1)){const{message:r}=Y("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=Y("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ei(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=Y("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(gn(t,!1)){const{message:r}=Y("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=Y("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!p_(t)){const{message:r}=Y("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=Y("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ei(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=Y("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class QI extends To{constructor(t,r){super(t,r,zI,Fc),this.core=t,this.logger=r}}class YI extends To{constructor(t,r){super(t,r,UI,Fc),this.core=t,this.logger=r}}class XI extends To{constructor(t,r){super(t,r,kI,Fc,n=>n.id),this.core=t,this.logger=r}}let ZI=class Wf extends Zw{constructor(t){super(t),this.protocol=Kf,this.version=Ff,this.name=lc.name,this.events=new Or.EventEmitter,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}},this.update=async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}},this.request=async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}},this.find=n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||lc.name,this.metadata=(t==null?void 0:t.metadata)||Y0();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||lc.logger}));this.core=(t==null?void 0:t.core)||new MI(t),this.logger=Re.generateChildLogger(r,this.name),this.session=new YI(this.core,this.logger),this.proposal=new QI(this.core,this.logger),this.pendingRequest=new XI(this.core,this.logger),this.engine=new JI(this)}static async init(t){const r=new Wf(t);return await r.initialize(),r}get context(){return Re.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var $c={exports:{}};(function(a,t){var r=typeof self<"u"?self:qr,n=function(){function c(){this.fetch=!1,this.DOMException=r.DOMException}return c.prototype=r,new c}();(function(c){(function(l){var d={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function _(m){return m&&DataView.prototype.isPrototypeOf(m)}if(d.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=ArrayBuffer.isView||function(m){return m&&p.indexOf(Object.prototype.toString.call(m))>-1};function S(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function x(m){return typeof m!="string"&&(m=String(m)),m}function D(m){var P={next:function(){var X=m.shift();return{done:X===void 0,value:X}}};return d.iterable&&(P[Symbol.iterator]=function(){return P}),P}function C(m){this.map={},m instanceof C?m.forEach(function(P,X){this.append(X,P)},this):Array.isArray(m)?m.forEach(function(P){this.append(P[0],P[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(P){this.append(P,m[P])},this)}C.prototype.append=function(m,P){m=S(m),P=x(P);var X=this.map[m];this.map[m]=X?X+", "+P:P},C.prototype.delete=function(m){delete this.map[S(m)]},C.prototype.get=function(m){return m=S(m),this.has(m)?this.map[m]:null},C.prototype.has=function(m){return this.map.hasOwnProperty(S(m))},C.prototype.set=function(m,P){this.map[S(m)]=x(P)},C.prototype.forEach=function(m,P){for(var X in this.map)this.map.hasOwnProperty(X)&&m.call(P,this.map[X],X,this)},C.prototype.keys=function(){var m=[];return this.forEach(function(P,X){m.push(X)}),D(m)},C.prototype.values=function(){var m=[];return this.forEach(function(P){m.push(P)}),D(m)},C.prototype.entries=function(){var m=[];return this.forEach(function(P,X){m.push([X,P])}),D(m)},d.iterable&&(C.prototype[Symbol.iterator]=C.prototype.entries);function F(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function re(m){return new Promise(function(P,X){m.onload=function(){P(m.result)},m.onerror=function(){X(m.error)}})}function he(m){var P=new FileReader,X=re(P);return P.readAsArrayBuffer(m),X}function le(m){var P=new FileReader,X=re(P);return P.readAsText(m),X}function fe(m){for(var P=new Uint8Array(m),X=new Array(P.length),ce=0;ce<P.length;ce++)X[ce]=String.fromCharCode(P[ce]);return X.join("")}function pe(m){if(m.slice)return m.slice(0);var P=new Uint8Array(m.byteLength);return P.set(new Uint8Array(m)),P.buffer}function de(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:d.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:d.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:d.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():d.arrayBuffer&&d.blob&&_(m)?(this._bodyArrayBuffer=pe(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||b(m))?this._bodyArrayBuffer=pe(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var m=F(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?F(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(he)}),this.text=function(){var m=F(this);if(m)return m;if(this._bodyBlob)return le(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(fe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},d.formData&&(this.formData=function(){return this.text().then(ve)}),this.json=function(){return this.text().then(JSON.parse)},this}var j=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function H(m){var P=m.toUpperCase();return j.indexOf(P)>-1?P:m}function W(m,P){P=P||{};var X=P.body;if(m instanceof W){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,P.headers||(this.headers=new C(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!X&&m._bodyInit!=null&&(X=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=P.credentials||this.credentials||"same-origin",(P.headers||!this.headers)&&(this.headers=new C(P.headers)),this.method=H(P.method||this.method||"GET"),this.mode=P.mode||this.mode||null,this.signal=P.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}W.prototype.clone=function(){return new W(this,{body:this._bodyInit})};function ve(m){var P=new FormData;return m.trim().split("&").forEach(function(X){if(X){var ce=X.split("="),V=ce.shift().replace(/\+/g," "),k=ce.join("=").replace(/\+/g," ");P.append(decodeURIComponent(V),decodeURIComponent(k))}}),P}function ie(m){var P=new C,X=m.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(ce){var V=ce.split(":"),k=V.shift().trim();if(k){var K=V.join(":").trim();P.append(k,K)}}),P}de.call(W.prototype);function ue(m,P){P||(P={}),this.type="default",this.status=P.status===void 0?200:P.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in P?P.statusText:"OK",this.headers=new C(P.headers),this.url=P.url||"",this._initBody(m)}de.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new C(this.headers),url:this.url})},ue.error=function(){var m=new ue(null,{status:0,statusText:""});return m.type="error",m};var Ce=[301,302,303,307,308];ue.redirect=function(m,P){if(Ce.indexOf(P)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:P,headers:{location:m}})},l.DOMException=c.DOMException;try{new l.DOMException}catch{l.DOMException=function(P,X){this.message=P,this.name=X;var ce=Error(P);this.stack=ce.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function Ue(m,P){return new Promise(function(X,ce){var V=new W(m,P);if(V.signal&&V.signal.aborted)return ce(new l.DOMException("Aborted","AbortError"));var k=new XMLHttpRequest;function K(){k.abort()}k.onload=function(){var G={status:k.status,statusText:k.statusText,headers:ie(k.getAllResponseHeaders()||"")};G.url="responseURL"in k?k.responseURL:G.headers.get("X-Request-URL");var Je="response"in k?k.response:k.responseText;X(new ue(Je,G))},k.onerror=function(){ce(new TypeError("Network request failed"))},k.ontimeout=function(){ce(new TypeError("Network request failed"))},k.onabort=function(){ce(new l.DOMException("Aborted","AbortError"))},k.open(V.method,V.url,!0),V.credentials==="include"?k.withCredentials=!0:V.credentials==="omit"&&(k.withCredentials=!1),"responseType"in k&&d.blob&&(k.responseType="blob"),V.headers.forEach(function(G,Je){k.setRequestHeader(Je,G)}),V.signal&&(V.signal.addEventListener("abort",K),k.onreadystatechange=function(){k.readyState===4&&V.signal.removeEventListener("abort",K)}),k.send(typeof V._bodyInit>"u"?null:V._bodyInit)})}return Ue.polyfill=!0,c.fetch||(c.fetch=Ue,c.Headers=C,c.Request=W,c.Response=ue),l.Headers=C,l.Request=W,l.Response=ue,l.fetch=Ue,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=n;t=s.fetch,t.default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,a.exports=t})($c,$c.exports);var ex=$c.exports;const Bl=Mc(ex),tx={Accept:"application/json","Content-Type":"application/json"},rx="POST",Kl={headers:tx,method:rx},Fl=10;class Si{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Or.EventEmitter,this.isAvailable=!1,this.registering=!1,!vl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const n=Bi(t),c=await(await Bl(this.url,Object.assign(Object.assign({},Kl),{body:n}))).json();this.onPayload({data:c})}catch(n){this.onError(t.id,n)}}async register(t=this.url){if(!vl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),s(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Bi({id:1,jsonrpc:"2.0",method:"test",params:[]});await Bl(t,Object.assign(Object.assign({},Kl),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?is(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),s=n.message||n.toString(),c=So(t,s);this.events.emit("payload",c)}parseError(t,r=this.url){return xf(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Fl&&this.events.setMaxListeners(Fl)}}const Vl="error",ix="wss://relay.walletconnect.com",nx="wc",sx="universal_provider",Gl=`${nx}@2:${sx}:`,ox="https://rpc.walletconnect.com/v1/",hi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Vn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Nc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,t){(function(){var r,n="4.17.21",s=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",d="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",p=500,b="__lodash_placeholder__",S=1,x=2,D=4,C=1,F=2,re=1,he=2,le=4,fe=8,pe=16,de=32,j=64,H=128,W=256,ve=512,ie=30,ue="...",Ce=800,Ue=16,m=1,P=2,X=3,ce=1/0,V=9007199254740991,k=17976931348623157e292,K=NaN,G=4294967295,Je=G-1,Be=G>>>1,Mr=[["ary",H],["bind",re],["bindKey",he],["curry",fe],["curryRight",pe],["flip",ve],["partial",de],["partialRight",j],["rearg",W]],Ie="[object Arguments]",It="[object Array]",L="[object AsyncFunction]",N="[object Boolean]",A="[object Date]",h="[object DOMException]",I="[object Error]",ee="[object Function]",ge="[object GeneratorFunction]",be="[object Map]",$e="[object Number]",De="[object Null]",Se="[object Object]",xt="[object Promise]",mt="[object Proxy]",ot="[object RegExp]",je="[object Set]",Ye="[object String]",Xe="[object Symbol]",at="[object Undefined]",He="[object WeakMap]",Ze="[object WeakSet]",Ne="[object ArrayBuffer]",Ke="[object DataView]",ht="[object Float32Array]",Me="[object Float64Array]",Pt="[object Int8Array]",Dt="[object Int16Array]",Ht="[object Int32Array]",kt="[object Uint8Array]",qt="[object Uint8ClampedArray]",Jt="[object Uint16Array]",rr="[object Uint32Array]",zr=/\b__p \+= '';/g,Qt=/\b(__p \+=) '' \+/g,Vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,li=/&(?:amp|lt|gt|quot|#39);/g,Oi=/[&<>"']/g,lt=RegExp(li.source),rt=RegExp(Oi.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,St=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(dt.source),gt=/^\s+/,_t=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qe=/\{\n\/\* \[wrapped with (.+)\] \*/,Tt=/,? & /,At=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ao=/[()=,{}\[\]\/\s]/,Co=/\\(\\)?/g,$o=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vr=/\w*$/,No=/^[-+]0x[0-9a-f]+$/i,Do=/^0b[01]+$/i,Lo=/^\[object .+?Constructor\]$/,jo=/^0o[0-7]+$/i,qo=/^(?:0|[1-9]\d*)$/,Gr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Gi=/($^)/,Mo=/['\n\r\u2028\u2029\\]/g,Wi="\\ud800-\\udfff",zo="\\u0300-\\u036f",Uo="\\ufe20-\\ufe2f",Ji="\\u20d0-\\u20ff",ss=zo+Uo+Ji,os="\\u2700-\\u27bf",Rr="a-z\\xdf-\\xf6\\xf8-\\xff",Ho="\\xac\\xb1\\xd7\\xf7",ko="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Bo="\\u2000-\\u206f",Ko=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",as="A-Z\\xc0-\\xd6\\xd8-\\xde",cs="\\ufe0e\\ufe0f",Ri=Ho+ko+Bo+Ko,bn="[']",Ti="["+Wi+"]",En="["+Ri+"]",Ai="["+ss+"]",us="\\d+",Fo="["+os+"]",hs="["+Rr+"]",ls="[^"+Wi+Ri+us+os+Rr+as+"]",Qi="\\ud83c[\\udffb-\\udfff]",Vo="(?:"+Ai+"|"+Qi+")",fs="[^"+Wi+"]",Yi="(?:\\ud83c[\\udde6-\\uddff]){2}",fi="[\\ud800-\\udbff][\\udc00-\\udfff]",lr="["+as+"]",ps="\\u200d",ds="(?:"+hs+"|"+ls+")",Ur="(?:"+lr+"|"+ls+")",gs="(?:"+bn+"(?:d|ll|m|re|s|t|ve))?",ys="(?:"+bn+"(?:D|LL|M|RE|S|T|VE))?",vs=Vo+"?",ms="["+cs+"]?",Go="(?:"+ps+"(?:"+[fs,Yi,fi].join("|")+")"+ms+vs+")*",Wr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",_s="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ws=ms+vs+Go,Xi="(?:"+[Fo,Yi,fi].join("|")+")"+ws,Wo="(?:"+[fs+Ai+"?",Ai,Yi,fi,Ti].join("|")+")",In=RegExp(bn,"g"),Jo=RegExp(Ai,"g"),Zi=RegExp(Qi+"(?="+Qi+")|"+Wo+ws,"g"),bs=RegExp([lr+"?"+hs+"+"+gs+"(?="+[En,lr,"$"].join("|")+")",Ur+"+"+ys+"(?="+[En,lr+ds,"$"].join("|")+")",lr+"?"+ds+"+"+gs,lr+"+"+ys,_s,Wr,us,Xi].join("|"),"g"),Es=RegExp("["+ps+Wi+ss+cs+"]"),Ci=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Is=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Qo=-1,Fe={};Fe[ht]=Fe[Me]=Fe[Pt]=Fe[Dt]=Fe[Ht]=Fe[kt]=Fe[qt]=Fe[Jt]=Fe[rr]=!0,Fe[Ie]=Fe[It]=Fe[Ne]=Fe[N]=Fe[Ke]=Fe[A]=Fe[I]=Fe[ee]=Fe[be]=Fe[$e]=Fe[Se]=Fe[ot]=Fe[je]=Fe[Ye]=Fe[He]=!1;var ke={};ke[Ie]=ke[It]=ke[Ne]=ke[Ke]=ke[N]=ke[A]=ke[ht]=ke[Me]=ke[Pt]=ke[Dt]=ke[Ht]=ke[be]=ke[$e]=ke[Se]=ke[ot]=ke[je]=ke[Ye]=ke[Xe]=ke[kt]=ke[qt]=ke[Jt]=ke[rr]=!0,ke[I]=ke[ee]=ke[He]=!1;var v={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},U={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Q={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ve=parseFloat,me=parseInt,et=typeof Vn=="object"&&Vn&&Vn.Object===Object&&Vn,Ct=typeof self=="object"&&self&&self.Object===Object&&self,Te=et||Ct||Function("return this")(),Ge=t&&!t.nodeType&&t,wt=Ge&&!0&&a&&!a.nodeType&&a,ir=wt&&wt.exports===Ge,$t=ir&&et.process,tt=function(){try{var R=wt&&wt.require&&wt.require("util").types;return R||$t&&$t.binding&&$t.binding("util")}catch{}}(),Yt=tt&&tt.isArrayBuffer,Tr=tt&&tt.isDate,mr=tt&&tt.isMap,Hr=tt&&tt.isRegExp,xn=tt&&tt.isSet,$i=tt&&tt.isTypedArray;function Mt(R,q,$){switch($.length){case 0:return R.call(q);case 1:return R.call(q,$[0]);case 2:return R.call(q,$[0],$[1]);case 3:return R.call(q,$[0],$[1],$[2])}return R.apply(q,$)}function Yf(R,q,$,Z){for(var ye=-1,Le=R==null?0:R.length;++ye<Le;){var Lt=R[ye];q(Z,Lt,$(Lt),R)}return Z}function _r(R,q){for(var $=-1,Z=R==null?0:R.length;++$<Z&&q(R[$],$,R)!==!1;);return R}function Xf(R,q){for(var $=R==null?0:R.length;$--&&q(R[$],$,R)!==!1;);return R}function Wc(R,q){for(var $=-1,Z=R==null?0:R.length;++$<Z;)if(!q(R[$],$,R))return!1;return!0}function pi(R,q){for(var $=-1,Z=R==null?0:R.length,ye=0,Le=[];++$<Z;){var Lt=R[$];q(Lt,$,R)&&(Le[ye++]=Lt)}return Le}function xs(R,q){var $=R==null?0:R.length;return!!$&&en(R,q,0)>-1}function Yo(R,q,$){for(var Z=-1,ye=R==null?0:R.length;++Z<ye;)if($(q,R[Z]))return!0;return!1}function nt(R,q){for(var $=-1,Z=R==null?0:R.length,ye=Array(Z);++$<Z;)ye[$]=q(R[$],$,R);return ye}function di(R,q){for(var $=-1,Z=q.length,ye=R.length;++$<Z;)R[ye+$]=q[$];return R}function Xo(R,q,$,Z){var ye=-1,Le=R==null?0:R.length;for(Z&&Le&&($=R[++ye]);++ye<Le;)$=q($,R[ye],ye,R);return $}function Zf(R,q,$,Z){var ye=R==null?0:R.length;for(Z&&ye&&($=R[--ye]);ye--;)$=q($,R[ye],ye,R);return $}function Zo(R,q){for(var $=-1,Z=R==null?0:R.length;++$<Z;)if(q(R[$],$,R))return!0;return!1}var ep=ea("length");function tp(R){return R.split("")}function rp(R){return R.match(At)||[]}function Jc(R,q,$){var Z;return $(R,function(ye,Le,Lt){if(q(ye,Le,Lt))return Z=Le,!1}),Z}function Ps(R,q,$,Z){for(var ye=R.length,Le=$+(Z?1:-1);Z?Le--:++Le<ye;)if(q(R[Le],Le,R))return Le;return-1}function en(R,q,$){return q===q?dp(R,q,$):Ps(R,Qc,$)}function ip(R,q,$,Z){for(var ye=$-1,Le=R.length;++ye<Le;)if(Z(R[ye],q))return ye;return-1}function Qc(R){return R!==R}function Yc(R,q){var $=R==null?0:R.length;return $?ra(R,q)/$:K}function ea(R){return function(q){return q==null?r:q[R]}}function ta(R){return function(q){return R==null?r:R[q]}}function Xc(R,q,$,Z,ye){return ye(R,function(Le,Lt,We){$=Z?(Z=!1,Le):q($,Le,Lt,We)}),$}function np(R,q){var $=R.length;for(R.sort(q);$--;)R[$]=R[$].value;return R}function ra(R,q){for(var $,Z=-1,ye=R.length;++Z<ye;){var Le=q(R[Z]);Le!==r&&($=$===r?Le:$+Le)}return $}function ia(R,q){for(var $=-1,Z=Array(R);++$<R;)Z[$]=q($);return Z}function sp(R,q){return nt(q,function($){return[$,R[$]]})}function Zc(R){return R&&R.slice(0,iu(R)+1).replace(gt,"")}function fr(R){return function(q){return R(q)}}function na(R,q){return nt(q,function($){return R[$]})}function Pn(R,q){return R.has(q)}function eu(R,q){for(var $=-1,Z=R.length;++$<Z&&en(q,R[$],0)>-1;);return $}function tu(R,q){for(var $=R.length;$--&&en(q,R[$],0)>-1;);return $}function op(R,q){for(var $=R.length,Z=0;$--;)R[$]===q&&++Z;return Z}var ap=ta(v),cp=ta(O);function up(R){return"\\"+Q[R]}function hp(R,q){return R==null?r:R[q]}function tn(R){return Es.test(R)}function lp(R){return Ci.test(R)}function fp(R){for(var q,$=[];!(q=R.next()).done;)$.push(q.value);return $}function sa(R){var q=-1,$=Array(R.size);return R.forEach(function(Z,ye){$[++q]=[ye,Z]}),$}function ru(R,q){return function($){return R(q($))}}function gi(R,q){for(var $=-1,Z=R.length,ye=0,Le=[];++$<Z;){var Lt=R[$];(Lt===q||Lt===b)&&(R[$]=b,Le[ye++]=$)}return Le}function Ss(R){var q=-1,$=Array(R.size);return R.forEach(function(Z){$[++q]=Z}),$}function pp(R){var q=-1,$=Array(R.size);return R.forEach(function(Z){$[++q]=[Z,Z]}),$}function dp(R,q,$){for(var Z=$-1,ye=R.length;++Z<ye;)if(R[Z]===q)return Z;return-1}function gp(R,q,$){for(var Z=$+1;Z--;)if(R[Z]===q)return Z;return Z}function rn(R){return tn(R)?vp(R):ep(R)}function Ar(R){return tn(R)?mp(R):tp(R)}function iu(R){for(var q=R.length;q--&&_t.test(R.charAt(q)););return q}var yp=ta(U);function vp(R){for(var q=Zi.lastIndex=0;Zi.test(R);)++q;return q}function mp(R){return R.match(Zi)||[]}function _p(R){return R.match(bs)||[]}var wp=function R(q){q=q==null?Te:nn.defaults(Te.Object(),q,nn.pick(Te,Is));var $=q.Array,Z=q.Date,ye=q.Error,Le=q.Function,Lt=q.Math,We=q.Object,oa=q.RegExp,bp=q.String,wr=q.TypeError,Os=$.prototype,Ep=Le.prototype,sn=We.prototype,Rs=q["__core-js_shared__"],Ts=Ep.toString,ze=sn.hasOwnProperty,Ip=0,nu=function(){var e=/[^.]+$/.exec(Rs&&Rs.keys&&Rs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),As=sn.toString,xp=Ts.call(We),Pp=Te._,Sp=oa("^"+Ts.call(ze).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Cs=ir?q.Buffer:r,yi=q.Symbol,$s=q.Uint8Array,su=Cs?Cs.allocUnsafe:r,Ns=ru(We.getPrototypeOf,We),ou=We.create,au=sn.propertyIsEnumerable,Ds=Os.splice,cu=yi?yi.isConcatSpreadable:r,Sn=yi?yi.iterator:r,Ni=yi?yi.toStringTag:r,Ls=function(){try{var e=Mi(We,"defineProperty");return e({},"",{}),e}catch{}}(),Op=q.clearTimeout!==Te.clearTimeout&&q.clearTimeout,Rp=Z&&Z.now!==Te.Date.now&&Z.now,Tp=q.setTimeout!==Te.setTimeout&&q.setTimeout,js=Lt.ceil,qs=Lt.floor,aa=We.getOwnPropertySymbols,Ap=Cs?Cs.isBuffer:r,uu=q.isFinite,Cp=Os.join,$p=ru(We.keys,We),jt=Lt.max,Ft=Lt.min,Np=Z.now,Dp=q.parseInt,hu=Lt.random,Lp=Os.reverse,ca=Mi(q,"DataView"),On=Mi(q,"Map"),ua=Mi(q,"Promise"),on=Mi(q,"Set"),Rn=Mi(q,"WeakMap"),Tn=Mi(We,"create"),Ms=Rn&&new Rn,an={},jp=zi(ca),qp=zi(On),Mp=zi(ua),zp=zi(on),Up=zi(Rn),zs=yi?yi.prototype:r,An=zs?zs.valueOf:r,lu=zs?zs.toString:r;function g(e){if(vt(e)&&!_e(e)&&!(e instanceof Oe)){if(e instanceof br)return e;if(ze.call(e,"__wrapped__"))return fh(e)}return new br(e)}var cn=function(){function e(){}return function(i){if(!ut(i))return{};if(ou)return ou(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function Us(){}function br(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}g.templateSettings={escape:ft,evaluate:pt,interpolate:ct,variable:"",imports:{_:g}},g.prototype=Us.prototype,g.prototype.constructor=g,br.prototype=cn(Us.prototype),br.prototype.constructor=br;function Oe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=G,this.__views__=[]}function Hp(){var e=new Oe(this.__wrapped__);return e.__actions__=nr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=nr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=nr(this.__views__),e}function kp(){if(this.__filtered__){var e=new Oe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Bp(){var e=this.__wrapped__.value(),i=this.__dir__,o=_e(e),u=i<0,f=o?e.length:0,y=tg(0,f,this.__views__),w=y.start,E=y.end,T=E-w,M=u?E:w-1,z=this.__iteratees__,B=z.length,J=0,te=Ft(T,this.__takeCount__);if(!o||!u&&f==T&&te==T)return Lu(e,this.__actions__);var oe=[];e:for(;T--&&J<te;){M+=i;for(var Ee=-1,ae=e[M];++Ee<B;){var Pe=z[Ee],Ae=Pe.iteratee,gr=Pe.type,er=Ae(ae);if(gr==P)ae=er;else if(!er){if(gr==m)continue e;break e}}oe[J++]=ae}return oe}Oe.prototype=cn(Us.prototype),Oe.prototype.constructor=Oe;function Di(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function Kp(){this.__data__=Tn?Tn(null):{},this.size=0}function Fp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Vp(e){var i=this.__data__;if(Tn){var o=i[e];return o===_?r:o}return ze.call(i,e)?i[e]:r}function Gp(e){var i=this.__data__;return Tn?i[e]!==r:ze.call(i,e)}function Wp(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Tn&&i===r?_:i,this}Di.prototype.clear=Kp,Di.prototype.delete=Fp,Di.prototype.get=Vp,Di.prototype.has=Gp,Di.prototype.set=Wp;function Jr(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function Jp(){this.__data__=[],this.size=0}function Qp(e){var i=this.__data__,o=Hs(i,e);if(o<0)return!1;var u=i.length-1;return o==u?i.pop():Ds.call(i,o,1),--this.size,!0}function Yp(e){var i=this.__data__,o=Hs(i,e);return o<0?r:i[o][1]}function Xp(e){return Hs(this.__data__,e)>-1}function Zp(e,i){var o=this.__data__,u=Hs(o,e);return u<0?(++this.size,o.push([e,i])):o[u][1]=i,this}Jr.prototype.clear=Jp,Jr.prototype.delete=Qp,Jr.prototype.get=Yp,Jr.prototype.has=Xp,Jr.prototype.set=Zp;function Qr(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var u=e[i];this.set(u[0],u[1])}}function ed(){this.size=0,this.__data__={hash:new Di,map:new(On||Jr),string:new Di}}function td(e){var i=Zs(this,e).delete(e);return this.size-=i?1:0,i}function rd(e){return Zs(this,e).get(e)}function id(e){return Zs(this,e).has(e)}function nd(e,i){var o=Zs(this,e),u=o.size;return o.set(e,i),this.size+=o.size==u?0:1,this}Qr.prototype.clear=ed,Qr.prototype.delete=td,Qr.prototype.get=rd,Qr.prototype.has=id,Qr.prototype.set=nd;function Li(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new Qr;++i<o;)this.add(e[i])}function sd(e){return this.__data__.set(e,_),this}function od(e){return this.__data__.has(e)}Li.prototype.add=Li.prototype.push=sd,Li.prototype.has=od;function Cr(e){var i=this.__data__=new Jr(e);this.size=i.size}function ad(){this.__data__=new Jr,this.size=0}function cd(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function ud(e){return this.__data__.get(e)}function hd(e){return this.__data__.has(e)}function ld(e,i){var o=this.__data__;if(o instanceof Jr){var u=o.__data__;if(!On||u.length<s-1)return u.push([e,i]),this.size=++o.size,this;o=this.__data__=new Qr(u)}return o.set(e,i),this.size=o.size,this}Cr.prototype.clear=ad,Cr.prototype.delete=cd,Cr.prototype.get=ud,Cr.prototype.has=hd,Cr.prototype.set=ld;function fu(e,i){var o=_e(e),u=!o&&Ui(e),f=!o&&!u&&bi(e),y=!o&&!u&&!f&&fn(e),w=o||u||f||y,E=w?ia(e.length,bp):[],T=E.length;for(var M in e)(i||ze.call(e,M))&&!(w&&(M=="length"||f&&(M=="offset"||M=="parent")||y&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||ei(M,T)))&&E.push(M);return E}function pu(e){var i=e.length;return i?e[wa(0,i-1)]:r}function fd(e,i){return eo(nr(e),ji(i,0,e.length))}function pd(e){return eo(nr(e))}function ha(e,i,o){(o!==r&&!$r(e[i],o)||o===r&&!(i in e))&&Yr(e,i,o)}function Cn(e,i,o){var u=e[i];(!(ze.call(e,i)&&$r(u,o))||o===r&&!(i in e))&&Yr(e,i,o)}function Hs(e,i){for(var o=e.length;o--;)if($r(e[o][0],i))return o;return-1}function dd(e,i,o,u){return vi(e,function(f,y,w){i(u,f,o(f),w)}),u}function du(e,i){return e&&Br(i,zt(i),e)}function gd(e,i){return e&&Br(i,or(i),e)}function Yr(e,i,o){i=="__proto__"&&Ls?Ls(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function la(e,i){for(var o=-1,u=i.length,f=$(u),y=e==null;++o<u;)f[o]=y?r:Fa(e,i[o]);return f}function ji(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Er(e,i,o,u,f,y){var w,E=i&S,T=i&x,M=i&D;if(o&&(w=f?o(e,u,f,y):o(e)),w!==r)return w;if(!ut(e))return e;var z=_e(e);if(z){if(w=ig(e),!E)return nr(e,w)}else{var B=Vt(e),J=B==ee||B==ge;if(bi(e))return Mu(e,E);if(B==Se||B==Ie||J&&!f){if(w=T||J?{}:ih(e),!E)return T?Vd(e,gd(w,e)):Fd(e,du(w,e))}else{if(!ke[B])return f?e:{};w=ng(e,B,E)}}y||(y=new Cr);var te=y.get(e);if(te)return te;y.set(e,w),$h(e)?e.forEach(function(ae){w.add(Er(ae,i,o,ae,e,y))}):Ah(e)&&e.forEach(function(ae,Pe){w.set(Pe,Er(ae,i,o,Pe,e,y))});var oe=M?T?Ca:Aa:T?or:zt,Ee=z?r:oe(e);return _r(Ee||e,function(ae,Pe){Ee&&(Pe=ae,ae=e[Pe]),Cn(w,Pe,Er(ae,i,o,Pe,e,y))}),w}function yd(e){var i=zt(e);return function(o){return gu(o,e,i)}}function gu(e,i,o){var u=o.length;if(e==null)return!u;for(e=We(e);u--;){var f=o[u],y=i[f],w=e[f];if(w===r&&!(f in e)||!y(w))return!1}return!0}function yu(e,i,o){if(typeof e!="function")throw new wr(l);return Mn(function(){e.apply(r,o)},i)}function $n(e,i,o,u){var f=-1,y=xs,w=!0,E=e.length,T=[],M=i.length;if(!E)return T;o&&(i=nt(i,fr(o))),u?(y=Yo,w=!1):i.length>=s&&(y=Pn,w=!1,i=new Li(i));e:for(;++f<E;){var z=e[f],B=o==null?z:o(z);if(z=u||z!==0?z:0,w&&B===B){for(var J=M;J--;)if(i[J]===B)continue e;T.push(z)}else y(i,B,u)||T.push(z)}return T}var vi=Bu(kr),vu=Bu(pa,!0);function vd(e,i){var o=!0;return vi(e,function(u,f,y){return o=!!i(u,f,y),o}),o}function ks(e,i,o){for(var u=-1,f=e.length;++u<f;){var y=e[u],w=i(y);if(w!=null&&(E===r?w===w&&!dr(w):o(w,E)))var E=w,T=y}return T}function md(e,i,o,u){var f=e.length;for(o=we(o),o<0&&(o=-o>f?0:f+o),u=u===r||u>f?f:we(u),u<0&&(u+=f),u=o>u?0:Dh(u);o<u;)e[o++]=i;return e}function mu(e,i){var o=[];return vi(e,function(u,f,y){i(u,f,y)&&o.push(u)}),o}function Bt(e,i,o,u,f){var y=-1,w=e.length;for(o||(o=og),f||(f=[]);++y<w;){var E=e[y];i>0&&o(E)?i>1?Bt(E,i-1,o,u,f):di(f,E):u||(f[f.length]=E)}return f}var fa=Ku(),_u=Ku(!0);function kr(e,i){return e&&fa(e,i,zt)}function pa(e,i){return e&&_u(e,i,zt)}function Bs(e,i){return pi(i,function(o){return ti(e[o])})}function qi(e,i){i=_i(i,e);for(var o=0,u=i.length;e!=null&&o<u;)e=e[Kr(i[o++])];return o&&o==u?e:r}function wu(e,i,o){var u=i(e);return _e(e)?u:di(u,o(e))}function Xt(e){return e==null?e===r?at:De:Ni&&Ni in We(e)?eg(e):pg(e)}function da(e,i){return e>i}function _d(e,i){return e!=null&&ze.call(e,i)}function wd(e,i){return e!=null&&i in We(e)}function bd(e,i,o){return e>=Ft(i,o)&&e<jt(i,o)}function ga(e,i,o){for(var u=o?Yo:xs,f=e[0].length,y=e.length,w=y,E=$(y),T=1/0,M=[];w--;){var z=e[w];w&&i&&(z=nt(z,fr(i))),T=Ft(z.length,T),E[w]=!o&&(i||f>=120&&z.length>=120)?new Li(w&&z):r}z=e[0];var B=-1,J=E[0];e:for(;++B<f&&M.length<T;){var te=z[B],oe=i?i(te):te;if(te=o||te!==0?te:0,!(J?Pn(J,oe):u(M,oe,o))){for(w=y;--w;){var Ee=E[w];if(!(Ee?Pn(Ee,oe):u(e[w],oe,o)))continue e}J&&J.push(oe),M.push(te)}}return M}function Ed(e,i,o,u){return kr(e,function(f,y,w){i(u,o(f),y,w)}),u}function Nn(e,i,o){i=_i(i,e),e=ah(e,i);var u=e==null?e:e[Kr(xr(i))];return u==null?r:Mt(u,e,o)}function bu(e){return vt(e)&&Xt(e)==Ie}function Id(e){return vt(e)&&Xt(e)==Ne}function xd(e){return vt(e)&&Xt(e)==A}function Dn(e,i,o,u,f){return e===i?!0:e==null||i==null||!vt(e)&&!vt(i)?e!==e&&i!==i:Pd(e,i,o,u,Dn,f)}function Pd(e,i,o,u,f,y){var w=_e(e),E=_e(i),T=w?It:Vt(e),M=E?It:Vt(i);T=T==Ie?Se:T,M=M==Ie?Se:M;var z=T==Se,B=M==Se,J=T==M;if(J&&bi(e)){if(!bi(i))return!1;w=!0,z=!1}if(J&&!z)return y||(y=new Cr),w||fn(e)?eh(e,i,o,u,f,y):Xd(e,i,T,o,u,f,y);if(!(o&C)){var te=z&&ze.call(e,"__wrapped__"),oe=B&&ze.call(i,"__wrapped__");if(te||oe){var Ee=te?e.value():e,ae=oe?i.value():i;return y||(y=new Cr),f(Ee,ae,o,u,y)}}return J?(y||(y=new Cr),Zd(e,i,o,u,f,y)):!1}function Sd(e){return vt(e)&&Vt(e)==be}function ya(e,i,o,u){var f=o.length,y=f,w=!u;if(e==null)return!y;for(e=We(e);f--;){var E=o[f];if(w&&E[2]?E[1]!==e[E[0]]:!(E[0]in e))return!1}for(;++f<y;){E=o[f];var T=E[0],M=e[T],z=E[1];if(w&&E[2]){if(M===r&&!(T in e))return!1}else{var B=new Cr;if(u)var J=u(M,z,T,e,i,B);if(!(J===r?Dn(z,M,C|F,u,B):J))return!1}}return!0}function Eu(e){if(!ut(e)||cg(e))return!1;var i=ti(e)?Sp:Lo;return i.test(zi(e))}function Od(e){return vt(e)&&Xt(e)==ot}function Rd(e){return vt(e)&&Vt(e)==je}function Td(e){return vt(e)&&oo(e.length)&&!!Fe[Xt(e)]}function Iu(e){return typeof e=="function"?e:e==null?ar:typeof e=="object"?_e(e)?Su(e[0],e[1]):Pu(e):Fh(e)}function va(e){if(!qn(e))return $p(e);var i=[];for(var o in We(e))ze.call(e,o)&&o!="constructor"&&i.push(o);return i}function Ad(e){if(!ut(e))return fg(e);var i=qn(e),o=[];for(var u in e)u=="constructor"&&(i||!ze.call(e,u))||o.push(u);return o}function ma(e,i){return e<i}function xu(e,i){var o=-1,u=sr(e)?$(e.length):[];return vi(e,function(f,y,w){u[++o]=i(f,y,w)}),u}function Pu(e){var i=Na(e);return i.length==1&&i[0][2]?sh(i[0][0],i[0][1]):function(o){return o===e||ya(o,e,i)}}function Su(e,i){return La(e)&&nh(i)?sh(Kr(e),i):function(o){var u=Fa(o,e);return u===r&&u===i?Va(o,e):Dn(i,u,C|F)}}function Ks(e,i,o,u,f){e!==i&&fa(i,function(y,w){if(f||(f=new Cr),ut(y))Cd(e,i,w,o,Ks,u,f);else{var E=u?u(qa(e,w),y,w+"",e,i,f):r;E===r&&(E=y),ha(e,w,E)}},or)}function Cd(e,i,o,u,f,y,w){var E=qa(e,o),T=qa(i,o),M=w.get(T);if(M){ha(e,o,M);return}var z=y?y(E,T,o+"",e,i,w):r,B=z===r;if(B){var J=_e(T),te=!J&&bi(T),oe=!J&&!te&&fn(T);z=T,J||te||oe?_e(E)?z=E:bt(E)?z=nr(E):te?(B=!1,z=Mu(T,!0)):oe?(B=!1,z=zu(T,!0)):z=[]:zn(T)||Ui(T)?(z=E,Ui(E)?z=Lh(E):(!ut(E)||ti(E))&&(z=ih(T))):B=!1}B&&(w.set(T,z),f(z,T,u,y,w),w.delete(T)),ha(e,o,z)}function Ou(e,i){var o=e.length;if(o)return i+=i<0?o:0,ei(i,o)?e[i]:r}function Ru(e,i,o){i.length?i=nt(i,function(y){return _e(y)?function(w){return qi(w,y.length===1?y[0]:y)}:y}):i=[ar];var u=-1;i=nt(i,fr(se()));var f=xu(e,function(y,w,E){var T=nt(i,function(M){return M(y)});return{criteria:T,index:++u,value:y}});return np(f,function(y,w){return Kd(y,w,o)})}function $d(e,i){return Tu(e,i,function(o,u){return Va(e,u)})}function Tu(e,i,o){for(var u=-1,f=i.length,y={};++u<f;){var w=i[u],E=qi(e,w);o(E,w)&&Ln(y,_i(w,e),E)}return y}function Nd(e){return function(i){return qi(i,e)}}function _a(e,i,o,u){var f=u?ip:en,y=-1,w=i.length,E=e;for(e===i&&(i=nr(i)),o&&(E=nt(e,fr(o)));++y<w;)for(var T=0,M=i[y],z=o?o(M):M;(T=f(E,z,T,u))>-1;)E!==e&&Ds.call(E,T,1),Ds.call(e,T,1);return e}function Au(e,i){for(var o=e?i.length:0,u=o-1;o--;){var f=i[o];if(o==u||f!==y){var y=f;ei(f)?Ds.call(e,f,1):Ia(e,f)}}return e}function wa(e,i){return e+qs(hu()*(i-e+1))}function Dd(e,i,o,u){for(var f=-1,y=jt(js((i-e)/(o||1)),0),w=$(y);y--;)w[u?y:++f]=e,e+=o;return w}function ba(e,i){var o="";if(!e||i<1||i>V)return o;do i%2&&(o+=e),i=qs(i/2),i&&(e+=e);while(i);return o}function xe(e,i){return Ma(oh(e,i,ar),e+"")}function Ld(e){return pu(pn(e))}function jd(e,i){var o=pn(e);return eo(o,ji(i,0,o.length))}function Ln(e,i,o,u){if(!ut(e))return e;i=_i(i,e);for(var f=-1,y=i.length,w=y-1,E=e;E!=null&&++f<y;){var T=Kr(i[f]),M=o;if(T==="__proto__"||T==="constructor"||T==="prototype")return e;if(f!=w){var z=E[T];M=u?u(z,T,E):r,M===r&&(M=ut(z)?z:ei(i[f+1])?[]:{})}Cn(E,T,M),E=E[T]}return e}var Cu=Ms?function(e,i){return Ms.set(e,i),e}:ar,qd=Ls?function(e,i){return Ls(e,"toString",{configurable:!0,enumerable:!1,value:Wa(i),writable:!0})}:ar;function Md(e){return eo(pn(e))}function Ir(e,i,o){var u=-1,f=e.length;i<0&&(i=-i>f?0:f+i),o=o>f?f:o,o<0&&(o+=f),f=i>o?0:o-i>>>0,i>>>=0;for(var y=$(f);++u<f;)y[u]=e[u+i];return y}function zd(e,i){var o;return vi(e,function(u,f,y){return o=i(u,f,y),!o}),!!o}function Fs(e,i,o){var u=0,f=e==null?u:e.length;if(typeof i=="number"&&i===i&&f<=Be){for(;u<f;){var y=u+f>>>1,w=e[y];w!==null&&!dr(w)&&(o?w<=i:w<i)?u=y+1:f=y}return f}return Ea(e,i,ar,o)}function Ea(e,i,o,u){var f=0,y=e==null?0:e.length;if(y===0)return 0;i=o(i);for(var w=i!==i,E=i===null,T=dr(i),M=i===r;f<y;){var z=qs((f+y)/2),B=o(e[z]),J=B!==r,te=B===null,oe=B===B,Ee=dr(B);if(w)var ae=u||oe;else M?ae=oe&&(u||J):E?ae=oe&&J&&(u||!te):T?ae=oe&&J&&!te&&(u||!Ee):te||Ee?ae=!1:ae=u?B<=i:B<i;ae?f=z+1:y=z}return Ft(y,Je)}function $u(e,i){for(var o=-1,u=e.length,f=0,y=[];++o<u;){var w=e[o],E=i?i(w):w;if(!o||!$r(E,T)){var T=E;y[f++]=w===0?0:w}}return y}function Nu(e){return typeof e=="number"?e:dr(e)?K:+e}function pr(e){if(typeof e=="string")return e;if(_e(e))return nt(e,pr)+"";if(dr(e))return lu?lu.call(e):"";var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function mi(e,i,o){var u=-1,f=xs,y=e.length,w=!0,E=[],T=E;if(o)w=!1,f=Yo;else if(y>=s){var M=i?null:Qd(e);if(M)return Ss(M);w=!1,f=Pn,T=new Li}else T=i?[]:E;e:for(;++u<y;){var z=e[u],B=i?i(z):z;if(z=o||z!==0?z:0,w&&B===B){for(var J=T.length;J--;)if(T[J]===B)continue e;i&&T.push(B),E.push(z)}else f(T,B,o)||(T!==E&&T.push(B),E.push(z))}return E}function Ia(e,i){return i=_i(i,e),e=ah(e,i),e==null||delete e[Kr(xr(i))]}function Du(e,i,o,u){return Ln(e,i,o(qi(e,i)),u)}function Vs(e,i,o,u){for(var f=e.length,y=u?f:-1;(u?y--:++y<f)&&i(e[y],y,e););return o?Ir(e,u?0:y,u?y+1:f):Ir(e,u?y+1:0,u?f:y)}function Lu(e,i){var o=e;return o instanceof Oe&&(o=o.value()),Xo(i,function(u,f){return f.func.apply(f.thisArg,di([u],f.args))},o)}function xa(e,i,o){var u=e.length;if(u<2)return u?mi(e[0]):[];for(var f=-1,y=$(u);++f<u;)for(var w=e[f],E=-1;++E<u;)E!=f&&(y[f]=$n(y[f]||w,e[E],i,o));return mi(Bt(y,1),i,o)}function ju(e,i,o){for(var u=-1,f=e.length,y=i.length,w={};++u<f;){var E=u<y?i[u]:r;o(w,e[u],E)}return w}function Pa(e){return bt(e)?e:[]}function Sa(e){return typeof e=="function"?e:ar}function _i(e,i){return _e(e)?e:La(e,i)?[e]:lh(qe(e))}var Ud=xe;function wi(e,i,o){var u=e.length;return o=o===r?u:o,!i&&o>=u?e:Ir(e,i,o)}var qu=Op||function(e){return Te.clearTimeout(e)};function Mu(e,i){if(i)return e.slice();var o=e.length,u=su?su(o):new e.constructor(o);return e.copy(u),u}function Oa(e){var i=new e.constructor(e.byteLength);return new $s(i).set(new $s(e)),i}function Hd(e,i){var o=i?Oa(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function kd(e){var i=new e.constructor(e.source,vr.exec(e));return i.lastIndex=e.lastIndex,i}function Bd(e){return An?We(An.call(e)):{}}function zu(e,i){var o=i?Oa(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function Uu(e,i){if(e!==i){var o=e!==r,u=e===null,f=e===e,y=dr(e),w=i!==r,E=i===null,T=i===i,M=dr(i);if(!E&&!M&&!y&&e>i||y&&w&&T&&!E&&!M||u&&w&&T||!o&&T||!f)return 1;if(!u&&!y&&!M&&e<i||M&&o&&f&&!u&&!y||E&&o&&f||!w&&f||!T)return-1}return 0}function Kd(e,i,o){for(var u=-1,f=e.criteria,y=i.criteria,w=f.length,E=o.length;++u<w;){var T=Uu(f[u],y[u]);if(T){if(u>=E)return T;var M=o[u];return T*(M=="desc"?-1:1)}}return e.index-i.index}function Hu(e,i,o,u){for(var f=-1,y=e.length,w=o.length,E=-1,T=i.length,M=jt(y-w,0),z=$(T+M),B=!u;++E<T;)z[E]=i[E];for(;++f<w;)(B||f<y)&&(z[o[f]]=e[f]);for(;M--;)z[E++]=e[f++];return z}function ku(e,i,o,u){for(var f=-1,y=e.length,w=-1,E=o.length,T=-1,M=i.length,z=jt(y-E,0),B=$(z+M),J=!u;++f<z;)B[f]=e[f];for(var te=f;++T<M;)B[te+T]=i[T];for(;++w<E;)(J||f<y)&&(B[te+o[w]]=e[f++]);return B}function nr(e,i){var o=-1,u=e.length;for(i||(i=$(u));++o<u;)i[o]=e[o];return i}function Br(e,i,o,u){var f=!o;o||(o={});for(var y=-1,w=i.length;++y<w;){var E=i[y],T=u?u(o[E],e[E],E,o,e):r;T===r&&(T=e[E]),f?Yr(o,E,T):Cn(o,E,T)}return o}function Fd(e,i){return Br(e,Da(e),i)}function Vd(e,i){return Br(e,th(e),i)}function Gs(e,i){return function(o,u){var f=_e(o)?Yf:dd,y=i?i():{};return f(o,e,se(u,2),y)}}function un(e){return xe(function(i,o){var u=-1,f=o.length,y=f>1?o[f-1]:r,w=f>2?o[2]:r;for(y=e.length>3&&typeof y=="function"?(f--,y):r,w&&Zt(o[0],o[1],w)&&(y=f<3?r:y,f=1),i=We(i);++u<f;){var E=o[u];E&&e(i,E,u,y)}return i})}function Bu(e,i){return function(o,u){if(o==null)return o;if(!sr(o))return e(o,u);for(var f=o.length,y=i?f:-1,w=We(o);(i?y--:++y<f)&&u(w[y],y,w)!==!1;);return o}}function Ku(e){return function(i,o,u){for(var f=-1,y=We(i),w=u(i),E=w.length;E--;){var T=w[e?E:++f];if(o(y[T],T,y)===!1)break}return i}}function Gd(e,i,o){var u=i&re,f=jn(e);function y(){var w=this&&this!==Te&&this instanceof y?f:e;return w.apply(u?o:this,arguments)}return y}function Fu(e){return function(i){i=qe(i);var o=tn(i)?Ar(i):r,u=o?o[0]:i.charAt(0),f=o?wi(o,1).join(""):i.slice(1);return u[e]()+f}}function hn(e){return function(i){return Xo(Bh(kh(i).replace(In,"")),e,"")}}function jn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=cn(e.prototype),u=e.apply(o,i);return ut(u)?u:o}}function Wd(e,i,o){var u=jn(e);function f(){for(var y=arguments.length,w=$(y),E=y,T=ln(f);E--;)w[E]=arguments[E];var M=y<3&&w[0]!==T&&w[y-1]!==T?[]:gi(w,T);if(y-=M.length,y<o)return Qu(e,i,Ws,f.placeholder,r,w,M,r,r,o-y);var z=this&&this!==Te&&this instanceof f?u:e;return Mt(z,this,w)}return f}function Vu(e){return function(i,o,u){var f=We(i);if(!sr(i)){var y=se(o,3);i=zt(i),o=function(E){return y(f[E],E,f)}}var w=e(i,o,u);return w>-1?f[y?i[w]:w]:r}}function Gu(e){return Zr(function(i){var o=i.length,u=o,f=br.prototype.thru;for(e&&i.reverse();u--;){var y=i[u];if(typeof y!="function")throw new wr(l);if(f&&!w&&Xs(y)=="wrapper")var w=new br([],!0)}for(u=w?u:o;++u<o;){y=i[u];var E=Xs(y),T=E=="wrapper"?$a(y):r;T&&ja(T[0])&&T[1]==(H|fe|de|W)&&!T[4].length&&T[9]==1?w=w[Xs(T[0])].apply(w,T[3]):w=y.length==1&&ja(y)?w[E]():w.thru(y)}return function(){var M=arguments,z=M[0];if(w&&M.length==1&&_e(z))return w.plant(z).value();for(var B=0,J=o?i[B].apply(this,M):z;++B<o;)J=i[B].call(this,J);return J}})}function Ws(e,i,o,u,f,y,w,E,T,M){var z=i&H,B=i&re,J=i&he,te=i&(fe|pe),oe=i&ve,Ee=J?r:jn(e);function ae(){for(var Pe=arguments.length,Ae=$(Pe),gr=Pe;gr--;)Ae[gr]=arguments[gr];if(te)var er=ln(ae),yr=op(Ae,er);if(u&&(Ae=Hu(Ae,u,f,te)),y&&(Ae=ku(Ae,y,w,te)),Pe-=yr,te&&Pe<M){var Et=gi(Ae,er);return Qu(e,i,Ws,ae.placeholder,o,Ae,Et,E,T,M-Pe)}var Nr=B?o:this,ii=J?Nr[e]:e;return Pe=Ae.length,E?Ae=dg(Ae,E):oe&&Pe>1&&Ae.reverse(),z&&T<Pe&&(Ae.length=T),this&&this!==Te&&this instanceof ae&&(ii=Ee||jn(ii)),ii.apply(Nr,Ae)}return ae}function Wu(e,i){return function(o,u){return Ed(o,e,i(u),{})}}function Js(e,i){return function(o,u){var f;if(o===r&&u===r)return i;if(o!==r&&(f=o),u!==r){if(f===r)return u;typeof o=="string"||typeof u=="string"?(o=pr(o),u=pr(u)):(o=Nu(o),u=Nu(u)),f=e(o,u)}return f}}function Ra(e){return Zr(function(i){return i=nt(i,fr(se())),xe(function(o){var u=this;return e(i,function(f){return Mt(f,u,o)})})})}function Qs(e,i){i=i===r?" ":pr(i);var o=i.length;if(o<2)return o?ba(i,e):i;var u=ba(i,js(e/rn(i)));return tn(i)?wi(Ar(u),0,e).join(""):u.slice(0,e)}function Jd(e,i,o,u){var f=i&re,y=jn(e);function w(){for(var E=-1,T=arguments.length,M=-1,z=u.length,B=$(z+T),J=this&&this!==Te&&this instanceof w?y:e;++M<z;)B[M]=u[M];for(;T--;)B[M++]=arguments[++E];return Mt(J,f?o:this,B)}return w}function Ju(e){return function(i,o,u){return u&&typeof u!="number"&&Zt(i,o,u)&&(o=u=r),i=ri(i),o===r?(o=i,i=0):o=ri(o),u=u===r?i<o?1:-1:ri(u),Dd(i,o,u,e)}}function Ys(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Pr(i),o=Pr(o)),e(i,o)}}function Qu(e,i,o,u,f,y,w,E,T,M){var z=i&fe,B=z?w:r,J=z?r:w,te=z?y:r,oe=z?r:y;i|=z?de:j,i&=~(z?j:de),i&le||(i&=~(re|he));var Ee=[e,i,f,te,B,oe,J,E,T,M],ae=o.apply(r,Ee);return ja(e)&&ch(ae,Ee),ae.placeholder=u,uh(ae,e,i)}function Ta(e){var i=Lt[e];return function(o,u){if(o=Pr(o),u=u==null?0:Ft(we(u),292),u&&uu(o)){var f=(qe(o)+"e").split("e"),y=i(f[0]+"e"+(+f[1]+u));return f=(qe(y)+"e").split("e"),+(f[0]+"e"+(+f[1]-u))}return i(o)}}var Qd=on&&1/Ss(new on([,-0]))[1]==ce?function(e){return new on(e)}:Ya;function Yu(e){return function(i){var o=Vt(i);return o==be?sa(i):o==je?pp(i):sp(i,e(i))}}function Xr(e,i,o,u,f,y,w,E){var T=i&he;if(!T&&typeof e!="function")throw new wr(l);var M=u?u.length:0;if(M||(i&=~(de|j),u=f=r),w=w===r?w:jt(we(w),0),E=E===r?E:we(E),M-=f?f.length:0,i&j){var z=u,B=f;u=f=r}var J=T?r:$a(e),te=[e,i,o,u,f,z,B,y,w,E];if(J&&lg(te,J),e=te[0],i=te[1],o=te[2],u=te[3],f=te[4],E=te[9]=te[9]===r?T?0:e.length:jt(te[9]-M,0),!E&&i&(fe|pe)&&(i&=~(fe|pe)),!i||i==re)var oe=Gd(e,i,o);else i==fe||i==pe?oe=Wd(e,i,E):(i==de||i==(re|de))&&!f.length?oe=Jd(e,i,o,u):oe=Ws.apply(r,te);var Ee=J?Cu:ch;return uh(Ee(oe,te),e,i)}function Xu(e,i,o,u){return e===r||$r(e,sn[o])&&!ze.call(u,o)?i:e}function Zu(e,i,o,u,f,y){return ut(e)&&ut(i)&&(y.set(i,e),Ks(e,i,r,Zu,y),y.delete(i)),e}function Yd(e){return zn(e)?r:e}function eh(e,i,o,u,f,y){var w=o&C,E=e.length,T=i.length;if(E!=T&&!(w&&T>E))return!1;var M=y.get(e),z=y.get(i);if(M&&z)return M==i&&z==e;var B=-1,J=!0,te=o&F?new Li:r;for(y.set(e,i),y.set(i,e);++B<E;){var oe=e[B],Ee=i[B];if(u)var ae=w?u(Ee,oe,B,i,e,y):u(oe,Ee,B,e,i,y);if(ae!==r){if(ae)continue;J=!1;break}if(te){if(!Zo(i,function(Pe,Ae){if(!Pn(te,Ae)&&(oe===Pe||f(oe,Pe,o,u,y)))return te.push(Ae)})){J=!1;break}}else if(!(oe===Ee||f(oe,Ee,o,u,y))){J=!1;break}}return y.delete(e),y.delete(i),J}function Xd(e,i,o,u,f,y,w){switch(o){case Ke:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Ne:return!(e.byteLength!=i.byteLength||!y(new $s(e),new $s(i)));case N:case A:case $e:return $r(+e,+i);case I:return e.name==i.name&&e.message==i.message;case ot:case Ye:return e==i+"";case be:var E=sa;case je:var T=u&C;if(E||(E=Ss),e.size!=i.size&&!T)return!1;var M=w.get(e);if(M)return M==i;u|=F,w.set(e,i);var z=eh(E(e),E(i),u,f,y,w);return w.delete(e),z;case Xe:if(An)return An.call(e)==An.call(i)}return!1}function Zd(e,i,o,u,f,y){var w=o&C,E=Aa(e),T=E.length,M=Aa(i),z=M.length;if(T!=z&&!w)return!1;for(var B=T;B--;){var J=E[B];if(!(w?J in i:ze.call(i,J)))return!1}var te=y.get(e),oe=y.get(i);if(te&&oe)return te==i&&oe==e;var Ee=!0;y.set(e,i),y.set(i,e);for(var ae=w;++B<T;){J=E[B];var Pe=e[J],Ae=i[J];if(u)var gr=w?u(Ae,Pe,J,i,e,y):u(Pe,Ae,J,e,i,y);if(!(gr===r?Pe===Ae||f(Pe,Ae,o,u,y):gr)){Ee=!1;break}ae||(ae=J=="constructor")}if(Ee&&!ae){var er=e.constructor,yr=i.constructor;er!=yr&&"constructor"in e&&"constructor"in i&&!(typeof er=="function"&&er instanceof er&&typeof yr=="function"&&yr instanceof yr)&&(Ee=!1)}return y.delete(e),y.delete(i),Ee}function Zr(e){return Ma(oh(e,r,gh),e+"")}function Aa(e){return wu(e,zt,Da)}function Ca(e){return wu(e,or,th)}var $a=Ms?function(e){return Ms.get(e)}:Ya;function Xs(e){for(var i=e.name+"",o=an[i],u=ze.call(an,i)?o.length:0;u--;){var f=o[u],y=f.func;if(y==null||y==e)return f.name}return i}function ln(e){var i=ze.call(g,"placeholder")?g:e;return i.placeholder}function se(){var e=g.iteratee||Ja;return e=e===Ja?Iu:e,arguments.length?e(arguments[0],arguments[1]):e}function Zs(e,i){var o=e.__data__;return ag(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Na(e){for(var i=zt(e),o=i.length;o--;){var u=i[o],f=e[u];i[o]=[u,f,nh(f)]}return i}function Mi(e,i){var o=hp(e,i);return Eu(o)?o:r}function eg(e){var i=ze.call(e,Ni),o=e[Ni];try{e[Ni]=r;var u=!0}catch{}var f=As.call(e);return u&&(i?e[Ni]=o:delete e[Ni]),f}var Da=aa?function(e){return e==null?[]:(e=We(e),pi(aa(e),function(i){return au.call(e,i)}))}:Xa,th=aa?function(e){for(var i=[];e;)di(i,Da(e)),e=Ns(e);return i}:Xa,Vt=Xt;(ca&&Vt(new ca(new ArrayBuffer(1)))!=Ke||On&&Vt(new On)!=be||ua&&Vt(ua.resolve())!=xt||on&&Vt(new on)!=je||Rn&&Vt(new Rn)!=He)&&(Vt=function(e){var i=Xt(e),o=i==Se?e.constructor:r,u=o?zi(o):"";if(u)switch(u){case jp:return Ke;case qp:return be;case Mp:return xt;case zp:return je;case Up:return He}return i});function tg(e,i,o){for(var u=-1,f=o.length;++u<f;){var y=o[u],w=y.size;switch(y.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=Ft(i,e+w);break;case"takeRight":e=jt(e,i-w);break}}return{start:e,end:i}}function rg(e){var i=e.match(Qe);return i?i[1].split(Tt):[]}function rh(e,i,o){i=_i(i,e);for(var u=-1,f=i.length,y=!1;++u<f;){var w=Kr(i[u]);if(!(y=e!=null&&o(e,w)))break;e=e[w]}return y||++u!=f?y:(f=e==null?0:e.length,!!f&&oo(f)&&ei(w,f)&&(_e(e)||Ui(e)))}function ig(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&ze.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function ih(e){return typeof e.constructor=="function"&&!qn(e)?cn(Ns(e)):{}}function ng(e,i,o){var u=e.constructor;switch(i){case Ne:return Oa(e);case N:case A:return new u(+e);case Ke:return Hd(e,o);case ht:case Me:case Pt:case Dt:case Ht:case kt:case qt:case Jt:case rr:return zu(e,o);case be:return new u;case $e:case Ye:return new u(e);case ot:return kd(e);case je:return new u;case Xe:return Bd(e)}}function sg(e,i){var o=i.length;if(!o)return e;var u=o-1;return i[u]=(o>1?"& ":"")+i[u],i=i.join(o>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+i+`] */
`)}function og(e){return _e(e)||Ui(e)||!!(cu&&e&&e[cu])}function ei(e,i){var o=typeof e;return i=i??V,!!i&&(o=="number"||o!="symbol"&&qo.test(e))&&e>-1&&e%1==0&&e<i}function Zt(e,i,o){if(!ut(o))return!1;var u=typeof i;return(u=="number"?sr(o)&&ei(i,o.length):u=="string"&&i in o)?$r(o[i],e):!1}function La(e,i){if(_e(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||dr(e)?!0:St.test(e)||!it.test(e)||i!=null&&e in We(i)}function ag(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function ja(e){var i=Xs(e),o=g[i];if(typeof o!="function"||!(i in Oe.prototype))return!1;if(e===o)return!0;var u=$a(o);return!!u&&e===u[0]}function cg(e){return!!nu&&nu in e}var ug=Rs?ti:Za;function qn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||sn;return e===o}function nh(e){return e===e&&!ut(e)}function sh(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in We(o))}}function hg(e){var i=no(e,function(u){return o.size===p&&o.clear(),u}),o=i.cache;return i}function lg(e,i){var o=e[1],u=i[1],f=o|u,y=f<(re|he|H),w=u==H&&o==fe||u==H&&o==W&&e[7].length<=i[8]||u==(H|W)&&i[7].length<=i[8]&&o==fe;if(!(y||w))return e;u&re&&(e[2]=i[2],f|=o&re?0:le);var E=i[3];if(E){var T=e[3];e[3]=T?Hu(T,E,i[4]):E,e[4]=T?gi(e[3],b):i[4]}return E=i[5],E&&(T=e[5],e[5]=T?ku(T,E,i[6]):E,e[6]=T?gi(e[5],b):i[6]),E=i[7],E&&(e[7]=E),u&H&&(e[8]=e[8]==null?i[8]:Ft(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=f,e}function fg(e){var i=[];if(e!=null)for(var o in We(e))i.push(o);return i}function pg(e){return As.call(e)}function oh(e,i,o){return i=jt(i===r?e.length-1:i,0),function(){for(var u=arguments,f=-1,y=jt(u.length-i,0),w=$(y);++f<y;)w[f]=u[i+f];f=-1;for(var E=$(i+1);++f<i;)E[f]=u[f];return E[i]=o(w),Mt(e,this,E)}}function ah(e,i){return i.length<2?e:qi(e,Ir(i,0,-1))}function dg(e,i){for(var o=e.length,u=Ft(i.length,o),f=nr(e);u--;){var y=i[u];e[u]=ei(y,o)?f[y]:r}return e}function qa(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var ch=hh(Cu),Mn=Tp||function(e,i){return Te.setTimeout(e,i)},Ma=hh(qd);function uh(e,i,o){var u=i+"";return Ma(e,sg(u,gg(rg(u),o)))}function hh(e){var i=0,o=0;return function(){var u=Np(),f=Ue-(u-o);if(o=u,f>0){if(++i>=Ce)return arguments[0]}else i=0;return e.apply(r,arguments)}}function eo(e,i){var o=-1,u=e.length,f=u-1;for(i=i===r?u:i;++o<i;){var y=wa(o,f),w=e[y];e[y]=e[o],e[o]=w}return e.length=i,e}var lh=hg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Ot,function(o,u,f,y){i.push(f?y.replace(Co,"$1"):u||o)}),i});function Kr(e){if(typeof e=="string"||dr(e))return e;var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function zi(e){if(e!=null){try{return Ts.call(e)}catch{}try{return e+""}catch{}}return""}function gg(e,i){return _r(Mr,function(o){var u="_."+o[0];i&o[1]&&!xs(e,u)&&e.push(u)}),e.sort()}function fh(e){if(e instanceof Oe)return e.clone();var i=new br(e.__wrapped__,e.__chain__);return i.__actions__=nr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function yg(e,i,o){(o?Zt(e,i,o):i===r)?i=1:i=jt(we(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var f=0,y=0,w=$(js(u/i));f<u;)w[y++]=Ir(e,f,f+=i);return w}function vg(e){for(var i=-1,o=e==null?0:e.length,u=0,f=[];++i<o;){var y=e[i];y&&(f[u++]=y)}return f}function mg(){var e=arguments.length;if(!e)return[];for(var i=$(e-1),o=arguments[0],u=e;u--;)i[u-1]=arguments[u];return di(_e(o)?nr(o):[o],Bt(i,1))}var _g=xe(function(e,i){return bt(e)?$n(e,Bt(i,1,bt,!0)):[]}),wg=xe(function(e,i){var o=xr(i);return bt(o)&&(o=r),bt(e)?$n(e,Bt(i,1,bt,!0),se(o,2)):[]}),bg=xe(function(e,i){var o=xr(i);return bt(o)&&(o=r),bt(e)?$n(e,Bt(i,1,bt,!0),r,o):[]});function Eg(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:we(i),Ir(e,i<0?0:i,u)):[]}function Ig(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:we(i),i=u-i,Ir(e,0,i<0?0:i)):[]}function xg(e,i){return e&&e.length?Vs(e,se(i,3),!0,!0):[]}function Pg(e,i){return e&&e.length?Vs(e,se(i,3),!0):[]}function Sg(e,i,o,u){var f=e==null?0:e.length;return f?(o&&typeof o!="number"&&Zt(e,i,o)&&(o=0,u=f),md(e,i,o,u)):[]}function ph(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=o==null?0:we(o);return f<0&&(f=jt(u+f,0)),Ps(e,se(i,3),f)}function dh(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=u-1;return o!==r&&(f=we(o),f=o<0?jt(u+f,0):Ft(f,u-1)),Ps(e,se(i,3),f,!0)}function gh(e){var i=e==null?0:e.length;return i?Bt(e,1):[]}function Og(e){var i=e==null?0:e.length;return i?Bt(e,ce):[]}function Rg(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:we(i),Bt(e,i)):[]}function Tg(e){for(var i=-1,o=e==null?0:e.length,u={};++i<o;){var f=e[i];u[f[0]]=f[1]}return u}function yh(e){return e&&e.length?e[0]:r}function Ag(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=o==null?0:we(o);return f<0&&(f=jt(u+f,0)),en(e,i,f)}function Cg(e){var i=e==null?0:e.length;return i?Ir(e,0,-1):[]}var $g=xe(function(e){var i=nt(e,Pa);return i.length&&i[0]===e[0]?ga(i):[]}),Ng=xe(function(e){var i=xr(e),o=nt(e,Pa);return i===xr(o)?i=r:o.pop(),o.length&&o[0]===e[0]?ga(o,se(i,2)):[]}),Dg=xe(function(e){var i=xr(e),o=nt(e,Pa);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?ga(o,r,i):[]});function Lg(e,i){return e==null?"":Cp.call(e,i)}function xr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function jg(e,i,o){var u=e==null?0:e.length;if(!u)return-1;var f=u;return o!==r&&(f=we(o),f=f<0?jt(u+f,0):Ft(f,u-1)),i===i?gp(e,i,f):Ps(e,Qc,f,!0)}function qg(e,i){return e&&e.length?Ou(e,we(i)):r}var Mg=xe(vh);function vh(e,i){return e&&e.length&&i&&i.length?_a(e,i):e}function zg(e,i,o){return e&&e.length&&i&&i.length?_a(e,i,se(o,2)):e}function Ug(e,i,o){return e&&e.length&&i&&i.length?_a(e,i,r,o):e}var Hg=Zr(function(e,i){var o=e==null?0:e.length,u=la(e,i);return Au(e,nt(i,function(f){return ei(f,o)?+f:f}).sort(Uu)),u});function kg(e,i){var o=[];if(!(e&&e.length))return o;var u=-1,f=[],y=e.length;for(i=se(i,3);++u<y;){var w=e[u];i(w,u,e)&&(o.push(w),f.push(u))}return Au(e,f),o}function za(e){return e==null?e:Lp.call(e)}function Bg(e,i,o){var u=e==null?0:e.length;return u?(o&&typeof o!="number"&&Zt(e,i,o)?(i=0,o=u):(i=i==null?0:we(i),o=o===r?u:we(o)),Ir(e,i,o)):[]}function Kg(e,i){return Fs(e,i)}function Fg(e,i,o){return Ea(e,i,se(o,2))}function Vg(e,i){var o=e==null?0:e.length;if(o){var u=Fs(e,i);if(u<o&&$r(e[u],i))return u}return-1}function Gg(e,i){return Fs(e,i,!0)}function Wg(e,i,o){return Ea(e,i,se(o,2),!0)}function Jg(e,i){var o=e==null?0:e.length;if(o){var u=Fs(e,i,!0)-1;if($r(e[u],i))return u}return-1}function Qg(e){return e&&e.length?$u(e):[]}function Yg(e,i){return e&&e.length?$u(e,se(i,2)):[]}function Xg(e){var i=e==null?0:e.length;return i?Ir(e,1,i):[]}function Zg(e,i,o){return e&&e.length?(i=o||i===r?1:we(i),Ir(e,0,i<0?0:i)):[]}function ey(e,i,o){var u=e==null?0:e.length;return u?(i=o||i===r?1:we(i),i=u-i,Ir(e,i<0?0:i,u)):[]}function ty(e,i){return e&&e.length?Vs(e,se(i,3),!1,!0):[]}function ry(e,i){return e&&e.length?Vs(e,se(i,3)):[]}var iy=xe(function(e){return mi(Bt(e,1,bt,!0))}),ny=xe(function(e){var i=xr(e);return bt(i)&&(i=r),mi(Bt(e,1,bt,!0),se(i,2))}),sy=xe(function(e){var i=xr(e);return i=typeof i=="function"?i:r,mi(Bt(e,1,bt,!0),r,i)});function oy(e){return e&&e.length?mi(e):[]}function ay(e,i){return e&&e.length?mi(e,se(i,2)):[]}function cy(e,i){return i=typeof i=="function"?i:r,e&&e.length?mi(e,r,i):[]}function Ua(e){if(!(e&&e.length))return[];var i=0;return e=pi(e,function(o){if(bt(o))return i=jt(o.length,i),!0}),ia(i,function(o){return nt(e,ea(o))})}function mh(e,i){if(!(e&&e.length))return[];var o=Ua(e);return i==null?o:nt(o,function(u){return Mt(i,r,u)})}var uy=xe(function(e,i){return bt(e)?$n(e,i):[]}),hy=xe(function(e){return xa(pi(e,bt))}),ly=xe(function(e){var i=xr(e);return bt(i)&&(i=r),xa(pi(e,bt),se(i,2))}),fy=xe(function(e){var i=xr(e);return i=typeof i=="function"?i:r,xa(pi(e,bt),r,i)}),py=xe(Ua);function dy(e,i){return ju(e||[],i||[],Cn)}function gy(e,i){return ju(e||[],i||[],Ln)}var yy=xe(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,mh(e,o)});function _h(e){var i=g(e);return i.__chain__=!0,i}function vy(e,i){return i(e),e}function to(e,i){return i(e)}var my=Zr(function(e){var i=e.length,o=i?e[0]:0,u=this.__wrapped__,f=function(y){return la(y,e)};return i>1||this.__actions__.length||!(u instanceof Oe)||!ei(o)?this.thru(f):(u=u.slice(o,+o+(i?1:0)),u.__actions__.push({func:to,args:[f],thisArg:r}),new br(u,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function _y(){return _h(this)}function wy(){return new br(this.value(),this.__chain__)}function by(){this.__values__===r&&(this.__values__=Nh(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function Ey(){return this}function Iy(e){for(var i,o=this;o instanceof Us;){var u=fh(o);u.__index__=0,u.__values__=r,i?f.__wrapped__=u:i=u;var f=u;o=o.__wrapped__}return f.__wrapped__=e,i}function xy(){var e=this.__wrapped__;if(e instanceof Oe){var i=e;return this.__actions__.length&&(i=new Oe(this)),i=i.reverse(),i.__actions__.push({func:to,args:[za],thisArg:r}),new br(i,this.__chain__)}return this.thru(za)}function Py(){return Lu(this.__wrapped__,this.__actions__)}var Sy=Gs(function(e,i,o){ze.call(e,o)?++e[o]:Yr(e,o,1)});function Oy(e,i,o){var u=_e(e)?Wc:vd;return o&&Zt(e,i,o)&&(i=r),u(e,se(i,3))}function Ry(e,i){var o=_e(e)?pi:mu;return o(e,se(i,3))}var Ty=Vu(ph),Ay=Vu(dh);function Cy(e,i){return Bt(ro(e,i),1)}function $y(e,i){return Bt(ro(e,i),ce)}function Ny(e,i,o){return o=o===r?1:we(o),Bt(ro(e,i),o)}function wh(e,i){var o=_e(e)?_r:vi;return o(e,se(i,3))}function bh(e,i){var o=_e(e)?Xf:vu;return o(e,se(i,3))}var Dy=Gs(function(e,i,o){ze.call(e,o)?e[o].push(i):Yr(e,o,[i])});function Ly(e,i,o,u){e=sr(e)?e:pn(e),o=o&&!u?we(o):0;var f=e.length;return o<0&&(o=jt(f+o,0)),ao(e)?o<=f&&e.indexOf(i,o)>-1:!!f&&en(e,i,o)>-1}var jy=xe(function(e,i,o){var u=-1,f=typeof i=="function",y=sr(e)?$(e.length):[];return vi(e,function(w){y[++u]=f?Mt(i,w,o):Nn(w,i,o)}),y}),qy=Gs(function(e,i,o){Yr(e,o,i)});function ro(e,i){var o=_e(e)?nt:xu;return o(e,se(i,3))}function My(e,i,o,u){return e==null?[]:(_e(i)||(i=i==null?[]:[i]),o=u?r:o,_e(o)||(o=o==null?[]:[o]),Ru(e,i,o))}var zy=Gs(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function Uy(e,i,o){var u=_e(e)?Xo:Xc,f=arguments.length<3;return u(e,se(i,4),o,f,vi)}function Hy(e,i,o){var u=_e(e)?Zf:Xc,f=arguments.length<3;return u(e,se(i,4),o,f,vu)}function ky(e,i){var o=_e(e)?pi:mu;return o(e,so(se(i,3)))}function By(e){var i=_e(e)?pu:Ld;return i(e)}function Ky(e,i,o){(o?Zt(e,i,o):i===r)?i=1:i=we(i);var u=_e(e)?fd:jd;return u(e,i)}function Fy(e){var i=_e(e)?pd:Md;return i(e)}function Vy(e){if(e==null)return 0;if(sr(e))return ao(e)?rn(e):e.length;var i=Vt(e);return i==be||i==je?e.size:va(e).length}function Gy(e,i,o){var u=_e(e)?Zo:zd;return o&&Zt(e,i,o)&&(i=r),u(e,se(i,3))}var Wy=xe(function(e,i){if(e==null)return[];var o=i.length;return o>1&&Zt(e,i[0],i[1])?i=[]:o>2&&Zt(i[0],i[1],i[2])&&(i=[i[0]]),Ru(e,Bt(i,1),[])}),io=Rp||function(){return Te.Date.now()};function Jy(e,i){if(typeof i!="function")throw new wr(l);return e=we(e),function(){if(--e<1)return i.apply(this,arguments)}}function Eh(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,Xr(e,H,r,r,r,r,i)}function Ih(e,i){var o;if(typeof i!="function")throw new wr(l);return e=we(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var Ha=xe(function(e,i,o){var u=re;if(o.length){var f=gi(o,ln(Ha));u|=de}return Xr(e,u,i,o,f)}),xh=xe(function(e,i,o){var u=re|he;if(o.length){var f=gi(o,ln(xh));u|=de}return Xr(i,u,e,o,f)});function Ph(e,i,o){i=o?r:i;var u=Xr(e,fe,r,r,r,r,r,i);return u.placeholder=Ph.placeholder,u}function Sh(e,i,o){i=o?r:i;var u=Xr(e,pe,r,r,r,r,r,i);return u.placeholder=Sh.placeholder,u}function Oh(e,i,o){var u,f,y,w,E,T,M=0,z=!1,B=!1,J=!0;if(typeof e!="function")throw new wr(l);i=Pr(i)||0,ut(o)&&(z=!!o.leading,B="maxWait"in o,y=B?jt(Pr(o.maxWait)||0,i):y,J="trailing"in o?!!o.trailing:J);function te(Et){var Nr=u,ii=f;return u=f=r,M=Et,w=e.apply(ii,Nr),w}function oe(Et){return M=Et,E=Mn(Pe,i),z?te(Et):w}function Ee(Et){var Nr=Et-T,ii=Et-M,Vh=i-Nr;return B?Ft(Vh,y-ii):Vh}function ae(Et){var Nr=Et-T,ii=Et-M;return T===r||Nr>=i||Nr<0||B&&ii>=y}function Pe(){var Et=io();if(ae(Et))return Ae(Et);E=Mn(Pe,Ee(Et))}function Ae(Et){return E=r,J&&u?te(Et):(u=f=r,w)}function gr(){E!==r&&qu(E),M=0,u=T=f=E=r}function er(){return E===r?w:Ae(io())}function yr(){var Et=io(),Nr=ae(Et);if(u=arguments,f=this,T=Et,Nr){if(E===r)return oe(T);if(B)return qu(E),E=Mn(Pe,i),te(T)}return E===r&&(E=Mn(Pe,i)),w}return yr.cancel=gr,yr.flush=er,yr}var Qy=xe(function(e,i){return yu(e,1,i)}),Yy=xe(function(e,i,o){return yu(e,Pr(i)||0,o)});function Xy(e){return Xr(e,ve)}function no(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new wr(l);var o=function(){var u=arguments,f=i?i.apply(this,u):u[0],y=o.cache;if(y.has(f))return y.get(f);var w=e.apply(this,u);return o.cache=y.set(f,w)||y,w};return o.cache=new(no.Cache||Qr),o}no.Cache=Qr;function so(e){if(typeof e!="function")throw new wr(l);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Zy(e){return Ih(2,e)}var ev=Ud(function(e,i){i=i.length==1&&_e(i[0])?nt(i[0],fr(se())):nt(Bt(i,1),fr(se()));var o=i.length;return xe(function(u){for(var f=-1,y=Ft(u.length,o);++f<y;)u[f]=i[f].call(this,u[f]);return Mt(e,this,u)})}),ka=xe(function(e,i){var o=gi(i,ln(ka));return Xr(e,de,r,i,o)}),Rh=xe(function(e,i){var o=gi(i,ln(Rh));return Xr(e,j,r,i,o)}),tv=Zr(function(e,i){return Xr(e,W,r,r,r,i)});function rv(e,i){if(typeof e!="function")throw new wr(l);return i=i===r?i:we(i),xe(e,i)}function iv(e,i){if(typeof e!="function")throw new wr(l);return i=i==null?0:jt(we(i),0),xe(function(o){var u=o[i],f=wi(o,0,i);return u&&di(f,u),Mt(e,this,f)})}function nv(e,i,o){var u=!0,f=!0;if(typeof e!="function")throw new wr(l);return ut(o)&&(u="leading"in o?!!o.leading:u,f="trailing"in o?!!o.trailing:f),Oh(e,i,{leading:u,maxWait:i,trailing:f})}function sv(e){return Eh(e,1)}function ov(e,i){return ka(Sa(i),e)}function av(){if(!arguments.length)return[];var e=arguments[0];return _e(e)?e:[e]}function cv(e){return Er(e,D)}function uv(e,i){return i=typeof i=="function"?i:r,Er(e,D,i)}function hv(e){return Er(e,S|D)}function lv(e,i){return i=typeof i=="function"?i:r,Er(e,S|D,i)}function fv(e,i){return i==null||gu(e,i,zt(i))}function $r(e,i){return e===i||e!==e&&i!==i}var pv=Ys(da),dv=Ys(function(e,i){return e>=i}),Ui=bu(function(){return arguments}())?bu:function(e){return vt(e)&&ze.call(e,"callee")&&!au.call(e,"callee")},_e=$.isArray,gv=Yt?fr(Yt):Id;function sr(e){return e!=null&&oo(e.length)&&!ti(e)}function bt(e){return vt(e)&&sr(e)}function yv(e){return e===!0||e===!1||vt(e)&&Xt(e)==N}var bi=Ap||Za,vv=Tr?fr(Tr):xd;function mv(e){return vt(e)&&e.nodeType===1&&!zn(e)}function _v(e){if(e==null)return!0;if(sr(e)&&(_e(e)||typeof e=="string"||typeof e.splice=="function"||bi(e)||fn(e)||Ui(e)))return!e.length;var i=Vt(e);if(i==be||i==je)return!e.size;if(qn(e))return!va(e).length;for(var o in e)if(ze.call(e,o))return!1;return!0}function wv(e,i){return Dn(e,i)}function bv(e,i,o){o=typeof o=="function"?o:r;var u=o?o(e,i):r;return u===r?Dn(e,i,r,o):!!u}function Ba(e){if(!vt(e))return!1;var i=Xt(e);return i==I||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!zn(e)}function Ev(e){return typeof e=="number"&&uu(e)}function ti(e){if(!ut(e))return!1;var i=Xt(e);return i==ee||i==ge||i==L||i==mt}function Th(e){return typeof e=="number"&&e==we(e)}function oo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=V}function ut(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function vt(e){return e!=null&&typeof e=="object"}var Ah=mr?fr(mr):Sd;function Iv(e,i){return e===i||ya(e,i,Na(i))}function xv(e,i,o){return o=typeof o=="function"?o:r,ya(e,i,Na(i),o)}function Pv(e){return Ch(e)&&e!=+e}function Sv(e){if(ug(e))throw new ye(c);return Eu(e)}function Ov(e){return e===null}function Rv(e){return e==null}function Ch(e){return typeof e=="number"||vt(e)&&Xt(e)==$e}function zn(e){if(!vt(e)||Xt(e)!=Se)return!1;var i=Ns(e);if(i===null)return!0;var o=ze.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Ts.call(o)==xp}var Ka=Hr?fr(Hr):Od;function Tv(e){return Th(e)&&e>=-V&&e<=V}var $h=xn?fr(xn):Rd;function ao(e){return typeof e=="string"||!_e(e)&&vt(e)&&Xt(e)==Ye}function dr(e){return typeof e=="symbol"||vt(e)&&Xt(e)==Xe}var fn=$i?fr($i):Td;function Av(e){return e===r}function Cv(e){return vt(e)&&Vt(e)==He}function $v(e){return vt(e)&&Xt(e)==Ze}var Nv=Ys(ma),Dv=Ys(function(e,i){return e<=i});function Nh(e){if(!e)return[];if(sr(e))return ao(e)?Ar(e):nr(e);if(Sn&&e[Sn])return fp(e[Sn]());var i=Vt(e),o=i==be?sa:i==je?Ss:pn;return o(e)}function ri(e){if(!e)return e===0?e:0;if(e=Pr(e),e===ce||e===-ce){var i=e<0?-1:1;return i*k}return e===e?e:0}function we(e){var i=ri(e),o=i%1;return i===i?o?i-o:i:0}function Dh(e){return e?ji(we(e),0,G):0}function Pr(e){if(typeof e=="number")return e;if(dr(e))return K;if(ut(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ut(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Zc(e);var o=Do.test(e);return o||jo.test(e)?me(e.slice(2),o?2:8):No.test(e)?K:+e}function Lh(e){return Br(e,or(e))}function Lv(e){return e?ji(we(e),-V,V):e===0?e:0}function qe(e){return e==null?"":pr(e)}var jv=un(function(e,i){if(qn(i)||sr(i)){Br(i,zt(i),e);return}for(var o in i)ze.call(i,o)&&Cn(e,o,i[o])}),jh=un(function(e,i){Br(i,or(i),e)}),co=un(function(e,i,o,u){Br(i,or(i),e,u)}),qv=un(function(e,i,o,u){Br(i,zt(i),e,u)}),Mv=Zr(la);function zv(e,i){var o=cn(e);return i==null?o:du(o,i)}var Uv=xe(function(e,i){e=We(e);var o=-1,u=i.length,f=u>2?i[2]:r;for(f&&Zt(i[0],i[1],f)&&(u=1);++o<u;)for(var y=i[o],w=or(y),E=-1,T=w.length;++E<T;){var M=w[E],z=e[M];(z===r||$r(z,sn[M])&&!ze.call(e,M))&&(e[M]=y[M])}return e}),Hv=xe(function(e){return e.push(r,Zu),Mt(qh,r,e)});function kv(e,i){return Jc(e,se(i,3),kr)}function Bv(e,i){return Jc(e,se(i,3),pa)}function Kv(e,i){return e==null?e:fa(e,se(i,3),or)}function Fv(e,i){return e==null?e:_u(e,se(i,3),or)}function Vv(e,i){return e&&kr(e,se(i,3))}function Gv(e,i){return e&&pa(e,se(i,3))}function Wv(e){return e==null?[]:Bs(e,zt(e))}function Jv(e){return e==null?[]:Bs(e,or(e))}function Fa(e,i,o){var u=e==null?r:qi(e,i);return u===r?o:u}function Qv(e,i){return e!=null&&rh(e,i,_d)}function Va(e,i){return e!=null&&rh(e,i,wd)}var Yv=Wu(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=As.call(i)),e[i]=o},Wa(ar)),Xv=Wu(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=As.call(i)),ze.call(e,i)?e[i].push(o):e[i]=[o]},se),Zv=xe(Nn);function zt(e){return sr(e)?fu(e):va(e)}function or(e){return sr(e)?fu(e,!0):Ad(e)}function em(e,i){var o={};return i=se(i,3),kr(e,function(u,f,y){Yr(o,i(u,f,y),u)}),o}function tm(e,i){var o={};return i=se(i,3),kr(e,function(u,f,y){Yr(o,f,i(u,f,y))}),o}var rm=un(function(e,i,o){Ks(e,i,o)}),qh=un(function(e,i,o,u){Ks(e,i,o,u)}),im=Zr(function(e,i){var o={};if(e==null)return o;var u=!1;i=nt(i,function(y){return y=_i(y,e),u||(u=y.length>1),y}),Br(e,Ca(e),o),u&&(o=Er(o,S|x|D,Yd));for(var f=i.length;f--;)Ia(o,i[f]);return o});function nm(e,i){return Mh(e,so(se(i)))}var sm=Zr(function(e,i){return e==null?{}:$d(e,i)});function Mh(e,i){if(e==null)return{};var o=nt(Ca(e),function(u){return[u]});return i=se(i),Tu(e,o,function(u,f){return i(u,f[0])})}function om(e,i,o){i=_i(i,e);var u=-1,f=i.length;for(f||(f=1,e=r);++u<f;){var y=e==null?r:e[Kr(i[u])];y===r&&(u=f,y=o),e=ti(y)?y.call(e):y}return e}function am(e,i,o){return e==null?e:Ln(e,i,o)}function cm(e,i,o,u){return u=typeof u=="function"?u:r,e==null?e:Ln(e,i,o,u)}var zh=Yu(zt),Uh=Yu(or);function um(e,i,o){var u=_e(e),f=u||bi(e)||fn(e);if(i=se(i,4),o==null){var y=e&&e.constructor;f?o=u?new y:[]:ut(e)?o=ti(y)?cn(Ns(e)):{}:o={}}return(f?_r:kr)(e,function(w,E,T){return i(o,w,E,T)}),o}function hm(e,i){return e==null?!0:Ia(e,i)}function lm(e,i,o){return e==null?e:Du(e,i,Sa(o))}function fm(e,i,o,u){return u=typeof u=="function"?u:r,e==null?e:Du(e,i,Sa(o),u)}function pn(e){return e==null?[]:na(e,zt(e))}function pm(e){return e==null?[]:na(e,or(e))}function dm(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Pr(o),o=o===o?o:0),i!==r&&(i=Pr(i),i=i===i?i:0),ji(Pr(e),i,o)}function gm(e,i,o){return i=ri(i),o===r?(o=i,i=0):o=ri(o),e=Pr(e),bd(e,i,o)}function ym(e,i,o){if(o&&typeof o!="boolean"&&Zt(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ri(e),i===r?(i=e,e=0):i=ri(i)),e>i){var u=e;e=i,i=u}if(o||e%1||i%1){var f=hu();return Ft(e+f*(i-e+Ve("1e-"+((f+"").length-1))),i)}return wa(e,i)}var vm=hn(function(e,i,o){return i=i.toLowerCase(),e+(o?Hh(i):i)});function Hh(e){return Ga(qe(e).toLowerCase())}function kh(e){return e=qe(e),e&&e.replace(Gr,ap).replace(Jo,"")}function mm(e,i,o){e=qe(e),i=pr(i);var u=e.length;o=o===r?u:ji(we(o),0,u);var f=o;return o-=i.length,o>=0&&e.slice(o,f)==i}function _m(e){return e=qe(e),e&&rt.test(e)?e.replace(Oi,cp):e}function wm(e){return e=qe(e),e&&Rt.test(e)?e.replace(dt,"\\$&"):e}var bm=hn(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),Em=hn(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),Im=Fu("toLowerCase");function xm(e,i,o){e=qe(e),i=we(i);var u=i?rn(e):0;if(!i||u>=i)return e;var f=(i-u)/2;return Qs(qs(f),o)+e+Qs(js(f),o)}function Pm(e,i,o){e=qe(e),i=we(i);var u=i?rn(e):0;return i&&u<i?e+Qs(i-u,o):e}function Sm(e,i,o){e=qe(e),i=we(i);var u=i?rn(e):0;return i&&u<i?Qs(i-u,o)+e:e}function Om(e,i,o){return o||i==null?i=0:i&&(i=+i),Dp(qe(e).replace(gt,""),i||0)}function Rm(e,i,o){return(o?Zt(e,i,o):i===r)?i=1:i=we(i),ba(qe(e),i)}function Tm(){var e=arguments,i=qe(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Am=hn(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function Cm(e,i,o){return o&&typeof o!="number"&&Zt(e,i,o)&&(i=o=r),o=o===r?G:o>>>0,o?(e=qe(e),e&&(typeof i=="string"||i!=null&&!Ka(i))&&(i=pr(i),!i&&tn(e))?wi(Ar(e),0,o):e.split(i,o)):[]}var $m=hn(function(e,i,o){return e+(o?" ":"")+Ga(i)});function Nm(e,i,o){return e=qe(e),o=o==null?0:ji(we(o),0,e.length),i=pr(i),e.slice(o,o+i.length)==i}function Dm(e,i,o){var u=g.templateSettings;o&&Zt(e,i,o)&&(i=r),e=qe(e),i=co({},i,u,Xu);var f=co({},i.imports,u.imports,Xu),y=zt(f),w=na(f,y),E,T,M=0,z=i.interpolate||Gi,B="__p += '",J=oa((i.escape||Gi).source+"|"+z.source+"|"+(z===ct?$o:Gi).source+"|"+(i.evaluate||Gi).source+"|$","g"),te="//# sourceURL="+(ze.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Qo+"]")+`
`;e.replace(J,function(ae,Pe,Ae,gr,er,yr){return Ae||(Ae=gr),B+=e.slice(M,yr).replace(Mo,up),Pe&&(E=!0,B+=`' +
__e(`+Pe+`) +
'`),er&&(T=!0,B+=`';
`+er+`;
__p += '`),Ae&&(B+=`' +
((__t = (`+Ae+`)) == null ? '' : __t) +
'`),M=yr+ae.length,ae}),B+=`';
`;var oe=ze.call(i,"variable")&&i.variable;if(!oe)B=`with (obj) {
`+B+`
}
`;else if(Ao.test(oe))throw new ye(d);B=(T?B.replace(zr,""):B).replace(Qt,"$1").replace(Vr,"$1;"),B="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(E?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+B+`return __p
}`;var Ee=Kh(function(){return Le(y,te+"return "+B).apply(r,w)});if(Ee.source=B,Ba(Ee))throw Ee;return Ee}function Lm(e){return qe(e).toLowerCase()}function jm(e){return qe(e).toUpperCase()}function qm(e,i,o){if(e=qe(e),e&&(o||i===r))return Zc(e);if(!e||!(i=pr(i)))return e;var u=Ar(e),f=Ar(i),y=eu(u,f),w=tu(u,f)+1;return wi(u,y,w).join("")}function Mm(e,i,o){if(e=qe(e),e&&(o||i===r))return e.slice(0,iu(e)+1);if(!e||!(i=pr(i)))return e;var u=Ar(e),f=tu(u,Ar(i))+1;return wi(u,0,f).join("")}function zm(e,i,o){if(e=qe(e),e&&(o||i===r))return e.replace(gt,"");if(!e||!(i=pr(i)))return e;var u=Ar(e),f=eu(u,Ar(i));return wi(u,f).join("")}function Um(e,i){var o=ie,u=ue;if(ut(i)){var f="separator"in i?i.separator:f;o="length"in i?we(i.length):o,u="omission"in i?pr(i.omission):u}e=qe(e);var y=e.length;if(tn(e)){var w=Ar(e);y=w.length}if(o>=y)return e;var E=o-rn(u);if(E<1)return u;var T=w?wi(w,0,E).join(""):e.slice(0,E);if(f===r)return T+u;if(w&&(E+=T.length-E),Ka(f)){if(e.slice(E).search(f)){var M,z=T;for(f.global||(f=oa(f.source,qe(vr.exec(f))+"g")),f.lastIndex=0;M=f.exec(z);)var B=M.index;T=T.slice(0,B===r?E:B)}}else if(e.indexOf(pr(f),E)!=E){var J=T.lastIndexOf(f);J>-1&&(T=T.slice(0,J))}return T+u}function Hm(e){return e=qe(e),e&&lt.test(e)?e.replace(li,yp):e}var km=hn(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),Ga=Fu("toUpperCase");function Bh(e,i,o){return e=qe(e),i=o?r:i,i===r?lp(e)?_p(e):rp(e):e.match(i)||[]}var Kh=xe(function(e,i){try{return Mt(e,r,i)}catch(o){return Ba(o)?o:new ye(o)}}),Bm=Zr(function(e,i){return _r(i,function(o){o=Kr(o),Yr(e,o,Ha(e[o],e))}),e});function Km(e){var i=e==null?0:e.length,o=se();return e=i?nt(e,function(u){if(typeof u[1]!="function")throw new wr(l);return[o(u[0]),u[1]]}):[],xe(function(u){for(var f=-1;++f<i;){var y=e[f];if(Mt(y[0],this,u))return Mt(y[1],this,u)}})}function Fm(e){return yd(Er(e,S))}function Wa(e){return function(){return e}}function Vm(e,i){return e==null||e!==e?i:e}var Gm=Gu(),Wm=Gu(!0);function ar(e){return e}function Ja(e){return Iu(typeof e=="function"?e:Er(e,S))}function Jm(e){return Pu(Er(e,S))}function Qm(e,i){return Su(e,Er(i,S))}var Ym=xe(function(e,i){return function(o){return Nn(o,e,i)}}),Xm=xe(function(e,i){return function(o){return Nn(e,o,i)}});function Qa(e,i,o){var u=zt(i),f=Bs(i,u);o==null&&!(ut(i)&&(f.length||!u.length))&&(o=i,i=e,e=this,f=Bs(i,zt(i)));var y=!(ut(o)&&"chain"in o)||!!o.chain,w=ti(e);return _r(f,function(E){var T=i[E];e[E]=T,w&&(e.prototype[E]=function(){var M=this.__chain__;if(y||M){var z=e(this.__wrapped__),B=z.__actions__=nr(this.__actions__);return B.push({func:T,args:arguments,thisArg:e}),z.__chain__=M,z}return T.apply(e,di([this.value()],arguments))})}),e}function Zm(){return Te._===this&&(Te._=Pp),this}function Ya(){}function e0(e){return e=we(e),xe(function(i){return Ou(i,e)})}var t0=Ra(nt),r0=Ra(Wc),i0=Ra(Zo);function Fh(e){return La(e)?ea(Kr(e)):Nd(e)}function n0(e){return function(i){return e==null?r:qi(e,i)}}var s0=Ju(),o0=Ju(!0);function Xa(){return[]}function Za(){return!1}function a0(){return{}}function c0(){return""}function u0(){return!0}function h0(e,i){if(e=we(e),e<1||e>V)return[];var o=G,u=Ft(e,G);i=se(i),e-=G;for(var f=ia(u,i);++o<e;)i(o);return f}function l0(e){return _e(e)?nt(e,Kr):dr(e)?[e]:nr(lh(qe(e)))}function f0(e){var i=++Ip;return qe(e)+i}var p0=Js(function(e,i){return e+i},0),d0=Ta("ceil"),g0=Js(function(e,i){return e/i},1),y0=Ta("floor");function v0(e){return e&&e.length?ks(e,ar,da):r}function m0(e,i){return e&&e.length?ks(e,se(i,2),da):r}function _0(e){return Yc(e,ar)}function w0(e,i){return Yc(e,se(i,2))}function b0(e){return e&&e.length?ks(e,ar,ma):r}function E0(e,i){return e&&e.length?ks(e,se(i,2),ma):r}var I0=Js(function(e,i){return e*i},1),x0=Ta("round"),P0=Js(function(e,i){return e-i},0);function S0(e){return e&&e.length?ra(e,ar):0}function O0(e,i){return e&&e.length?ra(e,se(i,2)):0}return g.after=Jy,g.ary=Eh,g.assign=jv,g.assignIn=jh,g.assignInWith=co,g.assignWith=qv,g.at=Mv,g.before=Ih,g.bind=Ha,g.bindAll=Bm,g.bindKey=xh,g.castArray=av,g.chain=_h,g.chunk=yg,g.compact=vg,g.concat=mg,g.cond=Km,g.conforms=Fm,g.constant=Wa,g.countBy=Sy,g.create=zv,g.curry=Ph,g.curryRight=Sh,g.debounce=Oh,g.defaults=Uv,g.defaultsDeep=Hv,g.defer=Qy,g.delay=Yy,g.difference=_g,g.differenceBy=wg,g.differenceWith=bg,g.drop=Eg,g.dropRight=Ig,g.dropRightWhile=xg,g.dropWhile=Pg,g.fill=Sg,g.filter=Ry,g.flatMap=Cy,g.flatMapDeep=$y,g.flatMapDepth=Ny,g.flatten=gh,g.flattenDeep=Og,g.flattenDepth=Rg,g.flip=Xy,g.flow=Gm,g.flowRight=Wm,g.fromPairs=Tg,g.functions=Wv,g.functionsIn=Jv,g.groupBy=Dy,g.initial=Cg,g.intersection=$g,g.intersectionBy=Ng,g.intersectionWith=Dg,g.invert=Yv,g.invertBy=Xv,g.invokeMap=jy,g.iteratee=Ja,g.keyBy=qy,g.keys=zt,g.keysIn=or,g.map=ro,g.mapKeys=em,g.mapValues=tm,g.matches=Jm,g.matchesProperty=Qm,g.memoize=no,g.merge=rm,g.mergeWith=qh,g.method=Ym,g.methodOf=Xm,g.mixin=Qa,g.negate=so,g.nthArg=e0,g.omit=im,g.omitBy=nm,g.once=Zy,g.orderBy=My,g.over=t0,g.overArgs=ev,g.overEvery=r0,g.overSome=i0,g.partial=ka,g.partialRight=Rh,g.partition=zy,g.pick=sm,g.pickBy=Mh,g.property=Fh,g.propertyOf=n0,g.pull=Mg,g.pullAll=vh,g.pullAllBy=zg,g.pullAllWith=Ug,g.pullAt=Hg,g.range=s0,g.rangeRight=o0,g.rearg=tv,g.reject=ky,g.remove=kg,g.rest=rv,g.reverse=za,g.sampleSize=Ky,g.set=am,g.setWith=cm,g.shuffle=Fy,g.slice=Bg,g.sortBy=Wy,g.sortedUniq=Qg,g.sortedUniqBy=Yg,g.split=Cm,g.spread=iv,g.tail=Xg,g.take=Zg,g.takeRight=ey,g.takeRightWhile=ty,g.takeWhile=ry,g.tap=vy,g.throttle=nv,g.thru=to,g.toArray=Nh,g.toPairs=zh,g.toPairsIn=Uh,g.toPath=l0,g.toPlainObject=Lh,g.transform=um,g.unary=sv,g.union=iy,g.unionBy=ny,g.unionWith=sy,g.uniq=oy,g.uniqBy=ay,g.uniqWith=cy,g.unset=hm,g.unzip=Ua,g.unzipWith=mh,g.update=lm,g.updateWith=fm,g.values=pn,g.valuesIn=pm,g.without=uy,g.words=Bh,g.wrap=ov,g.xor=hy,g.xorBy=ly,g.xorWith=fy,g.zip=py,g.zipObject=dy,g.zipObjectDeep=gy,g.zipWith=yy,g.entries=zh,g.entriesIn=Uh,g.extend=jh,g.extendWith=co,Qa(g,g),g.add=p0,g.attempt=Kh,g.camelCase=vm,g.capitalize=Hh,g.ceil=d0,g.clamp=dm,g.clone=cv,g.cloneDeep=hv,g.cloneDeepWith=lv,g.cloneWith=uv,g.conformsTo=fv,g.deburr=kh,g.defaultTo=Vm,g.divide=g0,g.endsWith=mm,g.eq=$r,g.escape=_m,g.escapeRegExp=wm,g.every=Oy,g.find=Ty,g.findIndex=ph,g.findKey=kv,g.findLast=Ay,g.findLastIndex=dh,g.findLastKey=Bv,g.floor=y0,g.forEach=wh,g.forEachRight=bh,g.forIn=Kv,g.forInRight=Fv,g.forOwn=Vv,g.forOwnRight=Gv,g.get=Fa,g.gt=pv,g.gte=dv,g.has=Qv,g.hasIn=Va,g.head=yh,g.identity=ar,g.includes=Ly,g.indexOf=Ag,g.inRange=gm,g.invoke=Zv,g.isArguments=Ui,g.isArray=_e,g.isArrayBuffer=gv,g.isArrayLike=sr,g.isArrayLikeObject=bt,g.isBoolean=yv,g.isBuffer=bi,g.isDate=vv,g.isElement=mv,g.isEmpty=_v,g.isEqual=wv,g.isEqualWith=bv,g.isError=Ba,g.isFinite=Ev,g.isFunction=ti,g.isInteger=Th,g.isLength=oo,g.isMap=Ah,g.isMatch=Iv,g.isMatchWith=xv,g.isNaN=Pv,g.isNative=Sv,g.isNil=Rv,g.isNull=Ov,g.isNumber=Ch,g.isObject=ut,g.isObjectLike=vt,g.isPlainObject=zn,g.isRegExp=Ka,g.isSafeInteger=Tv,g.isSet=$h,g.isString=ao,g.isSymbol=dr,g.isTypedArray=fn,g.isUndefined=Av,g.isWeakMap=Cv,g.isWeakSet=$v,g.join=Lg,g.kebabCase=bm,g.last=xr,g.lastIndexOf=jg,g.lowerCase=Em,g.lowerFirst=Im,g.lt=Nv,g.lte=Dv,g.max=v0,g.maxBy=m0,g.mean=_0,g.meanBy=w0,g.min=b0,g.minBy=E0,g.stubArray=Xa,g.stubFalse=Za,g.stubObject=a0,g.stubString=c0,g.stubTrue=u0,g.multiply=I0,g.nth=qg,g.noConflict=Zm,g.noop=Ya,g.now=io,g.pad=xm,g.padEnd=Pm,g.padStart=Sm,g.parseInt=Om,g.random=ym,g.reduce=Uy,g.reduceRight=Hy,g.repeat=Rm,g.replace=Tm,g.result=om,g.round=x0,g.runInContext=R,g.sample=By,g.size=Vy,g.snakeCase=Am,g.some=Gy,g.sortedIndex=Kg,g.sortedIndexBy=Fg,g.sortedIndexOf=Vg,g.sortedLastIndex=Gg,g.sortedLastIndexBy=Wg,g.sortedLastIndexOf=Jg,g.startCase=$m,g.startsWith=Nm,g.subtract=P0,g.sum=S0,g.sumBy=O0,g.template=Dm,g.times=h0,g.toFinite=ri,g.toInteger=we,g.toLength=Dh,g.toLower=Lm,g.toNumber=Pr,g.toSafeInteger=Lv,g.toString=qe,g.toUpper=jm,g.trim=qm,g.trimEnd=Mm,g.trimStart=zm,g.truncate=Um,g.unescape=Hm,g.uniqueId=f0,g.upperCase=km,g.upperFirst=Ga,g.each=wh,g.eachRight=bh,g.first=yh,Qa(g,function(){var e={};return kr(g,function(i,o){ze.call(g.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),g.VERSION=n,_r(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){g[e].placeholder=g}),_r(["drop","take"],function(e,i){Oe.prototype[e]=function(o){o=o===r?1:jt(we(o),0);var u=this.__filtered__&&!i?new Oe(this):this.clone();return u.__filtered__?u.__takeCount__=Ft(o,u.__takeCount__):u.__views__.push({size:Ft(o,G),type:e+(u.__dir__<0?"Right":"")}),u},Oe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),_r(["filter","map","takeWhile"],function(e,i){var o=i+1,u=o==m||o==X;Oe.prototype[e]=function(f){var y=this.clone();return y.__iteratees__.push({iteratee:se(f,3),type:o}),y.__filtered__=y.__filtered__||u,y}}),_r(["head","last"],function(e,i){var o="take"+(i?"Right":"");Oe.prototype[e]=function(){return this[o](1).value()[0]}}),_r(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Oe.prototype[e]=function(){return this.__filtered__?new Oe(this):this[o](1)}}),Oe.prototype.compact=function(){return this.filter(ar)},Oe.prototype.find=function(e){return this.filter(e).head()},Oe.prototype.findLast=function(e){return this.reverse().find(e)},Oe.prototype.invokeMap=xe(function(e,i){return typeof e=="function"?new Oe(this):this.map(function(o){return Nn(o,e,i)})}),Oe.prototype.reject=function(e){return this.filter(so(se(e)))},Oe.prototype.slice=function(e,i){e=we(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Oe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=we(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Oe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Oe.prototype.toArray=function(){return this.take(G)},kr(Oe.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),f=g[u?"take"+(i=="last"?"Right":""):i],y=u||/^find/.test(i);f&&(g.prototype[i]=function(){var w=this.__wrapped__,E=u?[1]:arguments,T=w instanceof Oe,M=E[0],z=T||_e(w),B=function(Pe){var Ae=f.apply(g,di([Pe],E));return u&&J?Ae[0]:Ae};z&&o&&typeof M=="function"&&M.length!=1&&(T=z=!1);var J=this.__chain__,te=!!this.__actions__.length,oe=y&&!J,Ee=T&&!te;if(!y&&z){w=Ee?w:new Oe(this);var ae=e.apply(w,E);return ae.__actions__.push({func:to,args:[B],thisArg:r}),new br(ae,J)}return oe&&Ee?e.apply(this,E):(ae=this.thru(B),oe?u?ae.value()[0]:ae.value():ae)})}),_r(["pop","push","shift","sort","splice","unshift"],function(e){var i=Os[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);g.prototype[e]=function(){var f=arguments;if(u&&!this.__chain__){var y=this.value();return i.apply(_e(y)?y:[],f)}return this[o](function(w){return i.apply(_e(w)?w:[],f)})}}),kr(Oe.prototype,function(e,i){var o=g[i];if(o){var u=o.name+"";ze.call(an,u)||(an[u]=[]),an[u].push({name:i,func:o})}}),an[Ws(r,he).name]=[{name:"wrapper",func:r}],Oe.prototype.clone=Hp,Oe.prototype.reverse=kp,Oe.prototype.value=Bp,g.prototype.at=my,g.prototype.chain=_y,g.prototype.commit=wy,g.prototype.next=by,g.prototype.plant=Iy,g.prototype.reverse=xy,g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=Py,g.prototype.first=g.prototype.head,Sn&&(g.prototype[Sn]=Ey),g},nn=wp();wt?((wt.exports=nn)._=nn,Ge._=nn):Te._=nn}).call(Vn)})(Nc,Nc.exports);var ax=Object.defineProperty,cx=Object.defineProperties,ux=Object.getOwnPropertyDescriptors,Wl=Object.getOwnPropertySymbols,hx=Object.prototype.hasOwnProperty,lx=Object.prototype.propertyIsEnumerable,Jl=(a,t,r)=>t in a?ax(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,po=(a,t)=>{for(var r in t||(t={}))hx.call(t,r)&&Jl(a,r,t[r]);if(Wl)for(var r of Wl(t))lx.call(t,r)&&Jl(a,r,t[r]);return a},fx=(a,t)=>cx(a,ux(t));function Pi(a,t,r){var n;const s=d_(a);return((n=t.rpcMap)==null?void 0:n[s.reference])||`${ox}?chainId=${s.namespace}:${s.reference}&projectId=${r}`}function Vi(a){return a.includes(":")?a.split(":")[1]:a}function Jf(a){return a.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function px(a,t){const r=Object.keys(t.namespaces).filter(s=>s.includes(a));if(!r.length)return[];const n=[];return r.forEach(s=>{const c=t.namespaces[s].accounts;n.push(...c)}),n}function dx(a={},t={}){const r=Ql(a),n=Ql(t);return Nc.exports.merge(r,n)}function Ql(a){var t,r,n,s;const c={};if(!vo(a))return c;for(const[l,d]of Object.entries(a)){const _=hf(l)?[l]:d.chains,p=d.methods||[],b=d.events||[],S=d.rpcMap||{},x=Gn(l);c[x]=fx(po(po({},c[x]),d),{chains:tc(_,(t=c[x])==null?void 0:t.chains),methods:tc(p,(r=c[x])==null?void 0:r.methods),events:tc(b,(n=c[x])==null?void 0:n.events),rpcMap:po(po({},S),(s=c[x])==null?void 0:s.rpcMap)})}return c}function gx(a){return a.includes(":")?a.split(":")[2]:a}function yx(a){const t={};for(const[r,n]of Object.entries(a)){const s=n.methods||[],c=n.events||[],l=n.accounts||[],d=hf(r)?[r]:n.chains?n.chains:Jf(n.accounts);t[r]={chains:d,methods:s,events:c,accounts:l}}return t}function pc(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const Qf={},st=a=>Qf[a],dc=(a,t)=>{Qf[a]=t};class vx{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Vi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,st("disableProviderPing")))}}class mx{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const n=r||Pi(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,st("disableProviderPing")))}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=parseInt(Vi(r));t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,n;let s=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const c=parseInt(s,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class _x{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Vi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,st("disableProviderPing")))}}class wx{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Vi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,st("disableProviderPing")))}}class bx{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),s=Vi(r);t[s]=this.createHttpProvider(s,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,st("disableProviderPing")))}}class Ex{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Vi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,st("disableProviderPing")))}}class Ix{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const s=Vi(r);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,st("disableProviderPing")))}}class xx{constructor(t){this.name="near",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const n=r||Pi(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;t[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Pi(t,this.namespace);return typeof n>"u"?void 0:new ui(new Si(n,st("disableProviderPing")))}}var Px=Object.defineProperty,Sx=Object.defineProperties,Ox=Object.getOwnPropertyDescriptors,Yl=Object.getOwnPropertySymbols,Rx=Object.prototype.hasOwnProperty,Tx=Object.prototype.propertyIsEnumerable,Xl=(a,t,r)=>t in a?Px(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,go=(a,t)=>{for(var r in t||(t={}))Rx.call(t,r)&&Xl(a,r,t[r]);if(Yl)for(var r of Yl(t))Tx.call(t,r)&&Xl(a,r,t[r]);return a},gc=(a,t)=>Sx(a,Ox(t));class Vc{constructor(t){this.events=new jc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Vl})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Vc(t);return await r.initialize(),r}async request(t,r){const[n,s]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:go({},t),chainId:`${n}:${s}`,topic:this.session.topic})}sendAsync(t,r,n){const s=new Date().getTime();this.request(t,n).then(c=>r(null,Po(s,c))).catch(c=>r(c,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Gt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:s}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await s().then(c=>{this.session=c,this.namespaces||(this.namespaces=yx(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==Gf)throw c;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[n,s]=this.validateChain(t);this.getProvider(n).setDefaultChain(s,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(_n(r)){for(const n of r)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await ZI.init({logger:this.providerOpts.logger||Vl,relayUrl:this.providerOpts.relayUrl||ix,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Gn(r)))];dc("client",this.client),dc("events",this.events),dc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const n=px(r,this.session),s=Jf(n),c=dx(this.namespaces,this.optionalNamespaces),l=gc(go({},c[r]),{accounts:n,chains:s});switch(r){case"eip155":this.rpcProviders[r]=new mx({namespace:l});break;case"solana":this.rpcProviders[r]=new _x({namespace:l});break;case"cosmos":this.rpcProviders[r]=new wx({namespace:l});break;case"polkadot":this.rpcProviders[r]=new vx({namespace:l});break;case"cip34":this.rpcProviders[r]=new bx({namespace:l});break;case"elrond":this.rpcProviders[r]=new Ex({namespace:l});break;case"multiversx":this.rpcProviders[r]=new Ix({namespace:l});break;case"near":this.rpcProviders[r]=new xx({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:n}=r;if(n.name==="accountsChanged"){const s=n.data;s&&_n(s)&&this.events.emit("accountsChanged",s.map(gx))}else if(n.name==="chainChanged"){const s=r.chainId,c=r.event.data,l=Gn(s),d=pc(s)!==pc(c)?`${l}:${pc(c)}`:s;this.onChainChanged(d)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var n;const{namespaces:s}=r,c=(n=this.client)==null?void 0:n.session.get(t);this.session=gc(go({},c),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",gc(go({},Gt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(hi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:n,sessionProperties:s}=t;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(t){const[r,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(l=>Gn(l)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const s=Gn(Object.keys(this.namespaces)[0]),c=this.rpcProviders[s].getDefaultChain();return[s,c]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var n;if(!this.namespaces)return;const[s,c]=this.validateChain(t);r||this.getProvider(s).setDefaultChain(c),((n=this.namespaces[s])!=null?n:this.namespaces[`${s}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Gl}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Gl}/${t}`)}}const Ax=Vc,Cx="wc",$x="ethereum_provider",Nx=`${Cx}@2:${$x}:`,Dx="https://rpc.walletconnect.com/v1/",Dc=["eth_sendTransaction","personal_sign"],Lx=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Lc=["chainChanged","accountsChanged"],jx=["chainChanged","accountsChanged","message","disconnect","connect"];var qx=Object.defineProperty,Mx=Object.defineProperties,zx=Object.getOwnPropertyDescriptors,Zl=Object.getOwnPropertySymbols,Ux=Object.prototype.hasOwnProperty,Hx=Object.prototype.propertyIsEnumerable,ef=(a,t,r)=>t in a?qx(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Jn=(a,t)=>{for(var r in t||(t={}))Ux.call(t,r)&&ef(a,r,t[r]);if(Zl)for(var r of Zl(t))Hx.call(t,r)&&ef(a,r,t[r]);return a},tf=(a,t)=>Mx(a,zx(t));function Eo(a){return Number(a[0].split(":")[1])}function yc(a){return`0x${a.toString(16)}`}function kx(a){const{chains:t,optionalChains:r,methods:n,optionalMethods:s,events:c,optionalEvents:l,rpcMap:d}=a;if(!_n(t))throw new Error("Invalid chains");const _={chains:t,methods:n||Dc,events:c||Lc,rpcMap:Jn({},t.length?{[Eo(t)]:d[Eo(t)]}:{})},p=c==null?void 0:c.filter(D=>!Lc.includes(D)),b=n==null?void 0:n.filter(D=>!Dc.includes(D));if(!r&&!l&&!s&&!(p!=null&&p.length)&&!(b!=null&&b.length))return{required:t.length?_:void 0};const S=(p==null?void 0:p.length)&&(b==null?void 0:b.length)||!r,x={chains:[...new Set(S?_.chains.concat(r||[]):r)],methods:[...new Set(_.methods.concat(s!=null&&s.length?s:Lx))],events:[...new Set(_.events.concat(l!=null&&l.length?l:jx))],rpcMap:d};return{required:t.length?_:void 0,optional:r.length?x:void 0}}class Gc{constructor(){this.events=new Or.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=Nx,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Gc;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:n}=kx(this.rpc);try{const s=await new Promise(async(l,d)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),d(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(tf(Jn({namespaces:Jn({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(p=>{l(p)}).catch(p=>{d(new Error(p.message))})});if(!s)return;const c=g_(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:yc(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",yc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",tf(Jn({},Gt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",yc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,n,s]=t.split(":");return{chainId:`${r}:${n}`,address:s}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,n;const s=(r=t==null?void 0:t.chains)!=null?r:[],c=(n=t==null?void 0:t.optionalChains)!=null?n:[],l=s.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const d=s.length?(t==null?void 0:t.methods)||Dc:[],_=s.length?(t==null?void 0:t.events)||Lc:[],p=(t==null?void 0:t.optionalMethods)||[],b=(t==null?void 0:t.optionalEvents)||[],S=(t==null?void 0:t.rpcMap)||this.buildRpcMap(l,t.projectId),x=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:s==null?void 0:s.map(D=>this.formatChainId(D)),optionalChains:c.map(D=>this.formatChainId(D)),methods:d,events:_,optionalMethods:p,optionalEvents:b,rpcMap:S,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:x,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const n={};return t.forEach(s=>{n[s]=this.getRpcUrl(s,r)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Eo(this.rpc.chains):Eo(this.rpc.optionalChains),this.signer=await Ax.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await R0(()=>import("./index.sLqdPAdm.js").then(s=>s.i),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url);r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Jn({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:n,rpcMap:s}=t;r&&_n(r)&&(this.rpc.chains=r.map(c=>this.formatChainId(c)),r.forEach(c=>{this.rpc.rpcMap[c]=(s==null?void 0:s[c])||this.getRpcUrl(c)})),n&&_n(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(c=>this.formatChainId(c)),n.forEach(c=>{this.rpc.rpcMap[c]=(s==null?void 0:s[c])||this.getRpcUrl(c)}))}getRpcUrl(t,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${Dx}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const oP=Gc;export{oP as EthereumProvider,jx as OPTIONAL_EVENTS,Lx as OPTIONAL_METHODS,Lc as REQUIRED_EVENTS,Dc as REQUIRED_METHODS,Gc as default};
